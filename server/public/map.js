/*! For license information please see map.js.LICENSE.txt */
(()=>{var t={9901:(t,e,n)=>{"use strict";n.d(e,{BH:()=>d,DV:()=>A,GJ:()=>S,L:()=>h,LL:()=>T,Pz:()=>k,Sg:()=>p,UI:()=>R,US:()=>o,Yr:()=>y,ZR:()=>C,b$:()=>g,cI:()=>E,dS:()=>V,eu:()=>b,g5:()=>s,gK:()=>Z,gQ:()=>z,h$:()=>a,hl:()=>w,hu:()=>i,m9:()=>H,ne:()=>U,p$:()=>l,pd:()=>B,r3:()=>x,ru:()=>m,tV:()=>c,uI:()=>_,ug:()=>W,vZ:()=>N,w1:()=>v,w9:()=>L,xO:()=>D,xb:()=>O,z$:()=>f,zd:()=>F});const i=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},r=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,h=a?t[e+2]:0,c=s>>2,l=(3&s)<<4|o>>4;let u=(15&o)<<2|h>>6,d=63&h;a||(d=64,r||(u=64)),i.push(n[c],n[l],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==o||null==a)throw Error();const h=s<<2|r>>4;if(i.push(h),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},a=function(t){const e=r(t);return o.encodeByteArray(e,!0)},h=function(t){return a(t).replace(/\./g,"")},c=function(t){try{return o.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(t){return u(void 0,t)}function u(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=u(t[n],e[n]));return t}class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(r)),""].join(".")}function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())}function m(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function g(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){const t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function y(){return!1}function w(){return"object"==typeof indexedDB}function b(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class C extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,C.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(I,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new C(i,o,n)}}const I=/\{\$([^}]+)}/g;function E(t){return JSON.parse(t)}function k(t){return JSON.stringify(t)}const P=function(t){let e={},n={},i={},s="";try{const r=t.split(".");e=E(c(r[0])||""),n=E(c(r[1])||""),s=r[2],i=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:i,signature:s}},L=function(t){const e=P(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},S=function(t){const e=P(t).claims;return"object"==typeof e&&!0===e.admin};function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function O(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function R(t,e,n){const i={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=e.call(n,t[s],s,t));return i}function N(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(M(n)&&M(r)){if(!N(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function M(t){return null!==t&&"object"==typeof t}function D(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function F(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function B(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class z{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"==typeof t)for(let i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let t=16;t<80;t++){const e=n[t-3]^n[t-8]^n[t-14]^n[t-16];n[t]=4294967295&(e<<1|e>>>31)}let i,s,r=this.chain_[0],o=this.chain_[1],a=this.chain_[2],h=this.chain_[3],c=this.chain_[4];for(let t=0;t<80;t++){t<40?t<20?(i=h^o&(a^h),s=1518500249):(i=o^a^h,s=1859775393):t<60?(i=o&a|h&(o|a),s=2400959708):(i=o^a^h,s=3395469782);const e=(r<<5|r>>>27)+i+c+s+n[t]&4294967295;c=h,h=a,a=4294967295&(o<<30|o>>>2),o=r,r=e}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let i=0;const s=this.buf_;let r=this.inbuf_;for(;i<e;){if(0===r)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(s[r]=t.charCodeAt(i),++r,++i,r===this.blockSize){this.compress_(s),r=0;break}}else for(;i<e;)if(s[r]=t[i],++r,++i,r===this.blockSize){this.compress_(s),r=0;break}}this.inbuf_=r,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let e=0;e<5;e++)for(let i=24;i>=0;i-=8)t[n]=this.chain_[e]>>i&255,++n;return t}}function U(t,e){const n=new j(t,e);return n.subscribe.bind(n)}class j{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=q),void 0===i.error&&(i.error=q),void 0===i.complete&&(i.complete=q);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function q(){}function Z(t,e){return`${t} failed: ${e} argument `}const V=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const e=r-55296;s++,i(s<t.length,"Surrogate pair missing trail surrogate."),r=65536+(e<<10)+(t.charCodeAt(s)-56320)}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},W=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};function H(t){return t&&t._delegate?t._delegate:t}},4206:(t,e,n)=>{t.exports=n(8057)},4387:(t,e,n)=>{"use strict";var i=n(7485),s=n(4570),r=n(2940),o=n(581),a=n(574),h=n(3845),c=n(8338),l=n(4832),u=n(7354),d=n(8870),p=n(4906);t.exports=function(t){return new Promise((function(e,n){var f,_=t.data,m=t.headers,g=t.responseType;function v(){t.cancelToken&&t.cancelToken.unsubscribe(f),t.signal&&t.signal.removeEventListener("abort",f)}i.isFormData(_)&&i.isStandardBrowserEnv()&&delete m["Content-Type"];var y=new XMLHttpRequest;if(t.auth){var w=t.auth.username||"",b=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";m.Authorization="Basic "+btoa(w+":"+b)}var C=a(t.baseURL,t.url);function T(){if(y){var i="getAllResponseHeaders"in y?h(y.getAllResponseHeaders()):null,r={data:g&&"text"!==g&&"json"!==g?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:i,config:t,request:y};s((function(t){e(t),v()}),(function(t){n(t),v()}),r),y=null}}if(y.open(t.method.toUpperCase(),o(C,t.params,t.paramsSerializer),!0),y.timeout=t.timeout,"onloadend"in y?y.onloadend=T:y.onreadystatechange=function(){y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))&&setTimeout(T)},y.onabort=function(){y&&(n(new u("Request aborted",u.ECONNABORTED,t,y)),y=null)},y.onerror=function(){n(new u("Network Error",u.ERR_NETWORK,t,y,y)),y=null},y.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",i=t.transitional||l;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new u(e,i.clarifyTimeoutError?u.ETIMEDOUT:u.ECONNABORTED,t,y)),y=null},i.isStandardBrowserEnv()){var I=(t.withCredentials||c(C))&&t.xsrfCookieName?r.read(t.xsrfCookieName):void 0;I&&(m[t.xsrfHeaderName]=I)}"setRequestHeader"in y&&i.forEach(m,(function(t,e){void 0===_&&"content-type"===e.toLowerCase()?delete m[e]:y.setRequestHeader(e,t)})),i.isUndefined(t.withCredentials)||(y.withCredentials=!!t.withCredentials),g&&"json"!==g&&(y.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&y.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(f=function(t){y&&(n(!t||t&&t.type?new d:t),y.abort(),y=null)},t.cancelToken&&t.cancelToken.subscribe(f),t.signal&&(t.signal.aborted?f():t.signal.addEventListener("abort",f))),_||(_=null);var E=p(C);E&&-1===["http","https","file"].indexOf(E)?n(new u("Unsupported protocol "+E+":",u.ERR_BAD_REQUEST,t)):y.send(_)}))}},8057:(t,e,n)=>{"use strict";var i=n(7485),s=n(875),r=n(5029),o=n(4941),a=function t(e){var n=new r(e),a=s(r.prototype.request,n);return i.extend(a,r.prototype,n),i.extend(a,n),a.create=function(n){return t(o(e,n))},a}(n(8396));a.Axios=r,a.CanceledError=n(8870),a.CancelToken=n(4603),a.isCancel=n(1475),a.VERSION=n(3345).version,a.toFormData=n(1020),a.AxiosError=n(7354),a.Cancel=a.CanceledError,a.all=function(t){return Promise.all(t)},a.spread=n(5739),a.isAxiosError=n(5835),t.exports=a,t.exports.default=a},4603:(t,e,n)=>{"use strict";var i=n(8870);function s(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._listeners){var e,i=n._listeners.length;for(e=0;e<i;e++)n._listeners[e](t);n._listeners=null}})),this.promise.then=function(t){var e,i=new Promise((function(t){n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t){n.reason||(n.reason=new i(t),e(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},s.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},s.source=function(){var t;return{token:new s((function(e){t=e})),cancel:t}},t.exports=s},8870:(t,e,n)=>{"use strict";var i=n(7354);function s(t){i.call(this,null==t?"canceled":t,i.ERR_CANCELED),this.name="CanceledError"}n(7485).inherits(s,i,{__CANCEL__:!0}),t.exports=s},1475:t=>{"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},5029:(t,e,n)=>{"use strict";var i=n(7485),s=n(581),r=n(8096),o=n(5009),a=n(4941),h=n(574),c=n(6144),l=c.validators;function u(t){this.defaults=t,this.interceptors={request:new r,response:new r}}u.prototype.request=function(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;void 0!==n&&c.assertOptions(n,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var i=[],s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,i.unshift(t.fulfilled,t.rejected))}));var r,h=[];if(this.interceptors.response.forEach((function(t){h.push(t.fulfilled,t.rejected)})),!s){var u=[o,void 0];for(Array.prototype.unshift.apply(u,i),u=u.concat(h),r=Promise.resolve(e);u.length;)r=r.then(u.shift(),u.shift());return r}for(var d=e;i.length;){var p=i.shift(),f=i.shift();try{d=p(d)}catch(t){f(t);break}}try{r=o(d)}catch(t){return Promise.reject(t)}for(;h.length;)r=r.then(h.shift(),h.shift());return r},u.prototype.getUri=function(t){t=a(this.defaults,t);var e=h(t.baseURL,t.url);return s(e,t.params,t.paramsSerializer)},i.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,s){return this.request(a(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}u.prototype[t]=e(),u.prototype[t+"Form"]=e(!0)})),t.exports=u},7354:(t,e,n)=>{"use strict";var i=n(7485);function s(t,e,n,i,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}i.inherits(s,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var r=s.prototype,o={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(t){o[t]={value:t}})),Object.defineProperties(s,o),Object.defineProperty(r,"isAxiosError",{value:!0}),s.from=function(t,e,n,o,a,h){var c=Object.create(r);return i.toFlatObject(t,c,(function(t){return t!==Error.prototype})),s.call(c,t.message,e,n,o,a),c.name=t.name,h&&Object.assign(c,h),c},t.exports=s},8096:(t,e,n)=>{"use strict";var i=n(7485);function s(){this.handlers=[]}s.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},s.prototype.forEach=function(t){i.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=s},574:(t,e,n)=>{"use strict";var i=n(2642),s=n(2288);t.exports=function(t,e){return t&&!i(e)?s(t,e):e}},5009:(t,e,n)=>{"use strict";var i=n(7485),s=n(9212),r=n(1475),o=n(8396),a=n(8870);function h(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new a}t.exports=function(t){return h(t),t.headers=t.headers||{},t.data=s.call(t,t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||o.adapter)(t).then((function(e){return h(t),e.data=s.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return r(e)||(h(t),e&&e.response&&(e.response.data=s.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},4941:(t,e,n)=>{"use strict";var i=n(7485);t.exports=function(t,e){e=e||{};var n={};function s(t,e){return i.isPlainObject(t)&&i.isPlainObject(e)?i.merge(t,e):i.isPlainObject(e)?i.merge({},e):i.isArray(e)?e.slice():e}function r(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:s(void 0,t[n]):s(t[n],e[n])}function o(t){if(!i.isUndefined(e[t]))return s(void 0,e[t])}function a(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:s(void 0,t[n]):s(void 0,e[n])}function h(n){return n in e?s(t[n],e[n]):n in t?s(void 0,t[n]):void 0}var c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:h};return i.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=c[t]||r,s=e(t);i.isUndefined(s)&&e!==h||(n[t]=s)})),n}},4570:(t,e,n)=>{"use strict";var i=n(7354);t.exports=function(t,e,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?e(new i("Request failed with status code "+n.status,[i.ERR_BAD_REQUEST,i.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}},9212:(t,e,n)=>{"use strict";var i=n(7485),s=n(8396);t.exports=function(t,e,n){var r=this||s;return i.forEach(n,(function(n){t=n.call(r,t,e)})),t}},8396:(t,e,n)=>{"use strict";var i=n(7485),s=n(1446),r=n(7354),o=n(4832),a=n(1020),h={"Content-Type":"application/x-www-form-urlencoded"};function c(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var l,u={transitional:o,adapter:(("undefined"!=typeof XMLHttpRequest||"[object process]"===Object.prototype.toString.call({env:{NODE_ENV:"production"}}))&&(l=n(4387)),l),transformRequest:[function(t,e){if(s(e,"Accept"),s(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t))return t;if(i.isArrayBufferView(t))return t.buffer;if(i.isURLSearchParams(t))return c(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var n,r=i.isObject(t),o=e&&e["Content-Type"];if((n=i.isFileList(t))||r&&"multipart/form-data"===o){var h=this.env&&this.env.FormData;return a(n?{"files[]":t}:t,h&&new h)}return r||"application/json"===o?(c(e,"application/json"),function(t,e,n){if(i.isString(t))try{return(0,JSON.parse)(t),i.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||u.transitional,n=e&&e.silentJSONParsing,s=e&&e.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||s&&i.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(o){if("SyntaxError"===t.name)throw r.from(t,r.ERR_BAD_RESPONSE,this,null,this.response);throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:n(8750)},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(t){u.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){u.headers[t]=i.merge(h)})),t.exports=u},4832:t=>{"use strict";t.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},3345:t=>{t.exports={version:"0.27.2"}},875:t=>{"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}}},581:(t,e,n)=>{"use strict";var i=n(7485);function s(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(i.isURLSearchParams(e))r=e.toString();else{var o=[];i.forEach(e,(function(t,e){null!=t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,(function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),o.push(s(e)+"="+s(t))})))})),r=o.join("&")}if(r){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}},2288:t=>{"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},2940:(t,e,n)=>{"use strict";var i=n(7485);t.exports=i.isStandardBrowserEnv()?{write:function(t,e,n,s,r,o){var a=[];a.push(t+"="+encodeURIComponent(e)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(s)&&a.push("path="+s),i.isString(r)&&a.push("domain="+r),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},2642:t=>{"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},5835:(t,e,n)=>{"use strict";var i=n(7485);t.exports=function(t){return i.isObject(t)&&!0===t.isAxiosError}},8338:(t,e,n)=>{"use strict";var i=n(7485);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=s(window.location.href),function(e){var n=i.isString(e)?s(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},1446:(t,e,n)=>{"use strict";var i=n(7485);t.exports=function(t,e){i.forEach(t,(function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])}))}},8750:t=>{t.exports=null},3845:(t,e,n)=>{"use strict";var i=n(7485),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,r,o={};return t?(i.forEach(t.split("\n"),(function(t){if(r=t.indexOf(":"),e=i.trim(t.substr(0,r)).toLowerCase(),n=i.trim(t.substr(r+1)),e){if(o[e]&&s.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([n]):o[e]?o[e]+", "+n:n}})),o):o}},4906:t=>{"use strict";t.exports=function(t){var e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}},5739:t=>{"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},1020:(t,e,n)=>{"use strict";var i=n(7485);t.exports=function(t,e){e=e||new FormData;var n=[];function s(t){return null===t?"":i.isDate(t)?t.toISOString():i.isArrayBuffer(t)||i.isTypedArray(t)?"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}return function t(r,o){if(i.isPlainObject(r)||i.isArray(r)){if(-1!==n.indexOf(r))throw Error("Circular reference detected in "+o);n.push(r),i.forEach(r,(function(n,r){if(!i.isUndefined(n)){var a,h=o?o+"."+r:r;if(n&&!o&&"object"==typeof n)if(i.endsWith(r,"{}"))n=JSON.stringify(n);else if(i.endsWith(r,"[]")&&(a=i.toArray(n)))return void a.forEach((function(t){!i.isUndefined(t)&&e.append(h,s(t))}));t(n,h)}})),n.pop()}else e.append(o,s(r))}(t),e}},6144:(t,e,n)=>{"use strict";var i=n(3345).version,s=n(7354),r={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){r[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var o={};r.transitional=function(t,e,n){function r(t,e){return"[Axios v"+i+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return function(n,i,a){if(!1===t)throw new s(r(i," has been removed"+(e?" in "+e:"")),s.ERR_DEPRECATED);return e&&!o[i]&&(o[i]=!0,console.warn(r(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,i,a)}},t.exports={assertOptions:function(t,e,n){if("object"!=typeof t)throw new s("options must be an object",s.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(t),r=i.length;r-- >0;){var o=i[r],a=e[o];if(a){var h=t[o],c=void 0===h||a(h,o,t);if(!0!==c)throw new s("option "+o+" must be "+c,s.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new s("Unknown option "+o,s.ERR_BAD_OPTION)}},validators:r}},7485:(t,e,n)=>{"use strict";var i,s=n(875),r=Object.prototype.toString,o=(i=Object.create(null),function(t){var e=r.call(t);return i[e]||(i[e]=e.slice(8,-1).toLowerCase())});function a(t){return t=t.toLowerCase(),function(e){return o(e)===t}}function h(t){return Array.isArray(t)}function c(t){return void 0===t}var l=a("ArrayBuffer");function u(t){return null!==t&&"object"==typeof t}function d(t){if("object"!==o(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}var p=a("Date"),f=a("File"),_=a("Blob"),m=a("FileList");function g(t){return"[object Function]"===r.call(t)}var v=a("URLSearchParams");function y(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),h(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}var w,b=(w="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(t){return w&&t instanceof w});t.exports={isArray:h,isArrayBuffer:l,isBuffer:function(t){return null!==t&&!c(t)&&null!==t.constructor&&!c(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){var e="[object FormData]";return t&&("function"==typeof FormData&&t instanceof FormData||r.call(t)===e||g(t.toString)&&t.toString()===e)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&l(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:u,isPlainObject:d,isUndefined:c,isDate:p,isFile:f,isBlob:_,isFunction:g,isStream:function(t){return u(t)&&g(t.pipe)},isURLSearchParams:v,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:y,merge:function t(){var e={};function n(n,i){d(e[i])&&d(n)?e[i]=t(e[i],n):d(n)?e[i]=t({},n):h(n)?e[i]=n.slice():e[i]=n}for(var i=0,s=arguments.length;i<s;i++)y(arguments[i],n);return e},extend:function(t,e,n){return y(e,(function(e,i){t[i]=n&&"function"==typeof e?s(e,n):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t},inherits:function(t,e,n,i){t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)},toFlatObject:function(t,e,n){var i,s,r,o={};e=e||{};do{for(s=(i=Object.getOwnPropertyNames(t)).length;s-- >0;)o[r=i[s]]||(e[r]=t[r],o[r]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:o,kindOfTest:a,endsWith:function(t,e,n){t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;var i=t.indexOf(e,n);return-1!==i&&i===n},toArray:function(t){if(!t)return null;var e=t.length;if(c(e))return null;for(var n=new Array(e);e-- >0;)n[e]=t[e];return n},isTypedArray:b,isFileList:m}},2190:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(4933),s=n.n(i),r=n(3476),o=n.n(r)()(s());o.push([t.id,'.marker-cluster-small {\n\tbackground-color: rgba(181, 226, 140, 0.6);\n\t}\n.marker-cluster-small div {\n\tbackground-color: rgba(110, 204, 57, 0.6);\n\t}\n\n.marker-cluster-medium {\n\tbackground-color: rgba(241, 211, 87, 0.6);\n\t}\n.marker-cluster-medium div {\n\tbackground-color: rgba(240, 194, 12, 0.6);\n\t}\n\n.marker-cluster-large {\n\tbackground-color: rgba(253, 156, 115, 0.6);\n\t}\n.marker-cluster-large div {\n\tbackground-color: rgba(241, 128, 23, 0.6);\n\t}\n\n\t/* IE 6-8 fallback colors */\n.leaflet-oldie .marker-cluster-small {\n\tbackground-color: rgb(181, 226, 140);\n\t}\n.leaflet-oldie .marker-cluster-small div {\n\tbackground-color: rgb(110, 204, 57);\n\t}\n\n.leaflet-oldie .marker-cluster-medium {\n\tbackground-color: rgb(241, 211, 87);\n\t}\n.leaflet-oldie .marker-cluster-medium div {\n\tbackground-color: rgb(240, 194, 12);\n\t}\n\n.leaflet-oldie .marker-cluster-large {\n\tbackground-color: rgb(253, 156, 115);\n\t}\n.leaflet-oldie .marker-cluster-large div {\n\tbackground-color: rgb(241, 128, 23);\n}\n\n.marker-cluster {\n\tbackground-clip: padding-box;\n\tborder-radius: 20px;\n\t}\n.marker-cluster div {\n\twidth: 30px;\n\theight: 30px;\n\tmargin-left: 5px;\n\tmargin-top: 5px;\n\n\ttext-align: center;\n\tborder-radius: 15px;\n\tfont: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;\n\t}\n.marker-cluster span {\n\tline-height: 30px;\n\t}',""]);const a=o},3476:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);i&&o[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),s&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=s):l[4]="".concat(s)),e.push(l))}},e}},4933:t=>{"use strict";t.exports=function(t){return t[1]}},5515:(t,e,n)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(i++,"%c"===t&&(s=i))})),e.splice(s,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"env"in{env:{NODE_ENV:"production"}}&&(t={NODE_ENV:"production"}.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(2591)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},2591:(t,e,n)=>{t.exports=function(t){function e(t){let n,s,r,o=null;function a(...t){if(!a.enabled)return;const i=a,s=Number(new Date),r=s-(n||s);i.diff=r,i.prev=n,i.curr=s,n=s,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let o=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,s)=>{if("%%"===n)return"%";o++;const r=e.formatters[s];if("function"==typeof r){const e=t[o];n=r.call(i,e),t.splice(o,1),o--}return n})),e.formatArgs.call(i,t),(i.log||e.log).apply(i,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=i,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==e.namespaces&&(s=e.namespaces,r=e.enabled(t)),r),set:t=>{o=t}}),"function"==typeof e.init&&e.init(a),a}function i(t,n){const i=e(this.namespace+(void 0===n?":":n)+t);return i.log=this.log,i}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(s),...e.skips.map(s).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),s=i.length;for(n=0;n<s;n++)i[n]&&("-"===(t=i[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,i;for(n=0,i=e.skips.length;n<i;n++)if(e.skips[n].test(t))return!1;for(n=0,i=e.names.length;n<i;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(3621),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},3621:t=>{var e=1e3,n=60*e,i=60*n,s=24*i;function r(t,e,n,i){var s=e>=1.5*n;return Math.round(t/n)+" "+i+(s?"s":"")}t.exports=function(t,o){o=o||{};var a,h,c=typeof t;if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(r){var o=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===c&&isFinite(t))return o.long?(a=t,(h=Math.abs(a))>=s?r(a,h,s,"day"):h>=i?r(a,h,i,"hour"):h>=n?r(a,h,n,"minute"):h>=e?r(a,h,e,"second"):a+" ms"):function(t){var r=Math.abs(t);return r>=s?Math.round(t/s)+"d":r>=i?Math.round(t/i)+"h":r>=n?Math.round(t/n)+"m":r>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},2671:(t,e,n)=>{"use strict";n.r(e),n.d(e,{FirebaseError:()=>i.ZR,SDK_VERSION:()=>i.Jn,_DEFAULT_ENTRY_NAME:()=>i.l4,_addComponent:()=>i.H9,_addOrOverwriteComponent:()=>i.Vr,_apps:()=>i.Af,_clearComponents:()=>i.Z8,_components:()=>i.lz,_getProvider:()=>i.qX,_registerComponent:()=>i.Xd,_removeServiceInstance:()=>i.wN,deleteApp:()=>i.P2,getApp:()=>i.Mq,getApps:()=>i.C6,initializeApp:()=>i.ZF,onLog:()=>i.TP,registerVersion:()=>i.KN,setLogLevel:()=>i.Ub});var i=n(7466);(0,i.KN)("firebase","9.8.2","app")},5211:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ActionCodeOperation:()=>d,ActionCodeURL:()=>Mt,AuthCredential:()=>kt,AuthErrorCodes:()=>m,EmailAuthCredential:()=>xt,EmailAuthProvider:()=>Ft,FacebookAuthProvider:()=>jt,FactorId:()=>h,GithubAuthProvider:()=>Zt,GoogleAuthProvider:()=>qt,OAuthCredential:()=>Ot,OAuthProvider:()=>Ut,OperationType:()=>u,PhoneAuthCredential:()=>Nt,PhoneAuthProvider:()=>Dn,PhoneMultiFactorGenerator:()=>ki,ProviderId:()=>c,RecaptchaVerifier:()=>Sn,SAMLAuthProvider:()=>Wt,SignInMethod:()=>l,TwitterAuthProvider:()=>Ht,applyActionCode:()=>fe,beforeAuthStateChanged:()=>Be,browserLocalPersistence:()=>Xe,browserPopupRedirectResolver:()=>Ii,browserSessionPersistence:()=>en,checkActionCode:()=>_e,confirmPasswordReset:()=>pe,connectAuthEmulator:()=>Tt,createUserWithEmailAndPassword:()=>ge,debugErrorMap:()=>p,deleteUser:()=>Ze,fetchSignInMethodsForEmail:()=>Ce,getAdditionalUserInfo:()=>Me,getAuth:()=>Ai,getIdToken:()=>H,getIdTokenResult:()=>G,getMultiFactorResolver:()=>He,getRedirectResult:()=>ii,inMemoryPersistence:()=>rt,indexedDBLocalPersistence:()=>gn,initializeAuth:()=>S,isSignInWithEmailLink:()=>we,linkWithCredential:()=>oe,linkWithPhoneNumber:()=>On,linkWithPopup:()=>Hn,linkWithRedirect:()=>ni,multiFactor:()=>Ye,onAuthStateChanged:()=>ze,onIdTokenChanged:()=>Fe,parseActionCodeURL:()=>Dt,prodErrorMap:()=>f,reauthenticateWithCredential:()=>ae,reauthenticateWithPhoneNumber:()=>Rn,reauthenticateWithPopup:()=>Wn,reauthenticateWithRedirect:()=>ei,reload:()=>tt,sendEmailVerification:()=>Te,sendPasswordResetEmail:()=>de,sendSignInLinkToEmail:()=>ye,setPersistence:()=>De,signInAnonymously:()=>$t,signInWithCredential:()=>re,signInWithCustomToken:()=>he,signInWithEmailAndPassword:()=>ve,signInWithEmailLink:()=>be,signInWithPhoneNumber:()=>An,signInWithPopup:()=>Vn,signInWithRedirect:()=>ti,signOut:()=>qe,unlink:()=>te,updateCurrentUser:()=>je,updateEmail:()=>ke,updatePassword:()=>Pe,updatePhoneNumber:()=>Mn,updateProfile:()=>Ee,useDeviceLanguage:()=>Ue,verifyBeforeUpdateEmail:()=>Ie,verifyPasswordResetCode:()=>me});var i=n(9901),s=n(7466);function r(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}Object.create,Object.create;var o=n(4959),a=n(7087);const h={PHONE:"phone"},c={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},l={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},u={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},d={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const p=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},f=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},_=new i.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),m={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized"},g=new o.Yd("@firebase/auth");function v(t,...e){g.logLevel<=o.in.ERROR&&g.error(`Auth (${s.Jn}): ${t}`,...e)}function y(t,...e){throw T(t,...e)}function w(t,...e){return T(t,...e)}function b(t,e,n){const s=Object.assign(Object.assign({},f()),{[e]:n});return new i.LL("auth","Firebase",s).create(e,{appName:t.name})}function C(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&y(t,"argument-error"),b(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function T(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return _.create(t,...e)}function I(t,e,...n){if(!t)throw T(e,...n)}function E(t){const e="INTERNAL ASSERTION FAILED: "+t;throw v(e),new Error(e)}function k(t,e){t||E(e)}const P=new Map;function L(t){k(t instanceof Function,"Expected a class definition");let e=P.get(t);return e?(k(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,P.set(t,e),e)}function S(t,e){const n=(0,s.qX)(t,"auth");if(n.isInitialized()){const t=n.getImmediate(),s=n.getOptions();if((0,i.vZ)(s,null!=e?e:{}))return t;y(t,"already-initialized")}return n.initialize({options:e})}function x(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function A(){return"http:"===O()||"https:"===O()}function O(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class R{constructor(t,e){this.shortDelay=t,this.longDelay=e,k(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,i.uI)()||(0,i.b$)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(A()||(0,i.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function N(t,e){k(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class M{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void E("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void E("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void E("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const D={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},F=new R(3e4,6e4);function B(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function z(t,e,n,s,r={}){return U(t,r,(async()=>{let r={},o={};s&&("GET"===e?o=s:r={body:JSON.stringify(s)});const a=(0,i.xO)(Object.assign({key:t.config.apiKey},o)).slice(1),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode),M.fetch()(q(t,t.config.apiHost,n,a),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},r))}))}async function U(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},D),e);try{const e=new Z(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await i.json();if("needConfirmation"in r)throw V(t,"account-exists-with-different-credential",r);if(i.ok&&!("errorMessage"in r))return r;{const e=i.ok?r.errorMessage:r.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw V(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw V(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw V(t,"user-disabled",r);const a=s[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw b(t,a,o);y(t,a)}}catch(e){if(e instanceof i.ZR)throw e;y(t,"network-request-failed")}}async function j(t,e,n,i,s={}){const r=await z(t,e,n,i,s);return"mfaPendingCredential"in r&&y(t,"multi-factor-auth-required",{_serverResponse:r}),r}function q(t,e,n,i){const s=`${e}${n}?${i}`;return t.config.emulator?N(t.config,s):`${t.config.apiScheme}://${s}`}class Z{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(w(this.auth,"network-request-failed"))),F.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function V(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=w(t,e,i);return s.customData._tokenResponse=n,s}function W(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function H(t,e=!1){return(0,i.m9)(t).getIdToken(e)}async function G(t,e=!1){const n=(0,i.m9)(t),s=await n.getIdToken(e),r=Y(s);I(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o="object"==typeof r.firebase?r.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:r,token:s,authTime:W(K(r.auth_time)),issuedAtTime:W(K(r.iat)),expirationTime:W(K(r.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function K(t){return 1e3*Number(t)}function Y(t){const[e,n,s]=t.split(".");if(void 0===e||void 0===n||void 0===s)return v("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,i.tV)(n);return t?JSON.parse(t):(v("Failed to decode base64 JWT payload"),null)}catch(t){return v("Caught error parsing JWT payload as JSON",t),null}}async function $(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof i.ZR&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class J{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class Q{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=W(this.lastLoginAt),this.creationTime=W(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function X(t){var e;const n=t.auth,i=await t.getIdToken(),s=await $(t,async function(t,e){return z(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));I(null==s?void 0:s.users.length,n,"internal-error");const o=s.users[0];t._notifyReloadListener(o);const a=(null===(e=o.providerUserInfo)||void 0===e?void 0:e.length)?o.providerUserInfo.map((t=>{var{providerId:e}=t,n=r(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],h=(c=t.providerData,l=a,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const u=t.isAnonymous,d=!(t.email&&o.passwordHash||(null==h?void 0:h.length)),p=!!u&&d,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Q(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(t,f)}async function tt(t){const e=(0,i.m9)(t);await X(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}class et{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){I(t.idToken,"internal-error"),I(void 0!==t.idToken,"internal-error"),I(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Y(t);return I(e,"internal-error"),I(void 0!==e.exp,"internal-error"),I(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return I(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:s,expiresIn:r}=await async function(t,e){const n=await U(t,{},(async()=>{const n=(0,i.xO)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=t.config,o=q(t,s,"/v1/token",`key=${r}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",M.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new et;return n&&(I("string"==typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(I("string"==typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(I("number"==typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new et,this.toJSON())}_performRefresh(){return E("not implemented")}}function nt(t,e){I("string"==typeof t||void 0===t,"internal-error",{appName:e})}class it{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=r(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new J(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Q(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await $(this,this.stsTokenManager.getToken(this.auth,t));return I(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return G(this,t)}reload(){return tt(this)}_assign(t){this!==t&&(I(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new it(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){I(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await X(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await $(this,async function(t,e){return z(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,o,a,h,c;const l=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,p=null!==(r=e.photoURL)&&void 0!==r?r:void 0,f=null!==(o=e.tenantId)&&void 0!==o?o:void 0,_=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(h=e.createdAt)&&void 0!==h?h:void 0,g=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:C}=e;I(v&&C,t,"internal-error");const T=et.fromJSON(this.name,C);I("string"==typeof v,t,"internal-error"),nt(l,t.name),nt(u,t.name),I("boolean"==typeof y,t,"internal-error"),I("boolean"==typeof w,t,"internal-error"),nt(d,t.name),nt(p,t.name),nt(f,t.name),nt(_,t.name),nt(m,t.name),nt(g,t.name);const E=new it({uid:v,auth:t,email:u,emailVerified:y,displayName:l,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:T,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(E.providerData=b.map((t=>Object.assign({},t)))),_&&(E._redirectEventId=_),E}static async _fromIdTokenResponse(t,e,n=!1){const i=new et;i.updateFromServerResponse(e);const s=new it({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await X(s),s}}class st{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}st.type="NONE";const rt=st;function ot(t,e,n){return`firebase:${t}:${e}:${n}`}class at{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ot(this.userKey,i.apiKey,s),this.fullPersistenceKey=ot("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?it._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new at(L(rt),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||L(rt);const r=ot(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(r);if(e){const i=it._fromJSON(t,e);n!==s&&(o=i),s=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(t){}}))),new at(s,t,n)):new at(s,t,n)}}function ht(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dt(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ct(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ft(e))return"Blackberry";if(_t(e))return"Webos";if(lt(e))return"Safari";if((e.includes("chrome/")||ut(e))&&!e.includes("edge/"))return"Chrome";if(pt(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ct(t=(0,i.z$)()){return/firefox\//i.test(t)}function lt(t=(0,i.z$)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ut(t=(0,i.z$)()){return/crios\//i.test(t)}function dt(t=(0,i.z$)()){return/iemobile/i.test(t)}function pt(t=(0,i.z$)()){return/android/i.test(t)}function ft(t=(0,i.z$)()){return/blackberry/i.test(t)}function _t(t=(0,i.z$)()){return/webos/i.test(t)}function mt(t=(0,i.z$)()){return/iphone|ipad|ipod/i.test(t)}function gt(t=(0,i.z$)()){return mt(t)||pt(t)||_t(t)||ft(t)||/windows phone/i.test(t)||dt(t)}function vt(t,e=[]){let n;switch(t){case"Browser":n=ht((0,i.z$)());break;case"Worker":n=`${ht((0,i.z$)())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${s.Jn}/${r}`}class yt{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:t.message})}}}class wt{constructor(t,e,n){this.app=t,this.heartbeatServiceProvider=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ct(this),this.idTokenSubscription=new Ct(this),this.beforeStateQueue=new yt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=L(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await at.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return I(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await X(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?(0,i.m9)(t):null;return e&&I(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&I(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(L(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new i.LL("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&L(t)||this._popupRedirectResolver;I(e,this,"argument-error"),this.redirectPersistenceManager=await at.create(this,[L(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"==typeof e?e:e.next.bind(e),r=this._isInitialized?Promise.resolve():this._initializationPromise;return I(r,this,"internal-error"),r.then((()=>s(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return I(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=vt(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());return n&&(e["X-Firebase-Client"]=n),e}}function bt(t){return(0,i.m9)(t)}class Ct{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,i.ne)((t=>this.observer=t))}get next(){return I(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Tt(t,e,n){const i=bt(t);I(i._canInitEmulator,i,"emulator-config-failed"),I(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),r=It(e),{host:o,port:a}=function(t){const e=It(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const t=s[1];return{host:t,port:Et(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Et(e)}}}(e),h=null===a?"":`:${a}`;i.config.emulator={url:`${r}//${o}${h}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function It(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Et(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class kt{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return E("not implemented")}_getIdTokenResponse(t){return E("not implemented")}_linkToIdToken(t,e){return E("not implemented")}_getReauthenticationResolver(t){return E("not implemented")}}async function Pt(t,e){return z(t,"POST","/v1/accounts:resetPassword",B(t,e))}async function Lt(t,e){return z(t,"POST","/v1/accounts:update",e)}async function St(t,e){return z(t,"POST","/v1/accounts:sendOobCode",B(t,e))}class xt extends kt{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new xt(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new xt(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return j(t,"POST","/v1/accounts:signInWithPassword",B(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return j(t,"POST","/v1/accounts:signInWithEmailLink",B(t,e))}(t,{email:this._email,oobCode:this._password});default:y(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Lt(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return j(t,"POST","/v1/accounts:signInWithEmailLink",B(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:y(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function At(t,e){return j(t,"POST","/v1/accounts:signInWithIdp",B(t,e))}class Ot extends kt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Ot(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):y("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=r(e,["providerId","signInMethod"]);if(!n||!i)return null;const o=new Ot(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){return At(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,At(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,At(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,i.xO)(e)}return t}}const Rt={USER_NOT_FOUND:"user-not-found"};class Nt extends kt{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Nt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Nt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return j(t,"POST","/v1/accounts:signInWithPhoneNumber",B(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await j(t,"POST","/v1/accounts:signInWithPhoneNumber",B(t,e));if(n.temporaryProof)throw V(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return j(t,"POST","/v1/accounts:signInWithPhoneNumber",B(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Rt)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}=t;return n||e||i||s?new Nt({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class Mt{constructor(t){var e,n,s,r,o,a;const h=(0,i.zd)((0,i.pd)(t)),c=null!==(e=h.apiKey)&&void 0!==e?e:null,l=null!==(n=h.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=h.mode)&&void 0!==s?s:null);I(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(r=h.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(o=h.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=h.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=(0,i.zd)((0,i.pd)(t)).link,n=e?(0,i.zd)((0,i.pd)(e)).deep_link_id:null,s=(0,i.zd)((0,i.pd)(t)).deep_link_id;return(s?(0,i.zd)((0,i.pd)(s)).link:null)||s||n||e||t}(t);try{return new Mt(e)}catch(t){return null}}}function Dt(t){return Mt.parseLink(t)}class Ft{constructor(){this.providerId=Ft.PROVIDER_ID}static credential(t,e){return xt._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Mt.parseLink(e);return I(n,"argument-error"),xt._fromEmailAndCode(t,n.code,n.tenantId)}}Ft.PROVIDER_ID="password",Ft.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ft.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Bt{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class zt extends Bt{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Ut extends zt{static credentialFromJSON(t){const e="string"==typeof t?JSON.parse(t):t;return I("providerId"in e&&"signInMethod"in e,"argument-error"),Ot._fromParams(e)}credential(t){return this._credential(Object.assign(Object.assign({},t),{nonce:t.rawNonce}))}_credential(t){return I(t.idToken||t.accessToken,"argument-error"),Ot._fromParams(Object.assign(Object.assign({},t),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(t){return Ut.oauthCredentialFromTaggedObject(t)}static credentialFromError(t){return Ut.oauthCredentialFromTaggedObject(t.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:s,nonce:r,providerId:o}=t;if(!(n||i||e||s))return null;if(!o)return null;try{return new Ut(o)._credential({idToken:e,accessToken:n,nonce:r,pendingToken:s})}catch(t){return null}}}class jt extends zt{constructor(){super("facebook.com")}static credential(t){return Ot._fromParams({providerId:jt.PROVIDER_ID,signInMethod:jt.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return jt.credentialFromTaggedObject(t)}static credentialFromError(t){return jt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return jt.credential(t.oauthAccessToken)}catch(t){return null}}}jt.FACEBOOK_SIGN_IN_METHOD="facebook.com",jt.PROVIDER_ID="facebook.com";class qt extends zt{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Ot._fromParams({providerId:qt.PROVIDER_ID,signInMethod:qt.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return qt.credentialFromTaggedObject(t)}static credentialFromError(t){return qt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return qt.credential(e,n)}catch(t){return null}}}qt.GOOGLE_SIGN_IN_METHOD="google.com",qt.PROVIDER_ID="google.com";class Zt extends zt{constructor(){super("github.com")}static credential(t){return Ot._fromParams({providerId:Zt.PROVIDER_ID,signInMethod:Zt.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Zt.credentialFromTaggedObject(t)}static credentialFromError(t){return Zt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Zt.credential(t.oauthAccessToken)}catch(t){return null}}}Zt.GITHUB_SIGN_IN_METHOD="github.com",Zt.PROVIDER_ID="github.com";class Vt extends kt{constructor(t,e){super(t,t),this.pendingToken=e}_getIdTokenResponse(t){return At(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,At(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,At(t,e)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i,pendingToken:s}=e;return n&&i&&s&&n===i?new Vt(n,s):null}static _create(t,e){return new Vt(t,e)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Wt extends Bt{constructor(t){I(t.startsWith("saml."),"argument-error"),super(t)}static credentialFromResult(t){return Wt.samlCredentialFromTaggedObject(t)}static credentialFromError(t){return Wt.samlCredentialFromTaggedObject(t.customData||{})}static credentialFromJSON(t){const e=Vt.fromJSON(t);return I(e,"argument-error"),e}static samlCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{pendingToken:e,providerId:n}=t;if(!e||!n)return null;try{return Vt._create(n,e)}catch(t){return null}}}class Ht extends zt{constructor(){super("twitter.com")}static credential(t,e){return Ot._fromParams({providerId:Ht.PROVIDER_ID,signInMethod:Ht.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Ht.credentialFromTaggedObject(t)}static credentialFromError(t){return Ht.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return Ht.credential(e,n)}catch(t){return null}}}async function Gt(t,e){return j(t,"POST","/v1/accounts:signUp",B(t,e))}Ht.TWITTER_SIGN_IN_METHOD="twitter.com",Ht.PROVIDER_ID="twitter.com";class Kt{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const s=await it._fromIdTokenResponse(t,n,i),r=Yt(n);return new Kt({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=Yt(n);return new Kt({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function Yt(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function $t(t){var e;const n=bt(t);if(await n._initializationPromise,null===(e=n.currentUser)||void 0===e?void 0:e.isAnonymous)return new Kt({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Gt(n,{returnSecureToken:!0}),s=await Kt._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(s.user),s}class Jt extends i.ZR{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Jt.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Jt(t,e,n,i)}}function Qt(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Jt._fromErrorAndOperation(t,n,e,i);throw n}))}function Xt(t){return new Set(t.map((({providerId:t})=>t)).filter((t=>!!t)))}async function te(t,e){const n=(0,i.m9)(t);await ne(!0,n,e);const{providerUserInfo:s}=await async function(t,e){return z(t,"POST","/v1/accounts:update",e)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),r=Xt(s||[]);return n.providerData=n.providerData.filter((t=>r.has(t.providerId))),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function ee(t,e,n=!1){const i=await $(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Kt._forOperation(t,"link",i)}async function ne(t,e,n){await X(e);const i=!1===t?"provider-already-linked":"no-such-provider";I(Xt(e.providerData).has(n)===t,e.auth,i)}async function ie(t,e,n=!1){const{auth:i}=t,s="reauthenticate";try{const r=await $(t,Qt(i,s,e,t),n);I(r.idToken,i,"internal-error");const o=Y(r.idToken);I(o,i,"internal-error");const{sub:a}=o;return I(t.uid===a,i,"user-mismatch"),Kt._forOperation(t,s,r)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&y(i,"user-mismatch"),t}}async function se(t,e,n=!1){const i="signIn",s=await Qt(t,i,e),r=await Kt._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}async function re(t,e){return se(bt(t),e)}async function oe(t,e){const n=(0,i.m9)(t);return await ne(!1,n,e.providerId),ee(n,e)}async function ae(t,e){return ie((0,i.m9)(t),e)}async function he(t,e){const n=bt(t),i=await async function(t,e){return j(t,"POST","/v1/accounts:signInWithCustomToken",B(t,e))}(n,{token:e,returnSecureToken:!0}),s=await Kt._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(s.user),s}class ce{constructor(t,e){this.factorId=t,this.uid=e.mfaEnrollmentId,this.enrollmentTime=new Date(e.enrolledAt).toUTCString(),this.displayName=e.displayName}static _fromServerResponse(t,e){return"phoneInfo"in e?le._fromServerResponse(t,e):y(t,"internal-error")}}class le extends ce{constructor(t){super("phone",t),this.phoneNumber=t.phoneInfo}static _fromServerResponse(t,e){return new le(e)}}function ue(t,e,n){var i;I((null===(i=n.url)||void 0===i?void 0:i.length)>0,t,"invalid-continue-uri"),I(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(I(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(I(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function de(t,e,n){const s=(0,i.m9)(t),r={requestType:"PASSWORD_RESET",email:e};n&&ue(s,r,n),await async function(t,e){return St(t,e)}(s,r)}async function pe(t,e,n){await Pt((0,i.m9)(t),{oobCode:e,newPassword:n})}async function fe(t,e){await async function(t,e){return z(t,"POST","/v1/accounts:update",B(t,e))}((0,i.m9)(t),{oobCode:e})}async function _e(t,e){const n=(0,i.m9)(t),s=await Pt(n,{oobCode:e}),r=s.requestType;switch(I(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":I(s.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":I(s.mfaInfo,n,"internal-error");default:I(s.email,n,"internal-error")}let o=null;return s.mfaInfo&&(o=ce._fromServerResponse(bt(n),s.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===s.requestType?s.newEmail:s.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===s.requestType?s.email:s.newEmail)||null,multiFactorInfo:o},operation:r}}async function me(t,e){const{data:n}=await _e((0,i.m9)(t),e);return n.email}async function ge(t,e,n){const i=bt(t),s=await Gt(i,{returnSecureToken:!0,email:e,password:n}),r=await Kt._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(r.user),r}function ve(t,e,n){return re((0,i.m9)(t),Ft.credential(e,n))}async function ye(t,e,n){const s=(0,i.m9)(t),r={requestType:"EMAIL_SIGNIN",email:e};I(n.handleCodeInApp,s,"argument-error"),n&&ue(s,r,n),await async function(t,e){return St(t,e)}(s,r)}function we(t,e){const n=Mt.parseLink(e);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function be(t,e,n){const s=(0,i.m9)(t),r=Ft.credentialWithLink(e,n||x());return I(r._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),re(s,r)}async function Ce(t,e){const n={identifier:e,continueUri:A()?x():"http://localhost"},{signinMethods:s}=await async function(t,e){return z(t,"POST","/v1/accounts:createAuthUri",B(t,e))}((0,i.m9)(t),n);return s||[]}async function Te(t,e){const n=(0,i.m9)(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&ue(n.auth,s,e);const{email:r}=await async function(t,e){return St(t,e)}(n.auth,s);r!==t.email&&await t.reload()}async function Ie(t,e,n){const s=(0,i.m9)(t),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&ue(s.auth,r,n);const{email:o}=await async function(t,e){return St(t,e)}(s.auth,r);o!==t.email&&await t.reload()}async function Ee(t,{displayName:e,photoURL:n}){if(void 0===e&&void 0===n)return;const s=(0,i.m9)(t),r={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await $(s,async function(t,e){return z(t,"POST","/v1/accounts:update",e)}(s.auth,r));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find((({providerId:t})=>"password"===t));a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function ke(t,e){return Le((0,i.m9)(t),e,null)}function Pe(t,e){return Le((0,i.m9)(t),null,e)}async function Le(t,e,n){const{auth:i}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const r=await $(t,Lt(i,s));await t._updateTokensIfNecessary(r,!0)}class Se{constructor(t,e,n={}){this.isNewUser=t,this.providerId=e,this.profile=n}}class xe extends Se{constructor(t,e,n,i){super(t,e,n),this.username=i}}class Ae extends Se{constructor(t,e){super(t,"facebook.com",e)}}class Oe extends xe{constructor(t,e){super(t,"github.com",e,"string"==typeof(null==e?void 0:e.login)?null==e?void 0:e.login:null)}}class Re extends Se{constructor(t,e){super(t,"google.com",e)}}class Ne extends xe{constructor(t,e,n){super(t,"twitter.com",e,n)}}function Me(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(t){var e,n;if(!t)return null;const{providerId:i}=t,s=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},r=t.isNewUser||"identitytoolkit#SignupNewUserResponse"===t.kind;if(!i&&(null==t?void 0:t.idToken)){const i=null===(n=null===(e=Y(t.idToken))||void 0===e?void 0:e.firebase)||void 0===n?void 0:n.sign_in_provider;if(i)return new Se(r,"anonymous"!==i&&"custom"!==i?i:null)}if(!i)return null;switch(i){case"facebook.com":return new Ae(r,s);case"github.com":return new Oe(r,s);case"google.com":return new Re(r,s);case"twitter.com":return new Ne(r,s,t.screenName||null);case"custom":case"anonymous":return new Se(r,null);default:return new Se(r,i,s)}}(n)}function De(t,e){return(0,i.m9)(t).setPersistence(e)}function Fe(t,e,n,s){return(0,i.m9)(t).onIdTokenChanged(e,n,s)}function Be(t,e,n){return(0,i.m9)(t).beforeAuthStateChanged(e,n)}function ze(t,e,n,s){return(0,i.m9)(t).onAuthStateChanged(e,n,s)}function Ue(t){(0,i.m9)(t).useDeviceLanguage()}function je(t,e){return(0,i.m9)(t).updateCurrentUser(e)}function qe(t){return(0,i.m9)(t).signOut()}async function Ze(t){return(0,i.m9)(t).delete()}class Ve{constructor(t,e){this.type=t,this.credential=e}static _fromIdtoken(t){return new Ve("enroll",t)}static _fromMfaPendingCredential(t){return new Ve("signin",t)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(t){var e,n;if(null==t?void 0:t.multiFactorSession){if(null===(e=t.multiFactorSession)||void 0===e?void 0:e.pendingCredential)return Ve._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.idToken)return Ve._fromIdtoken(t.multiFactorSession.idToken)}return null}}class We{constructor(t,e,n){this.session=t,this.hints=e,this.signInResolver=n}static _fromError(t,e){const n=bt(t),i=e.customData._serverResponse,s=(i.mfaInfo||[]).map((t=>ce._fromServerResponse(n,t)));I(i.mfaPendingCredential,n,"internal-error");const r=Ve._fromMfaPendingCredential(i.mfaPendingCredential);return new We(r,s,(async t=>{const s=await t._process(n,r);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:s.idToken,refreshToken:s.refreshToken});switch(e.operationType){case"signIn":const t=await Kt._fromIdTokenResponse(n,e.operationType,o);return await n._updateCurrentUser(t.user),t;case"reauthenticate":return I(e.user,n,"internal-error"),Kt._forOperation(e.user,e.operationType,o);default:y(n,"internal-error")}}))}async resolveSignIn(t){const e=t;return this.signInResolver(e)}}function He(t,e){var n;const s=(0,i.m9)(t),r=e;return I(e.customData.operationType,s,"argument-error"),I(null===(n=r.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,s,"argument-error"),We._fromError(s,r)}class Ge{constructor(t){this.user=t,this.enrolledFactors=[],t._onReload((e=>{e.mfaInfo&&(this.enrolledFactors=e.mfaInfo.map((e=>ce._fromServerResponse(t.auth,e))))}))}static _fromUser(t){return new Ge(t)}async getSession(){return Ve._fromIdtoken(await this.user.getIdToken())}async enroll(t,e){const n=t,i=await this.getSession(),s=await $(this.user,n._process(this.user.auth,i,e));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(t){const e="string"==typeof t?t:t.uid,n=await this.user.getIdToken(),i=await $(this.user,(s=this.user.auth,r={idToken:n,mfaEnrollmentId:e},z(s,"POST","/v2/accounts/mfaEnrollment:withdraw",B(s,r))));var s,r;this.enrolledFactors=this.enrolledFactors.filter((({uid:t})=>t!==e)),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(t){if("auth/user-token-expired"!==t.code)throw t}}}const Ke=new WeakMap;function Ye(t){const e=(0,i.m9)(t);return Ke.has(e)||Ke.set(e,Ge._fromUser(e)),Ke.get(e)}const $e="__sak";class Je{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem($e,"1"),this.storage.removeItem($e),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Qe extends Je{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=(0,i.z$)();return lt(t)||mt(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=gt(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const s=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);(0,i.w1)()&&10===document.documentMode&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,10):s()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Qe.type="LOCAL";const Xe=Qe;class tn extends Je{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}tn.type="SESSION";const en=tn;class nn{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new nn(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async t=>t(e.origin,s))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function sn(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}nn.receivers=[];class rn{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const h=sn("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===h)switch(e.data.status){case"ack":clearTimeout(c),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(e.data.response);break;default:clearTimeout(c),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:h,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function on(){return window}function an(){return void 0!==on().WorkerGlobalScope&&"function"==typeof on().importScripts}const hn="firebaseLocalStorageDb",cn="firebaseLocalStorage",ln="fbase_key";class un{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function dn(t,e){return t.transaction([cn],e?"readwrite":"readonly").objectStore(cn)}function pn(){const t=indexedDB.open(hn,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(cn,{keyPath:ln})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(cn)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(hn);return new un(t).toPromise()}(),e(await pn()))}))}))}async function fn(t,e,n){const i=dn(t,!0).put({[ln]:e,value:n});return new un(i).toPromise()}function _n(t,e){const n=dn(t,!0).delete(e);return new un(n).toPromise()}class mn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await pn()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return an()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nn._getInstance(an()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new rn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await pn();return await fn(t,$e,"1"),await _n(t,$e),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>fn(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=dn(t,!1).get(e),i=await new un(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>_n(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=dn(t,!1).getAll();return new un(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}mn.type="LOCAL";const gn=mn;function vn(t){return new Promise(((e,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=w("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)}))}function yn(t){return`__${t}${Math.floor(1e6*Math.random())}`}const wn=1e12;class bn{constructor(t){this.auth=t,this.counter=wn,this._widgets=new Map}render(t,e){const n=this.counter;return this._widgets.set(n,new Cn(t,this.auth.name,e||{})),this.counter++,n}reset(t){var e;const n=t||wn;null===(e=this._widgets.get(n))||void 0===e||e.delete(),this._widgets.delete(n)}getResponse(t){var e;const n=t||wn;return(null===(e=this._widgets.get(n))||void 0===e?void 0:e.getResponse())||""}async execute(t){var e;const n=t||wn;return null===(e=this._widgets.get(n))||void 0===e||e.execute(),""}}class Cn{constructor(t,e,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i="string"==typeof t?document.getElementById(t):t;I(i,"argument-error",{appName:e}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<50;t++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}();const{callback:t,"expired-callback":e}=this.params;if(t)try{t(this.responseToken)}catch(t){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,e)try{e()}catch(t){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Tn=yn("rcb"),In=new R(3e4,6e4);class En{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!on().grecaptcha}load(t,e=""){return I(function(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}(e),t,"argument-error"),this.shouldResolveImmediately(e)?Promise.resolve(on().grecaptcha):new Promise(((n,s)=>{const r=on().setTimeout((()=>{s(w(t,"network-request-failed"))}),In.get());on()[Tn]=()=>{on().clearTimeout(r),delete on()[Tn];const i=on().grecaptcha;if(!i)return void s(w(t,"internal-error"));const o=i.render;i.render=(t,e)=>{const n=o(t,e);return this.counter++,n},this.hostLanguage=e,n(i)},vn(`https://www.google.com/recaptcha/api.js??${(0,i.xO)({onload:Tn,render:"explicit",hl:e})}`).catch((()=>{clearTimeout(r),s(w(t,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(t){return!!on().grecaptcha&&(t===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class kn{async load(t){return new bn(t)}clearedOneInstance(){}}const Pn="recaptcha",Ln={theme:"light",type:"image"};class Sn{constructor(t,e=Object.assign({},Ln),n){this.parameters=e,this.type=Pn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=bt(n),this.isInvisible="invisible"===this.parameters.size,I("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof t?document.getElementById(t):t;I(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new kn:new En,this.validateStartingState()}async verify(){this.assertNotDestroyed();const t=await this.render(),e=this.getAssertedRecaptcha();return e.getResponse(t)||new Promise((n=>{const i=t=>{t&&(this.tokenChangeListeners.delete(i),n(t))};this.tokenChangeListeners.add(i),this.isInvisible&&e.execute(t)}))}render(){try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((t=>{throw this.renderPromise=null,t}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((t=>{this.container.removeChild(t)}))}validateStartingState(){I(!this.parameters.sitekey,this.auth,"argument-error"),I(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),I("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(t){return e=>{if(this.tokenChangeListeners.forEach((t=>t(e))),"function"==typeof t)t(e);else if("string"==typeof t){const n=on()[t];"function"==typeof n&&n(e)}}}assertNotDestroyed(){I(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let t=this.container;if(!this.isInvisible){const e=document.createElement("div");t.appendChild(e),t=e}this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)}return this.widgetId}async init(){I(A()&&!an(),this.auth,"internal-error"),await function(){let t=null;return new Promise((e=>{"complete"!==document.readyState?(t=()=>e(),window.addEventListener("load",t)):e()})).catch((e=>{throw t&&window.removeEventListener("load",t),e}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const t=await async function(t){return(await z(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);I(t,this.auth,"internal-error"),this.parameters.sitekey=t}getAssertedRecaptcha(){return I(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class xn{constructor(t,e){this.verificationId=t,this.onConfirmation=e}confirm(t){const e=Nt._fromVerification(this.verificationId,t);return this.onConfirmation(e)}}async function An(t,e,n){const s=bt(t),r=await Nn(s,e,(0,i.m9)(n));return new xn(r,(t=>re(s,t)))}async function On(t,e,n){const s=(0,i.m9)(t);await ne(!1,s,"phone");const r=await Nn(s.auth,e,(0,i.m9)(n));return new xn(r,(t=>oe(s,t)))}async function Rn(t,e,n){const s=(0,i.m9)(t),r=await Nn(s.auth,e,(0,i.m9)(n));return new xn(r,(t=>ae(s,t)))}async function Nn(t,e,n){var i;const s=await n.verify();try{let r;if(I("string"==typeof s,t,"argument-error"),I(n.type===Pn,t,"argument-error"),r="string"==typeof e?{phoneNumber:e}:e,"session"in r){const e=r.session;if("phoneNumber"in r){I("enroll"===e.type,t,"internal-error");const n=await function(t,e){return z(t,"POST","/v2/accounts/mfaEnrollment:start",B(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{I("signin"===e.type,t,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;I(n,t,"missing-multi-factor-info");const o=await function(t,e){return z(t,"POST","/v2/accounts/mfaSignIn:start",B(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return z(t,"POST","/v1/accounts:sendVerificationCode",B(t,e))}(t,{phoneNumber:r.phoneNumber,recaptchaToken:s});return e}}finally{n._reset()}}async function Mn(t,e){await ee((0,i.m9)(t),e)}class Dn{constructor(t){this.providerId=Dn.PROVIDER_ID,this.auth=bt(t)}verifyPhoneNumber(t,e){return Nn(this.auth,t,(0,i.m9)(e))}static credential(t,e){return Nt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Dn.credentialFromTaggedObject(e)}static credentialFromError(t){return Dn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Nt._fromTokenResponse(e,n):null}}function Fn(t,e){return e?L(e):(I(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Dn.PROVIDER_ID="phone",Dn.PHONE_SIGN_IN_METHOD="phone";class Bn extends kt{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return At(t,this._buildIdpRequest())}_linkToIdToken(t,e){return At(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return At(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function zn(t){return se(t.auth,new Bn(t),t.bypassAuthState)}function Un(t){const{auth:e,user:n}=t;return I(n,e,"internal-error"),ie(n,new Bn(t),t.bypassAuthState)}async function jn(t){const{auth:e,user:n}=t;return I(n,e,"internal-error"),ee(n,new Bn(t),t.bypassAuthState)}class qn{constructor(t,e,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=t;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return zn;case"linkViaPopup":case"linkViaRedirect":return jn;case"reauthViaPopup":case"reauthViaRedirect":return Un;default:y(this.auth,"internal-error")}}resolve(t){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zn=new R(2e3,1e4);async function Vn(t,e,n){const i=bt(t);C(t,e,Bt);const s=Fn(i,n);return new Gn(i,"signInViaPopup",e,s).executeNotNull()}async function Wn(t,e,n){const s=(0,i.m9)(t);C(s.auth,e,Bt);const r=Fn(s.auth,n);return new Gn(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function Hn(t,e,n){const s=(0,i.m9)(t);C(s.auth,e,Bt);const r=Fn(s.auth,n);return new Gn(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class Gn extends qn{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Gn.currentPopupAction&&Gn.currentPopupAction.cancel(),Gn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return I(t,this.auth,"internal-error"),t}async onExecution(){k(1===this.filter.length,"Popup operations only handle one event");const t=sn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(w(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(w(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gn.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(w(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Zn.get())};t()}}Gn.currentPopupAction=null;const Kn=new Map;class Yn extends qn{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Kn.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=Xn(e),i=Qn(t);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}Kn.set(this.auth._key(),t)}return this.bypassAuthState||Kn.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function $n(t,e){return Qn(t)._set(Xn(e),"true")}function Jn(t,e){Kn.set(t._key(),e)}function Qn(t){return L(t._redirectPersistence)}function Xn(t){return ot("pendingRedirect",t.config.apiKey,t.name)}function ti(t,e,n){return async function(t,e,n){const i=bt(t);C(t,e,Bt);const s=Fn(i,n);return await $n(s,i),s._openRedirect(i,e,"signInViaRedirect")}(t,e,n)}function ei(t,e,n){return async function(t,e,n){const s=(0,i.m9)(t);C(s.auth,e,Bt);const r=Fn(s.auth,n);await $n(r,s.auth);const o=await ri(s);return r._openRedirect(s.auth,e,"reauthViaRedirect",o)}(t,e,n)}function ni(t,e,n){return async function(t,e,n){const s=(0,i.m9)(t);C(s.auth,e,Bt);const r=Fn(s.auth,n);await ne(!1,s,e.providerId),await $n(r,s.auth);const o=await ri(s);return r._openRedirect(s.auth,e,"linkViaRedirect",o)}(t,e,n)}async function ii(t,e){return await bt(t)._initializationPromise,si(t,e,!1)}async function si(t,e,n=!1){const i=bt(t),s=Fn(i,e),r=new Yn(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}async function ri(t){const e=sn(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}class oi{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hi(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!hi(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(w(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ai(t))}saveEventToCache(t){this.cachedEventUids.add(ai(t)),this.lastProcessedEventTime=Date.now()}}function ai(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function hi({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const ci=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,li=/^https?/;function ui(t){const e=x(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!li.test(n))return!1;if(ci.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const di=new R(3e4,6e4);function pi(){const t=on().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let fi=null;function _i(t){return fi=fi||function(t){return new Promise(((e,n)=>{var i,s,r;function o(){pi(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pi(),n(w(t,"network-request-failed"))},timeout:di.get()})}if(null===(s=null===(i=on().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=on().gapi)||void 0===r?void 0:r.load)){const e=yn("iframefcb");return on()[e]=()=>{gapi.load?o():n(w(t,"network-request-failed"))},vn(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw fi=null,t}))}(t),fi}const mi=new R(5e3,15e3),gi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yi(t){const e=t.config;I(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?N(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,r={apiKey:e.apiKey,appName:t.name,v:s.Jn},o=vi.get(t.config.apiHost);o&&(r.eid=o);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${(0,i.xO)(r).slice(1)}`}const wi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class bi{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Ci(t,e,n,r,o,a){I(t.config.authDomain,t,"auth-domain-config-required"),I(t.config.apiKey,t,"invalid-api-key");const h={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:s.Jn,eventId:o};if(e instanceof Bt){e.setDefaultLanguage(t.languageCode),h.providerId=e.providerId||"",(0,i.xb)(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(a||{}))h[t]=e}if(e instanceof zt){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(h.scopes=t.join(","))}t.tenantId&&(h.tid=t.tenantId);const c=h;for(const t of Object.keys(c))void 0===c[t]&&delete c[t];return`${function({config:t}){return t.emulator?N(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${(0,i.xO)(c).slice(1)}`}const Ti="webStorageSupport",Ii=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=en,this._completeRedirectFn=si,this._overrideRedirectResult=Jn}async _openPopup(t,e,n,s){var r;return k(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,s=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const c=Object.assign(Object.assign({},wi),{width:s.toString(),height:r.toString(),top:o,left:a}),l=(0,i.z$)().toLowerCase();n&&(h=ut(l)?"_blank":n),ct(l)&&(e=e||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=(0,i.z$)()){var e;return mt(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==h)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",h),new bi(null);const d=window.open(e||"",h,u);I(d,t,"popup-blocked");try{d.focus()}catch(t){}return new bi(d)}(t,Ci(t,e,n,x(),s),sn())}async _openRedirect(t,e,n,i){var s;return await this._originValidation(t),s=Ci(t,e,n,x(),i),on().location.href=s,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(k(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await _i(t),n=on().gapi;return I(n,t,"internal-error"),e.open({where:document.body,url:yi(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gi,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=w(t,"network-request-failed"),r=on().setTimeout((()=>{i(s)}),mi.get());function o(){on().clearTimeout(r),n(e)}e.ping(o).then(o,(()=>{i(s)}))}))))}(t),n=new oi(t);return e.register("authEvent",(e=>(I(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ti,{type:Ti},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==s&&e(!!s),y(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return z(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(ui(t))return}catch(t){}y(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return gt()||lt()||mt()}};class Ei extends class{constructor(t){this.factorId=t}_process(t,e,n){switch(e.type){case"enroll":return this._finalizeEnroll(t,e.credential,n);case"signin":return this._finalizeSignIn(t,e.credential);default:return E("unexpected MultiFactorSessionType")}}}{constructor(t){super("phone"),this.credential=t}static _fromCredential(t){return new Ei(t)}_finalizeEnroll(t,e,n){return function(t,e){return z(t,"POST","/v2/accounts/mfaEnrollment:finalize",B(t,e))}(t,{idToken:e,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(t,e){return function(t,e){return z(t,"POST","/v2/accounts/mfaSignIn:finalize",B(t,e))}(t,{mfaPendingCredential:e,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ki{constructor(){}static assertion(t){return Ei._fromCredential(t)}}ki.FACTOR_ID="phone";var Pi,Li="@firebase/auth",Si="0.20.2";class xi{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){I(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ai(t=(0,s.Mq)()){const e=(0,s.qX)(t,"auth");return e.isInitialized()?e.getImmediate():S(t,{popupRedirectResolver:Ii,persistence:[gn,Xe,en]})}Pi="Browser",(0,s.Xd)(new a.wA("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:s,authDomain:r}=n.options;return((t,n)=>{I(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),I(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const i={apiKey:s,authDomain:r,clientPlatform:Pi,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vt(Pi)},o=new wt(t,n,i);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(L);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(o,e),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),(0,s.Xd)(new a.wA("auth-internal",(t=>{return e=bt(t.getProvider("auth").getImmediate()),new xi(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KN)(Li,Si,void 0),(0,s.KN)(Li,Si,"esm2017")},1602:(t,e,n)=>{"use strict";n.r(e),n.d(e,{DataSnapshot:()=>ks,Database:()=>wr,OnDisconnect:()=>ws,QueryConstraint:()=>Gs,TransactionResult:()=>Or,_QueryImpl:()=>bs,_QueryParams:()=>ge,_ReferenceImpl:()=>Es,_TEST_ACCESS_forceRestClient:()=>Mr,_TEST_ACCESS_hijackHash:()=>Nr,_repoManagerDatabaseFromApp:()=>yr,_setSDKVersion:()=>l,_validatePathString:()=>Mi,_validateWritablePath:()=>Di,child:()=>Ss,connectDatabaseEmulator:()=>Er,enableLogging:()=>Lr,endAt:()=>Ys,endBefore:()=>Js,equalTo:()=>_r,forceLongPolling:()=>Tr,forceWebSockets:()=>Cr,get:()=>Fs,getDatabase:()=>Ir,goOffline:()=>kr,goOnline:()=>Pr,increment:()=>Ar,limitToFirst:()=>ir,limitToLast:()=>rr,off:()=>Hs,onChildAdded:()=>qs,onChildChanged:()=>Zs,onChildMoved:()=>Vs,onChildRemoved:()=>Ws,onDisconnect:()=>xs,onValue:()=>js,orderByChild:()=>ar,orderByKey:()=>cr,orderByPriority:()=>ur,orderByValue:()=>pr,push:()=>As,query:()=>mr,ref:()=>Ps,refFromURL:()=>Ls,remove:()=>Os,runTransaction:()=>Rr,serverTimestamp:()=>xr,set:()=>Rs,setPriority:()=>Ns,setWithPriority:()=>Ms,startAfter:()=>er,startAt:()=>Xs,update:()=>Ds});var i=n(7466),s=n(7087),r=n(9901),o=n(4959);const a="@firebase/database",h="0.13.0";let c="";function l(t){c=t}class u{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,r.Pz)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,r.cI)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class d{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,r.r3)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const p=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new u(e)}}catch(t){}return new d},f=p("localStorage"),_=p("sessionStorage"),m=new o.Yd("@firebase/database"),g=function(){let t=1;return function(){return t++}}(),v=function(t){const e=(0,r.dS)(t),n=new r.gQ;n.update(e);const i=n.digest();return r.US.encodeByteArray(i)},y=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=y.apply(null,i):e+="object"==typeof i?(0,r.Pz)(i):i,e+=" "}return e};let w=null,b=!0;const C=function(t,e){(0,r.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(m.logLevel=o.in.VERBOSE,w=m.log.bind(m),e&&_.set("logging_enabled",!0)):"function"==typeof t?w=t:(w=null,_.remove("logging_enabled"))},T=function(...t){if(!0===b&&(b=!1,null===w&&!0===_.get("logging_enabled")&&C(!0)),w){const e=y.apply(null,t);w(e)}},I=function(t){return function(...e){T(t,...e)}},E=function(...t){const e="FIREBASE INTERNAL ERROR: "+y(...t);m.error(e)},k=function(...t){const e=`FIREBASE FATAL ERROR: ${y(...t)}`;throw m.error(e),new Error(e)},P=function(...t){const e="FIREBASE WARNING: "+y(...t);m.warn(e)},L=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},S="[MIN_NAME]",x="[MAX_NAME]",A=function(t,e){if(t===e)return 0;if(t===S||e===x)return-1;if(e===S||t===x)return 1;{const n=z(t),i=z(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1}},O=function(t,e){return t===e?0:t<e?-1:1},R=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,r.Pz)(e))},N=function(t){if("object"!=typeof t||null===t)return(0,r.Pz)(t);const e=[];for(const n in t)e.push(n);e.sort();let n="{";for(let i=0;i<e.length;i++)0!==i&&(n+=","),n+=(0,r.Pz)(e[i]),n+=":",n+=N(t[e[i]]);return n+="}",n},M=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function D(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const F=function(t){(0,r.hu)(!L(t),"Invalid JSON number");let e,n,i,s,o;0===t?(n=0,i=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),n=s+1023,i=Math.round(t*Math.pow(2,52-s)-Math.pow(2,52))):(n=0,i=Math.round(t/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();const h=a.join("");let c="";for(o=0;o<64;o+=8){let t=parseInt(h.substr(o,8),2).toString(16);1===t.length&&(t="0"+t),c+=t}return c.toLowerCase()},B=new RegExp("^-?(0*)\\d{1,10}$"),z=function(t){if(B.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},U=function(t){try{t()}catch(t){setTimeout((()=>{const e=t.stack||"";throw P("Exception was thrown by user callback.",e),t}),Math.floor(0))}},j=function(t,e){const n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n};class q{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((t=>this.appCheck=t))}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise(((e,n)=>{setTimeout((()=>{this.appCheck?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((e=>e.addTokenListener(t)))}notifyForInvalidToken(){P(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Z{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((t=>this.auth_=t))}getToken(t){return this.auth_?this.auth_.getToken(t).catch((t=>t&&"auth/token-not-initialized"===t.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t))):new Promise(((e,n)=>{setTimeout((()=>{this.auth_?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((e=>e.addAuthTokenListener(t)))}removeTokenChangeListener(t){this.authProvider_.get().then((e=>e.removeAuthTokenListener(t)))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',P(t)}}class V{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}V.OWNER="owner";const W=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,H="websocket",G="long_polling";class K{constructor(t,e,n,i,s=!1,r="",o=!1){this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=r,this.includeNamespaceInQueryParams=o,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function Y(t,e,n){let i;if((0,r.hu)("string"==typeof e,"typeof type must == string"),(0,r.hu)("object"==typeof n,"typeof params must == object"),e===H)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==G)throw new Error("Unknown connection type: "+e);i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const s=[];return D(n,((t,e)=>{s.push(t+"="+e)})),i+s.join("&")}class ${constructor(){this.counters_={}}incrementCounter(t,e=1){(0,r.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,r.p$)(this.counters_)}}const J={},Q={};function X(t){const e=t.toString();return J[e]||(J[e]=new $),J[e]}class tt{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&U((()=>{this.onMessage_(t[e])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class et{constructor(t,e,n,i,s,r,o){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=r,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=I(t),this.stats_=X(e),this.urlFn=t=>(this.appCheckToken&&(t.ac=this.appCheckToken),Y(e,G,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new tt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,r.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new nt(((...t)=>{const[e,n,i,s,r]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===e)this.id=n,this.password=i;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)}),(()=>{this.onClosed_()}),this.urlFn);const t={start:"t"};t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){et.forceAllow_=!0}static forceDisallow(){et.forceDisallow_=!0}static isAvailable(){return!((0,r.Yr)()||!et.forceAllow_&&(et.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,r.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=(0,r.h$)(e),i=M(n,1840);for(let t=0;t<i.length;t++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[t]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,r.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,r.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class nt{constructor(t,e,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,r.Yr)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=g(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=nt.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(t){T("frame writing exception"),t.stack&&T(t.stack),T(t)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||T("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const t=this.pendingSegs.shift();n=n+"&seg"+i+"="+t.seg+"&ts"+i+"="+t.ts+"&d"+i+"="+t.d,i++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(t,(()=>{clearTimeout(i),n()}))}addTag(t,e){(0,r.Yr)()?this.doNodeLongPoll(t,e):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{T("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(t){}}),Math.floor(1))}}let it=null;"undefined"!=typeof MozWebSocket?it=MozWebSocket:"undefined"!=typeof WebSocket&&(it=WebSocket);class st{constructor(t,e,n,i,s,r,o){this.connId=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=I(this.connId),this.stats_=X(e),this.connURL=st.connectionURL_(e,r,o,i,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,i,s){const o={v:"5"};return!(0,r.Yr)()&&"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(o.r="f"),e&&(o.s=e),n&&(o.ls=n),i&&(o.ac=i),s&&(o.p=s),Y(t,H,o)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{let t;if((0,r.Yr)()){const t=this.nodeAdmin?"AdminNode":"Node",e={headers:{"User-Agent":`Firebase/5/${c}/${{env:{NODE_ENV:"production"}}.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production"},i=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;i&&(e.proxy={origin:i})}this.mySock=new it(this.connURL,[],t)}catch(t){this.log_("Error instantiating WebSocket.");const e=t.message||t.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){st.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==it&&!st.forceDisallow_}static previouslyFailed(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")}markConnectionHealthy(){f.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=(0,r.cI)(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,r.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=(0,r.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=M(e,16384);n.length>1&&this.sendString_(String(n.length));for(let t=0;t<n.length;t++)this.sendString_(n[t])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}st.responsesRequiredToBeHealthy=2,st.healthyTimeout=3e4;class rt{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[et,st]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=st&&st.isAvailable();let n=e&&!st.previouslyFailed();if(t.webSocketOnly&&(e||P("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[st];else{const t=this.transports_=[];for(const e of rt.ALL_TRANSPORTS)e&&e.isAvailable()&&t.push(e);rt.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}rt.globalTransportInitialized_=!1;class ot{constructor(t,e,n,i,s,r,o,a,h,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=r,this.onReady_=o,this.onDisconnect_=a,this.onKill_=h,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=I("c:"+this.id+":"),this.transportManager_=new rt(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(e,n)}),Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=j((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=R("t",t),n=R("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=R("t",t),n=R("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=R("t",t);if("d"in t){const n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?E("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&P("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),j((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):j((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class at{put(t,e,n,i){}merge(t,e,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class ht{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,r.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const i=this.getInitialEvent(t);i&&e.apply(n,i)}off(t,e,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let t=0;t<i.length;t++)if(i[t].callback===e&&(!n||n===i[t].context))return void i.splice(t,1)}validateEventType_(t){(0,r.hu)(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class ct extends ht{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,r.uI)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ct}getInitialEvent(t){return(0,r.hu)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class lt{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function ut(){return new lt("")}function dt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function pt(t){return t.pieces_.length-t.pieceNum_}function ft(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new lt(t.pieces_,e)}function _t(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function mt(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function gt(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new lt(e,0)}function vt(t,e){const n=[];for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);if(e instanceof lt)for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new lt(n,0)}function yt(t){return t.pieceNum_>=t.pieces_.length}function wt(t,e){const n=dt(t),i=dt(e);if(null===n)return e;if(n===i)return wt(ft(t),ft(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function bt(t,e){const n=mt(t,0),i=mt(e,0);for(let t=0;t<n.length&&t<i.length;t++){const e=A(n[t],i[t]);if(0!==e)return e}return n.length===i.length?0:n.length<i.length?-1:1}function Ct(t,e){if(pt(t)!==pt(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function Tt(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(pt(t)>pt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class It{constructor(t,e){this.errorPrefix_=e,this.parts_=mt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let t=0;t<this.parts_.length;t++)this.byteLength_+=(0,r.ug)(this.parts_[t]);Et(this)}}function Et(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+kt(t))}function kt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class Pt extends ht{constructor(){let t,e;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,(()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))}),!1)}static getInstance(){return new Pt}getInitialEvent(t){return(0,r.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Lt=1e3;class St extends at{constructor(t,e,n,i,s,o,a,h){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=h,this.id=St.nextPersistentConnectionId_++,this.log_=I("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Lt,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h&&!(0,r.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Pt.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&ct.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const i=++this.requestNumber_,s={r:i,a:t,b:e};this.log_((0,r.Pz)(s)),(0,r.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[i]=n)}get(t){this.initConnection_();const e=new r.BH,n={p:t._path.toString(),q:t._queryObject},i={action:"g",request:n,onComplete:t=>{const i=t.d;"ok"===t.s?(this.onDataUpdate_(n.p,i,!1,null),e.resolve(i)):e.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const t=this.outstandingGets_[s];void 0!==t&&i===t&&(delete this.outstandingGets_[s],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+s+" timed out on connection"),e.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(s),e.promise}listen(t,e,n,i){this.initConnection_();const s=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),(0,r.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,r.hu)(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:e,query:t,tag:n};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,(n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)}))}sendListen_(t){const e=t.query,n=e._path.toString(),i=e._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n};t.tag&&(s.q=e._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(s=>{const r=s.d,o=s.s;St.warnOnListenWarnings_(r,e),(this.listens.get(n)&&this.listens.get(n).get(i))===t&&(this.log_("listen response",s),"ok"!==o&&this.removeListen_(n,i),t.onComplete&&t.onComplete(o,r))}))}static warnOnListenWarnings_(t,e){if(t&&"object"==typeof t&&(0,r.r3)(t,"w")){const n=(0,r.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();P(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,r.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=(0,r.w9)(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,(e=>{const n=e.s,i=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)}))}unlisten(t,e){const n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),(0,r.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,e)}sendUnlisten_(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);const s={p:t};i&&(s.q=n,s.t=i),this.sendRequest("n",s)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,i){const s={p:e,d:n};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,(t=>{i&&setTimeout((()=>{i(t.s,t.d)}),Math.floor(0))}))}put(t,e,n,i){this.putInternal("p",t,e,n,i)}merge(t,e,n,i){this.putInternal("m",t,e,n,i)}putInternal(t,e,n,i,s){this.initConnection_();const r={p:e,d:n};void 0!==s&&(r.h=s),this.outstandingPuts_.push({action:t,request:r,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,(n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,(t=>{if("ok"!==t.s){const e=t.d;this.log_("reportStats","Error sending stats: "+e)}}))}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,r.Pz)(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+(0,r.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,r.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Lt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+St.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const h=function(){a?a.close():(o=!0,n())},c=function(t){(0,r.hu)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)};this.realtime_={close:h,sendRequest:c};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[r,h]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);o?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),this.authToken_=r&&r.accessToken,this.appCheckToken_=h&&h.token,a=new ot(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,n,(t=>{P(t+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),s))}catch(t){this.log_("Failed to get token: "+t),o||(this.repoInfo_.nodeAdmin&&P(t),h())}}}interrupt(t){T("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){T("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,r.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map((t=>N(t))).join("$"):"default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,e){const n=new lt(t).toString();let i;if(this.listens.has(n)){const t=this.listens.get(n);i=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,e){T("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){T("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";(0,r.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+c.replace(/\./g,"-")]=1,(0,r.uI)()?t["framework.cordova"]=1:(0,r.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=ct.getInstance().currentlyOnline();return(0,r.xb)(this.interruptReasons_)&&t}}St.nextPersistentConnectionId_=0,St.nextConnectionId_=0;class xt{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new xt(t,e)}}class At{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new xt(S,t),i=new xt(S,e);return 0!==this.compare(n,i)}minPost(){return xt.MIN}}let Ot;class Rt extends At{static get __EMPTY_NODE(){return Ot}static set __EMPTY_NODE(t){Ot=t}compare(t,e){return A(t.name,e.name)}isDefinedOn(t){throw(0,r.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return xt.MIN}maxPost(){return new xt(x,Ot)}makePost(t,e){return(0,r.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new xt(t,Ot)}toString(){return".key"}}const Nt=new Rt;class Mt{constructor(t,e,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse_?t.left:t.right;else{if(0===r){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Dt{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:Dt.RED,this.left=null!=i?i:Ft.EMPTY_NODE,this.right=null!=s?s:Ft.EMPTY_NODE}copy(t,e,n,i,s){return new Dt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ft.EMPTY_NODE;let t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,i;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Ft.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Dt.RED=!0,Dt.BLACK=!1;class Ft{constructor(t,e=Ft.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new Ft(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Dt.BLACK,null,null))}remove(t){return new Ft(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Dt.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,i=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Mt(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new Mt(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new Mt(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new Mt(this.root_,null,this.comparator_,!0,t)}}function Bt(t,e){return A(t.name,e.name)}function zt(t,e){return A(t,e)}let Ut;Ft.EMPTY_NODE=new class{copy(t,e,n,i,s){return this}insert(t,e,n){return new Dt(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const jt=function(t){return"number"==typeof t?"number:"+F(t):"string:"+t},qt=function(t){if(t.isLeafNode()){const e=t.val();(0,r.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,r.r3)(e,".sv"),"Priority must be a string or number.")}else(0,r.hu)(t===Ut||t.isEmpty(),"priority of unexpected type.");(0,r.hu)(t===Ut||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Zt,Vt,Wt;class Ht{constructor(t,e=Ht.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,(0,r.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),qt(this.priorityNode_)}static set __childrenNodeConstructor(t){Zt=t}static get __childrenNodeConstructor(){return Zt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Ht(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:Ht.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return yt(t)?this:".priority"===dt(t)?this.priorityNode_:Ht.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Ht.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const n=dt(t);return null===n?e:e.isEmpty()&&".priority"!==n?this:((0,r.hu)(".priority"!==n||1===pt(t),".priority must be the last token in a path"),this.updateImmediateChild(n,Ht.__childrenNodeConstructor.EMPTY_NODE.updateChild(ft(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+jt(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=v(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Ht.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Ht.__childrenNodeConstructor?-1:((0,r.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,n=typeof this.value_,i=Ht.VALUE_TYPE_ORDER.indexOf(e),s=Ht.VALUE_TYPE_ORDER.indexOf(n);return(0,r.hu)(i>=0,"Unknown leaf type: "+e),(0,r.hu)(s>=0,"Unknown leaf type: "+n),i===s?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}Ht.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Gt=new class extends At{compare(t,e){const n=t.node.getPriority(),i=e.node.getPriority(),s=n.compareTo(i);return 0===s?A(t.name,e.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return xt.MIN}maxPost(){return new xt(x,new Ht("[PRIORITY-POST]",Wt))}makePost(t,e){const n=Vt(t);return new xt(e,new Ht("[PRIORITY-POST]",n))}toString(){return".priority"}},Kt=Math.log(2);class Yt{constructor(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Kt,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=t+1&n}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const $t=function(t,e,n,i){t.sort(e);const s=function(e,i){const r=i-e;let o,a;if(0===r)return null;if(1===r)return o=t[e],a=n?n(o):o,new Dt(a,o.node,Dt.BLACK,null,null);{const h=parseInt(r/2,10)+e,c=s(e,h),l=s(h+1,i);return o=t[h],a=n?n(o):o,new Dt(a,o.node,Dt.BLACK,c,l)}},r=function(e){let i=null,r=null,o=t.length;const a=function(e,i){const r=o-e,a=o;o-=e;const c=s(r+1,a),l=t[r],u=n?n(l):l;h(new Dt(u,l.node,i,null,c))},h=function(t){i?(i.left=t,i=t):(r=t,i=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),i=Math.pow(2,e.count-(t+1));n?a(i,Dt.BLACK):(a(i,Dt.BLACK),a(i,Dt.RED))}return r}(new Yt(t.length));return new Ft(i||e,r)};let Jt;const Qt={};class Xt{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return(0,r.hu)(Qt&&Gt,"ChildrenNode.ts has not been loaded"),Jt=Jt||new Xt({".priority":Qt},{".priority":Gt}),Jt}get(t){const e=(0,r.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ft?e:null}hasIndex(t){return(0,r.r3)(this.indexSet_,t.toString())}addIndex(t,e){(0,r.hu)(t!==Nt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const s=e.getIterator(xt.Wrap);let o,a=s.getNext();for(;a;)i=i||t.isDefinedOn(a.node),n.push(a),a=s.getNext();o=i?$t(n,t.getCompare()):Qt;const h=t.toString(),c=Object.assign({},this.indexSet_);c[h]=t;const l=Object.assign({},this.indexes_);return l[h]=o,new Xt(l,c)}addToIndexes(t,e){const n=(0,r.UI)(this.indexes_,((n,i)=>{const s=(0,r.DV)(this.indexSet_,i);if((0,r.hu)(s,"Missing index implementation for "+i),n===Qt){if(s.isDefinedOn(t.node)){const n=[],i=e.getIterator(xt.Wrap);let r=i.getNext();for(;r;)r.name!==t.name&&n.push(r),r=i.getNext();return n.push(t),$t(n,s.getCompare())}return Qt}{const i=e.get(t.name);let s=n;return i&&(s=s.remove(new xt(t.name,i))),s.insert(t,t.node)}}));return new Xt(n,this.indexSet_)}removeFromIndexes(t,e){const n=(0,r.UI)(this.indexes_,(n=>{if(n===Qt)return n;{const i=e.get(t.name);return i?n.remove(new xt(t.name,i)):n}}));return new Xt(n,this.indexSet_)}}let te;class ee{constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&qt(this.priorityNode_),this.children_.isEmpty()&&(0,r.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return te||(te=new ee(new Ft(zt),null,Xt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||te}updatePriority(t){return this.children_.isEmpty()?this:new ee(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?te:e}}getChild(t){const e=dt(t);return null===e?this:this.getImmediateChild(e).getChild(ft(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,e){if((0,r.hu)(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);{const n=new xt(t,e);let i,s;e.isEmpty()?(i=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,e),s=this.indexMap_.addToIndexes(n,this.children_));const r=i.isEmpty()?te:this.priorityNode_;return new ee(i,r,s)}}updateChild(t,e){const n=dt(t);if(null===n)return e;{(0,r.hu)(".priority"!==dt(t)||1===pt(t),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(ft(t),e);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,i=0,s=!0;if(this.forEachChild(Gt,((r,o)=>{e[r]=o.val(t),n++,s&&ee.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):s=!1})),!t&&s&&i<2*n){const t=[];for(const n in e)t[n]=e[n];return t}return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+jt(this.getPriority().val())+":"),this.forEachChild(Gt,((e,n)=>{const i=n.hash();""!==i&&(t+=":"+e+":"+i)})),this.lazyHash_=""===t?"":v(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new xt(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new xt(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new xt(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal((t=>e(t.name,t.node))):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(t=>t));{const n=this.children_.getIteratorFrom(t.name,xt.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(t=>t));{const n=this.children_.getReverseIteratorFrom(t.name,xt.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)>0;)n.getNext(),i=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ne?-1:0}withIndex(t){if(t===Nt||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new ee(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===Nt||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(Gt),n=e.getIterator(Gt);let i=t.getNext(),s=n.getNext();for(;i&&s;){if(i.name!==s.name||!i.node.equals(s.node))return!1;i=t.getNext(),s=n.getNext()}return null===i&&null===s}return!1}return!1}}resolveIndex_(t){return t===Nt?null:this.indexMap_.get(t.toString())}}ee.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const ne=new class extends ee{constructor(){super(new Ft(zt),ee.EMPTY_NODE,Xt.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ee.EMPTY_NODE}isEmpty(){return!1}};function ie(t,e=null){if(null===t)return ee.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,r.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Ht(t,ie(e));if(t instanceof Array){let n=ee.EMPTY_NODE;return D(t,((e,i)=>{if((0,r.r3)(t,e)&&"."!==e.substring(0,1)){const t=ie(i);!t.isLeafNode()&&t.isEmpty()||(n=n.updateImmediateChild(e,t))}})),n.updatePriority(ie(e))}{const n=[];let i=!1;if(D(t,((t,e)=>{if("."!==t.substring(0,1)){const s=ie(e);s.isEmpty()||(i=i||!s.getPriority().isEmpty(),n.push(new xt(t,s)))}})),0===n.length)return ee.EMPTY_NODE;const s=$t(n,Bt,(t=>t.name),zt);if(i){const t=$t(n,Gt.getCompare());return new ee(s,ie(e),new Xt({".priority":t},{".priority":Gt}))}return new ee(s,ie(e),Xt.Default)}}Object.defineProperties(xt,{MIN:{value:new xt(S,ee.EMPTY_NODE)},MAX:{value:new xt(x,ne)}}),Rt.__EMPTY_NODE=ee.EMPTY_NODE,Ht.__childrenNodeConstructor=ee,Ut=ne,Wt=ne,function(t){Vt=t}(ie);class se extends At{constructor(t){super(),this.indexPath_=t,(0,r.hu)(!yt(t)&&".priority"!==dt(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),i=this.extractChild(e.node),s=n.compareTo(i);return 0===s?A(t.name,e.name):s}makePost(t,e){const n=ie(t),i=ee.EMPTY_NODE.updateChild(this.indexPath_,n);return new xt(e,i)}maxPost(){const t=ee.EMPTY_NODE.updateChild(this.indexPath_,ne);return new xt(x,t)}toString(){return mt(this.indexPath_,0).join("/")}}const re=new class extends At{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?A(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return xt.MIN}maxPost(){return xt.MAX}makePost(t,e){const n=ie(t);return new xt(e,n)}toString(){return".value"}},oe="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ae=function(){let t=0;const e=[];return function(n){const i=n===t;let s;t=n;const o=new Array(8);for(s=7;s>=0;s--)o[s]=oe.charAt(n%64),n=Math.floor(n/64);(0,r.hu)(0===n,"Cannot push at time == 0");let a=o.join("");if(i){for(s=11;s>=0&&63===e[s];s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(64*Math.random());for(s=0;s<12;s++)a+=oe.charAt(e[s]);return(0,r.hu)(20===a.length,"nextPushId: Length should be 20."),a}}(),he=function(t){if("2147483647"===t)return"-";const e=z(t);if(null!=e)return""+(e+1);const n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t.charAt(e);if(n.length<786)return n.push("-"),n.join("");let i=n.length-1;for(;i>=0&&"z"===n[i];)i--;if(-1===i)return x;const s=n[i],r=oe.charAt(oe.indexOf(s)+1);return n[i]=r,n.slice(0,i+1).join("")},ce=function(t){if("-2147483648"===t)return S;const e=z(t);if(null!=e)return""+(e-1);const n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t.charAt(e);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=oe.charAt(oe.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function le(t){return{type:"value",snapshotNode:t}}function ue(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function de(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function pe(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class fe{constructor(t){this.index_=t}updateChild(t,e,n,i,s,o){(0,r.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(e);return a.getChild(i).equals(n.getChild(i))&&a.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(de(e,a)):(0,r.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ue(e,n)):o.trackChildChange(pe(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))}updateFullNode(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Gt,((t,i)=>{e.hasChild(t)||n.trackChildChange(de(t,i))})),e.isLeafNode()||e.forEachChild(Gt,((e,i)=>{if(t.hasChild(e)){const s=t.getImmediateChild(e);s.equals(i)||n.trackChildChange(pe(e,i,s))}else n.trackChildChange(ue(e,i))}))),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?ee.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class _e{constructor(t){this.indexedFilter_=new fe(t.getIndex()),this.index_=t.getIndex(),this.startPost_=_e.getStartPost_(t),this.endPost_=_e.getEndPost_(t)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0}updateChild(t,e,n,i,s,r){return this.matches(new xt(e,n))||(n=ee.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,s,r)}updateFullNode(t,e,n){e.isLeafNode()&&(e=ee.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);const s=this;return e.forEachChild(Gt,((t,e)=>{s.matches(new xt(t,e))||(i=i.updateImmediateChild(t,ee.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class me{constructor(t){this.rangedFilter_=new _e(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}updateChild(t,e,n,i,s,r){return this.rangedFilter_.matches(new xt(e,n))||(n=ee.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,s,r):this.fullLimitUpdateChild_(t,e,n,s,r)}updateFullNode(t,e,n){let i;if(e.isLeafNode()||e.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let t;i=ee.EMPTY_NODE.withIndex(this.index_),t=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){const e=t.getNext();let s;if(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),e)<=0:this.index_.compare(e,this.rangedFilter_.getEndPost())<=0,!s)break;i=i.updateImmediateChild(e.name,e.node),n++}}else{let t,n,s,r;if(i=e.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE),this.reverse_){r=i.getReverseIterator(this.index_),t=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else r=i.getIterator(this.index_),t=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),s=this.index_.getCompare();let o=0,a=!1;for(;r.hasNext();){const e=r.getNext();!a&&s(t,e)<=0&&(a=!0),a&&o<this.limit_&&s(e,n)<=0?o++:i=i.updateImmediateChild(e.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,n,i,s){let o;if(this.reverse_){const t=this.index_.getCompare();o=(e,n)=>t(n,e)}else o=this.index_.getCompare();const a=t;(0,r.hu)(a.numChildren()===this.limit_,"");const h=new xt(e,n),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(h);if(a.hasChild(e)){const t=a.getImmediateChild(e);let r=i.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=r&&(r.name===e||a.hasChild(r.name));)r=i.getChildAfterChild(this.index_,r,this.reverse_);const u=null==r?1:o(r,h);if(l&&!n.isEmpty()&&u>=0)return null!=s&&s.trackChildChange(pe(e,n,t)),a.updateImmediateChild(e,n);{null!=s&&s.trackChildChange(de(e,t));const n=a.updateImmediateChild(e,ee.EMPTY_NODE);return null!=r&&this.rangedFilter_.matches(r)?(null!=s&&s.trackChildChange(ue(r.name,r.node)),n.updateImmediateChild(r.name,r.node)):n}}return n.isEmpty()?t:l&&o(c,h)>=0?(null!=s&&(s.trackChildChange(de(c.name,c.node)),s.trackChildChange(ue(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(c.name,ee.EMPTY_NODE)):t}}class ge{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Gt}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,r.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,r.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:S}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,r.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,r.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:x}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,r.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Gt}copy(){const t=new ge;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function ve(t,e,n){const i=t.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function ye(t,e,n){const i=t.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function we(t,e){const n=t.copy();return n.index_=e,n}function be(t){const e={};if(t.isDefault())return e;let n;return t.index_===Gt?n="$priority":t.index_===re?n="$value":t.index_===Nt?n="$key":((0,r.hu)(t.index_ instanceof se,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,r.Pz)(n),t.startSet_&&(e.startAt=(0,r.Pz)(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+(0,r.Pz)(t.indexStartName_))),t.endSet_&&(e.endAt=(0,r.Pz)(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+(0,r.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Ce(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Gt&&(e.i=t.index_.toString()),e}class Te extends at{constructor(t,e,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=I("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,r.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=Te.getListenId_(t,n),a={};this.listens_[o]=a;const h=be(t._queryParams);this.restRequest_(s+".json",h,((t,e)=>{let h=e;if(404===t&&(h=null,t=null),null===t&&this.onDataUpdate_(s,h,!1,n),(0,r.DV)(this.listens_,o)===a){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(e,null)}}))}unlisten(t,e){const n=Te.getListenId_(t,e);delete this.listens_[n]}get(t){const e=be(t._queryParams),n=t._path.toString(),i=new r.BH;return this.restRequest_(n+".json",e,((t,e)=>{let s=e;404===t&&(s=null,t=null),null===t?(this.onDataUpdate_(n,s,!1,null),i.resolve(s)):i.reject(new Error(s))})),i.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,s])=>{i&&i.accessToken&&(e.auth=i.accessToken),s&&s.token&&(e.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,r.xO)(e);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=(0,r.cI)(a.responseText)}catch(t){P("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&P("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()}))}}class Ie{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function Ee(){return{value:null,children:new Map}}function ke(t,e,n){if(yt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const i=dt(e);t.children.has(i)||t.children.set(i,Ee()),ke(t.children.get(i),e=ft(e),n)}}function Pe(t,e){if(yt(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Gt,((e,n)=>{ke(t,new lt(e),n)})),Pe(t,e)}}if(t.children.size>0){const n=dt(e);return e=ft(e),t.children.has(n)&&Pe(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function Le(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(((t,n)=>{e(n,t)}))}(t,((t,i)=>{Le(i,new lt(e.toString()+"/"+t),n)}))}class Se{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&D(this.last_,((t,n)=>{e[t]=e[t]-n})),this.last_=t,e}}class xe{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Se(t);const n=1e4+2e4*Math.random();j(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;D(t,((t,i)=>{i>0&&(0,r.r3)(this.statsToReport_,t)&&(e[t]=i,n=!0)})),n&&this.server_.reportStats(e),j(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ae;function Oe(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ae||(Ae={}));class Re{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ae.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(yt(this.path)){if(null!=this.affectedTree.value)return(0,r.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new lt(t));return new Re(ut(),e,this.revert)}}return(0,r.hu)(dt(this.path)===t,"operationForChild called for unrelated child."),new Re(ft(this.path),this.affectedTree,this.revert)}}class Ne{constructor(t,e){this.source=t,this.path=e,this.type=Ae.LISTEN_COMPLETE}operationForChild(t){return yt(this.path)?new Ne(this.source,ut()):new Ne(this.source,ft(this.path))}}class Me{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ae.OVERWRITE}operationForChild(t){return yt(this.path)?new Me(this.source,ut(),this.snap.getImmediateChild(t)):new Me(this.source,ft(this.path),this.snap)}}class De{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ae.MERGE}operationForChild(t){if(yt(this.path)){const e=this.children.subtree(new lt(t));return e.isEmpty()?null:e.value?new Me(this.source,ut(),e.value):new De(this.source,ut(),e)}return(0,r.hu)(dt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new De(this.source,ft(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Fe{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(yt(t))return this.isFullyInitialized()&&!this.filtered_;const e=dt(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class Be{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function ze(t,e,n,i,s,o){const a=i.filter((t=>t.type===n));a.sort(((e,n)=>function(t,e,n){if(null==e.childName||null==n.childName)throw(0,r.g5)("Should only compare child_ events.");const i=new xt(e.childName,e.snapshotNode),s=new xt(n.childName,n.snapshotNode);return t.index_.compare(i,s)}(t,e,n))),a.forEach((n=>{const i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,o);s.forEach((s=>{s.respondsTo(n.type)&&e.push(s.createEvent(i,t.query_))}))}))}function Ue(t,e){return{eventCache:t,serverCache:e}}function je(t,e,n,i){return Ue(new Fe(e,n,i),t.serverCache)}function qe(t,e,n,i){return Ue(t.eventCache,new Fe(e,n,i))}function Ze(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ve(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let We;class He{constructor(t,e=(()=>(We||(We=new Ft(O)),We))()){this.value=t,this.children=e}static fromObject(t){let e=new He(null);return D(t,((t,n)=>{e=e.set(new lt(t),n)})),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:ut(),value:this.value};if(yt(t))return null;{const n=dt(t),i=this.children.get(n);if(null!==i){const s=i.findRootMostMatchingPathAndValue(ft(t),e);return null!=s?{path:vt(new lt(n),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,(()=>!0))}subtree(t){if(yt(t))return this;{const e=dt(t),n=this.children.get(e);return null!==n?n.subtree(ft(t)):new He(null)}}set(t,e){if(yt(t))return new He(e,this.children);{const n=dt(t),i=(this.children.get(n)||new He(null)).set(ft(t),e),s=this.children.insert(n,i);return new He(this.value,s)}}remove(t){if(yt(t))return this.children.isEmpty()?new He(null):new He(null,this.children);{const e=dt(t),n=this.children.get(e);if(n){const i=n.remove(ft(t));let s;return s=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&s.isEmpty()?new He(null):new He(this.value,s)}return this}}get(t){if(yt(t))return this.value;{const e=dt(t),n=this.children.get(e);return n?n.get(ft(t)):null}}setTree(t,e){if(yt(t))return e;{const n=dt(t),i=(this.children.get(n)||new He(null)).setTree(ft(t),e);let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new He(this.value,s)}}fold(t){return this.fold_(ut(),t)}fold_(t,e){const n={};return this.children.inorderTraversal(((i,s)=>{n[i]=s.fold_(vt(t,i),e)})),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,ut(),e)}findOnPath_(t,e,n){const i=!!this.value&&n(e,this.value);if(i)return i;if(yt(t))return null;{const i=dt(t),s=this.children.get(i);return s?s.findOnPath_(ft(t),vt(e,i),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,ut(),e)}foreachOnPath_(t,e,n){if(yt(t))return this;{this.value&&n(e,this.value);const i=dt(t),s=this.children.get(i);return s?s.foreachOnPath_(ft(t),vt(e,i),n):new He(null)}}foreach(t){this.foreach_(ut(),t)}foreach_(t,e){this.children.inorderTraversal(((n,i)=>{i.foreach_(vt(t,n),e)})),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal(((e,n)=>{n.value&&t(e,n.value)}))}}class Ge{constructor(t){this.writeTree_=t}static empty(){return new Ge(new He(null))}}function Ke(t,e,n){if(yt(e))return new Ge(new He(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){const s=i.path;let r=i.value;const o=wt(s,e);return r=r.updateChild(o,n),new Ge(t.writeTree_.set(s,r))}{const i=new He(n),s=t.writeTree_.setTree(e,i);return new Ge(s)}}}function Ye(t,e,n){let i=t;return D(n,((t,n)=>{i=Ke(i,vt(e,t),n)})),i}function $e(t,e){if(yt(e))return Ge.empty();{const n=t.writeTree_.setTree(e,new He(null));return new Ge(n)}}function Je(t,e){return null!=Qe(t,e)}function Qe(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(wt(n.path,e)):null}function Xe(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Gt,((t,n)=>{e.push(new xt(t,n))})):t.writeTree_.children.inorderTraversal(((t,n)=>{null!=n.value&&e.push(new xt(t,n.value))})),e}function tn(t,e){if(yt(e))return t;{const n=Qe(t,e);return new Ge(null!=n?new He(n):t.writeTree_.subtree(e))}}function en(t){return t.writeTree_.isEmpty()}function nn(t,e){return sn(ut(),t.writeTree_,e)}function sn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal(((e,s)=>{".priority"===e?((0,r.hu)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):n=sn(vt(t,e),s,n)})),n.getChild(t).isEmpty()||null===i||(n=n.updateChild(vt(t,".priority"),i)),n}}function rn(t,e){return mn(e,t)}function on(t,e){if(t.snap)return Tt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Tt(vt(t.path,n),e))return!0;return!1}function an(t){return t.visible}function hn(t,e,n){let i=Ge.empty();for(let s=0;s<t.length;++s){const o=t[s];if(e(o)){const t=o.path;let e;if(o.snap)Tt(n,t)?(e=wt(n,t),i=Ke(i,e,o.snap)):Tt(t,n)&&(e=wt(t,n),i=Ke(i,ut(),o.snap.getChild(e)));else{if(!o.children)throw(0,r.g5)("WriteRecord should have .snap or .children");if(Tt(n,t))e=wt(n,t),i=Ye(i,e,o.children);else if(Tt(t,n))if(e=wt(t,n),yt(e))i=Ye(i,ut(),o.children);else{const t=(0,r.DV)(o.children,dt(e));if(t){const n=t.getChild(ft(e));i=Ke(i,ut(),n)}}}}}return i}function cn(t,e,n,i,s){if(i||s){const r=tn(t.visibleWrites,e);if(!s&&en(r))return n;if(s||null!=n||Je(r,ut())){const r=function(t){return(t.visible||s)&&(!i||!~i.indexOf(t.writeId))&&(Tt(t.path,e)||Tt(e,t.path))};return nn(hn(t.allWrites,r,e),n||ee.EMPTY_NODE)}return null}{const i=Qe(t.visibleWrites,e);if(null!=i)return i;{const i=tn(t.visibleWrites,e);return en(i)?n:null!=n||Je(i,ut())?nn(i,n||ee.EMPTY_NODE):null}}}function ln(t,e,n,i){return cn(t.writeTree,t.treePath,e,n,i)}function un(t,e){return function(t,e,n){let i=ee.EMPTY_NODE;const s=Qe(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Gt,((t,e)=>{i=i.updateImmediateChild(t,e)})),i;if(n){const s=tn(t.visibleWrites,e);return n.forEachChild(Gt,((t,e)=>{const n=nn(tn(s,new lt(t)),e);i=i.updateImmediateChild(t,n)})),Xe(s).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}return Xe(tn(t.visibleWrites,e)).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}(t.writeTree,t.treePath,e)}function dn(t,e,n,i){return function(t,e,n,i,s){(0,r.hu)(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=vt(e,n);if(Je(t.visibleWrites,o))return null;{const e=tn(t.visibleWrites,o);return en(e)?s.getChild(n):nn(e,s.getChild(n))}}(t.writeTree,t.treePath,e,n,i)}function pn(t,e){return function(t,e){return Qe(t.visibleWrites,e)}(t.writeTree,vt(t.treePath,e))}function fn(t,e,n){return function(t,e,n,i){const s=vt(e,n),r=Qe(t.visibleWrites,s);return null!=r?r:i.isCompleteForChild(n)?nn(tn(t.visibleWrites,s),i.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function _n(t,e){return mn(vt(t.treePath,e),t.writeTree)}function mn(t,e){return{treePath:t,writeTree:e}}class gn{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;(0,r.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,r.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if("child_added"===e&&"child_removed"===s)this.changeMap.set(n,pe(n,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===s)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===s)this.changeMap.set(n,de(n,i.oldSnap));else if("child_changed"===e&&"child_added"===s)this.changeMap.set(n,ue(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==s)throw(0,r.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(n,pe(n,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}const vn=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class yn{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new Fe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fn(this.writes_,t,e)}}getChildAfterChild(t,e,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ve(this.viewCache_),s=function(t,e,n,i,s,r){return function(t,e,n,i,s,r,o){let a;const h=tn(t.visibleWrites,e),c=Qe(h,ut());if(null!=c)a=c;else{if(null==n)return[];a=nn(h,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=o.getCompare(),n=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let h=n.getNext();for(;h&&t.length<s;)0!==e(h,i)&&t.push(h),h=n.getNext();return t}}(t.writeTree,t.treePath,e,n,i,s,r)}(this.writes_,i,e,1,n,t);return 0===s.length?null:s[0]}}function wn(t,e,n,i,s,o){const a=e.eventCache;if(null!=pn(i,n))return e;{let h,c;if(yt(n))if((0,r.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const n=Ve(e),s=un(i,n instanceof ee?n:ee.EMPTY_NODE);h=t.filter.updateFullNode(e.eventCache.getNode(),s,o)}else{const n=ln(i,Ve(e));h=t.filter.updateFullNode(e.eventCache.getNode(),n,o)}else{const l=dt(n);if(".priority"===l){(0,r.hu)(1===pt(n),"Can't have a priority with additional path components");const s=a.getNode();c=e.serverCache.getNode();const o=dn(i,n,s,c);h=null!=o?t.filter.updatePriority(s,o):a.getNode()}else{const r=ft(n);let u;if(a.isCompleteForChild(l)){c=e.serverCache.getNode();const t=dn(i,n,a.getNode(),c);u=null!=t?a.getNode().getImmediateChild(l).updateChild(r,t):a.getNode().getImmediateChild(l)}else u=fn(i,l,e.serverCache);h=null!=u?t.filter.updateChild(a.getNode(),l,u,r,s,o):a.getNode()}}return je(e,h,a.isFullyInitialized()||yt(n),t.filter.filtersNodes())}}function bn(t,e,n,i,s,r,o,a){const h=e.serverCache;let c;const l=o?t.filter:t.filter.getIndexedFilter();if(yt(n))c=l.updateFullNode(h.getNode(),i,null);else if(l.filtersNodes()&&!h.isFiltered()){const t=h.getNode().updateChild(n,i);c=l.updateFullNode(h.getNode(),t,null)}else{const t=dt(n);if(!h.isCompleteForPath(n)&&pt(n)>1)return e;const s=ft(n),r=h.getNode().getImmediateChild(t).updateChild(s,i);c=".priority"===t?l.updatePriority(h.getNode(),r):l.updateChild(h.getNode(),t,r,s,vn,null)}const u=qe(e,c,h.isFullyInitialized()||yt(n),l.filtersNodes());return wn(t,u,n,s,new yn(s,u,r),a)}function Cn(t,e,n,i,s,r,o){const a=e.eventCache;let h,c;const l=new yn(s,e,r);if(yt(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),h=je(e,c,!0,t.filter.filtersNodes());else{const s=dt(n);if(".priority"===s)c=t.filter.updatePriority(e.eventCache.getNode(),i),h=je(e,c,a.isFullyInitialized(),a.isFiltered());else{const r=ft(n),c=a.getNode().getImmediateChild(s);let u;if(yt(r))u=i;else{const t=l.getCompleteChild(s);u=null!=t?".priority"===_t(r)&&t.getChild(gt(r)).isEmpty()?t:t.updateChild(r,i):ee.EMPTY_NODE}h=c.equals(u)?e:je(e,t.filter.updateChild(a.getNode(),s,u,r,l,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return h}function Tn(t,e){return t.eventCache.isCompleteForChild(e)}function In(t,e,n){return n.foreach(((t,n)=>{e=e.updateChild(t,n)})),e}function En(t,e,n,i,s,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h,c=e;h=yt(n)?i:new He(null).setTree(n,i);const l=e.serverCache.getNode();return h.children.inorderTraversal(((n,i)=>{if(l.hasChild(n)){const h=In(0,e.serverCache.getNode().getImmediateChild(n),i);c=bn(t,c,new lt(n),h,s,r,o,a)}})),h.children.inorderTraversal(((n,i)=>{const h=!e.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!l.hasChild(n)&&!h){const h=In(0,e.serverCache.getNode().getImmediateChild(n),i);c=bn(t,c,new lt(n),h,s,r,o,a)}})),c}class kn{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new fe(n.getIndex()),s=(r=n).loadsAllData()?new fe(r.getIndex()):r.hasLimit()?new me(r):new _e(r);var r;this.processor_=function(t){return{filter:t}}(s);const o=e.serverCache,a=e.eventCache,h=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),l=new Fe(h,o.isFullyInitialized(),i.filtersNodes()),u=new Fe(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ue(u,l),this.eventGenerator_=new Be(this.query_)}get query(){return this.query_}}function Pn(t,e){const n=Ve(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!yt(e)&&!n.getImmediateChild(dt(e)).isEmpty())?n.getChild(e):null}function Ln(t){return 0===t.eventRegistrations_.length}function Sn(t,e,n){const i=[];if(n){(0,r.hu)(null==e,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach((t=>{const e=t.createCancelEvent(n,s);e&&i.push(e)}))}if(e){let n=[];for(let i=0;i<t.eventRegistrations_.length;++i){const s=t.eventRegistrations_[i];if(s.matches(e)){if(e.hasAnyCallback()){n=n.concat(t.eventRegistrations_.slice(i+1));break}}else n.push(s)}t.eventRegistrations_=n}else t.eventRegistrations_=[];return i}function xn(t,e,n,i){e.type===Ae.MERGE&&null!==e.source.queryId&&((0,r.hu)(Ve(t.viewCache_),"We should always have a full cache before handling merges"),(0,r.hu)(Ze(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,o=function(t,e,n,i,s){const o=new gn;let a,h;if(n.type===Ae.OVERWRITE){const c=n;c.source.fromUser?a=Cn(t,e,c.path,c.snap,i,s,o):((0,r.hu)(c.source.fromServer,"Unknown source."),h=c.source.tagged||e.serverCache.isFiltered()&&!yt(c.path),a=bn(t,e,c.path,c.snap,i,s,h,o))}else if(n.type===Ae.MERGE){const c=n;c.source.fromUser?a=function(t,e,n,i,s,r,o){let a=e;return i.foreach(((i,h)=>{const c=vt(n,i);Tn(e,dt(c))&&(a=Cn(t,a,c,h,s,r,o))})),i.foreach(((i,h)=>{const c=vt(n,i);Tn(e,dt(c))||(a=Cn(t,a,c,h,s,r,o))})),a}(t,e,c.path,c.children,i,s,o):((0,r.hu)(c.source.fromServer,"Unknown source."),h=c.source.tagged||e.serverCache.isFiltered(),a=En(t,e,c.path,c.children,i,s,h,o))}else if(n.type===Ae.ACK_USER_WRITE){const h=n;a=h.revert?function(t,e,n,i,s,o){let a;if(null!=pn(i,n))return e;{const h=new yn(i,e,s),c=e.eventCache.getNode();let l;if(yt(n)||".priority"===dt(n)){let n;if(e.serverCache.isFullyInitialized())n=ln(i,Ve(e));else{const t=e.serverCache.getNode();(0,r.hu)(t instanceof ee,"serverChildren would be complete if leaf node"),n=un(i,t)}l=t.filter.updateFullNode(c,n,o)}else{const s=dt(n);let r=fn(i,s,e.serverCache);null==r&&e.serverCache.isCompleteForChild(s)&&(r=c.getImmediateChild(s)),l=null!=r?t.filter.updateChild(c,s,r,ft(n),h,o):e.eventCache.getNode().hasChild(s)?t.filter.updateChild(c,s,ee.EMPTY_NODE,ft(n),h,o):c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=ln(i,Ve(e)),a.isLeafNode()&&(l=t.filter.updateFullNode(l,a,o)))}return a=e.serverCache.isFullyInitialized()||null!=pn(i,ut()),je(e,l,a,t.filter.filtersNodes())}}(t,e,h.path,i,s,o):function(t,e,n,i,s,r,o){if(null!=pn(s,n))return e;const a=e.serverCache.isFiltered(),h=e.serverCache;if(null!=i.value){if(yt(n)&&h.isFullyInitialized()||h.isCompleteForPath(n))return bn(t,e,n,h.getNode().getChild(n),s,r,a,o);if(yt(n)){let i=new He(null);return h.getNode().forEachChild(Nt,((t,e)=>{i=i.set(new lt(t),e)})),En(t,e,n,i,s,r,a,o)}return e}{let c=new He(null);return i.foreach(((t,e)=>{const i=vt(n,t);h.isCompleteForPath(i)&&(c=c.set(t,h.getNode().getChild(i)))})),En(t,e,n,c,s,r,a,o)}}(t,e,h.path,h.affectedTree,i,s,o)}else{if(n.type!==Ae.LISTEN_COMPLETE)throw(0,r.g5)("Unknown operation type: "+n.type);a=function(t,e,n,i,s){const r=e.serverCache;return wn(t,qe(e,r.getNode(),r.isFullyInitialized()||yt(n),r.isFiltered()),n,i,vn,s)}(t,e,n.path,i,o)}const c=o.getChanges();return function(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=Ze(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(le(Ze(e)))}}(e,a,c),{viewCache:a,changes:c}}(t.processor_,s,e,n,i);var a,h;return a=t.processor_,h=o.viewCache,(0,r.hu)(h.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),(0,r.hu)(h.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),(0,r.hu)(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,An(t,o.changes,o.viewCache.eventCache.getNode(),null)}function An(t,e,n,i){const s=i?[i]:t.eventRegistrations_;return function(t,e,n,i){const s=[],r=[];return e.forEach((e=>{var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&r.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),ze(t,s,"child_removed",e,i,n),ze(t,s,"child_added",e,i,n),ze(t,s,"child_moved",r,i,n),ze(t,s,"child_changed",e,i,n),ze(t,s,"value",e,i,n),s}(t.eventGenerator_,e,n,s)}let On,Rn;class Nn{constructor(){this.views=new Map}}function Mn(t,e,n,i){const s=e.source.queryId;if(null!==s){const o=t.views.get(s);return(0,r.hu)(null!=o,"SyncTree gave us an op for an invalid query."),xn(o,e,n,i)}{let s=[];for(const r of t.views.values())s=s.concat(xn(r,e,n,i));return s}}function Dn(t,e,n,i,s){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let t=ln(n,s?i:null),r=!1;t?r=!0:i instanceof ee?(t=un(n,i),r=!1):(t=ee.EMPTY_NODE,r=!1);const o=Ue(new Fe(t,r,!1),new Fe(i,s,!1));return new kn(e,o)}return o}function Fn(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Bn(t,e){let n=null;for(const i of t.views.values())n=n||Pn(i,e);return n}function zn(t,e){if(e._queryParams.loadsAllData())return qn(t);{const n=e._queryIdentifier;return t.views.get(n)}}function Un(t,e){return null!=zn(t,e)}function jn(t){return null!=qn(t)}function qn(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Zn=1;class Vn{constructor(t){this.listenProvider_=t,this.syncPointTree_=new He(null),this.pendingWriteTree_={visibleWrites:Ge.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Wn(t,e,n,i,s){return function(t,e,n,i,s){(0,r.hu)(i>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:s}),s&&(t.visibleWrites=Ke(t.visibleWrites,e,n)),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i,s),s?Jn(t,new Me({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Hn(t,e,n=!1){const i=function(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,e);if(function(t,e){const n=t.allWrites.findIndex((t=>t.writeId===e));(0,r.hu)(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let s=i.visible,o=!1,a=t.allWrites.length-1;for(;s&&a>=0;){const e=t.allWrites[a];e.visible&&(a>=n&&on(e,i.path)?s=!1:Tt(i.path,e.path)&&(o=!0)),a--}return!!s&&(o?(function(t){t.visibleWrites=hn(t.allWrites,an,ut()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(i.snap?t.visibleWrites=$e(t.visibleWrites,i.path):D(i.children,(e=>{t.visibleWrites=$e(t.visibleWrites,vt(i.path,e))})),!0))}(t.pendingWriteTree_,e)){let e=new He(null);return null!=i.snap?e=e.set(ut(),!0):D(i.children,(t=>{e=e.set(new lt(t),!0)})),Jn(t,new Re(i.path,e,n))}return[]}function Gn(t,e,n){return Jn(t,new Me({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Kn(t,e,n,i){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||Un(o,e))){const h=function(t,e,n,i){const s=e._queryIdentifier,o=[];let a=[];const h=jn(t);if("default"===s)for(const[e,s]of t.views.entries())a=a.concat(Sn(s,n,i)),Ln(s)&&(t.views.delete(e),s.query._queryParams.loadsAllData()||o.push(s.query));else{const e=t.views.get(s);e&&(a=a.concat(Sn(e,n,i)),Ln(e)&&(t.views.delete(s),e.query._queryParams.loadsAllData()||o.push(e.query)))}return h&&!jn(t)&&o.push(new((0,r.hu)(On,"Reference.ts has not been loaded"),On)(e._repo,e._path)),{removed:o,events:a}}(o,e,n,i);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=h.removed;a=h.events;const l=-1!==c.findIndex((t=>t._queryParams.loadsAllData())),u=t.syncPointTree_.findOnPath(s,((t,e)=>jn(e)));if(l&&!u){const e=t.syncPointTree_.subtree(s);if(!e.isEmpty()){const n=function(t){return t.fold(((t,e,n)=>{if(e&&jn(e))return[qn(e)];{let t=[];return e&&(t=Fn(e)),D(n,((e,n)=>{t=t.concat(n)})),t}}))}(e);for(let e=0;e<n.length;++e){const i=n[e],s=i.query,r=ti(t,i);t.listenProvider_.startListening(oi(s),ei(t,s),r.hashFn,r.onComplete)}}}if(!u&&c.length>0&&!i)if(l){const n=null;t.listenProvider_.stopListening(oi(e),n)}else c.forEach((e=>{const n=t.queryToTagMap.get(ni(e));t.listenProvider_.stopListening(oi(e),n)}));!function(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const e=ni(i),n=t.queryToTagMap.get(e);t.queryToTagMap.delete(e),t.tagToQueryMap.delete(n)}}}(t,c)}return a}function Yn(t,e,n){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,((t,e)=>{const n=wt(t,i);s=s||Bn(e,n),o=o||jn(e)}));let a,h=t.syncPointTree_.get(i);h?(o=o||jn(h),s=s||Bn(h,ut())):(h=new Nn,t.syncPointTree_=t.syncPointTree_.set(i,h)),null!=s?a=!0:(a=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild(((t,e)=>{const n=Bn(e,ut());n&&(s=s.updateImmediateChild(t,n))})));const c=Un(h,e);if(!c&&!e._queryParams.loadsAllData()){const n=ni(e);(0,r.hu)(!t.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=Zn++;t.queryToTagMap.set(n,i),t.tagToQueryMap.set(i,n)}let l=function(t,e,n,i,s,r){const o=Dn(t,e,i,s,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function(t,e){t.eventRegistrations_.push(e)}(o,n),function(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Gt,((t,e)=>{i.push(ue(t,e))})),n.isFullyInitialized()&&i.push(le(n.getNode())),An(t,i,n.getNode(),e)}(o,n)}(h,e,n,rn(t.pendingWriteTree_,i),s,a);if(!c&&!o){const n=zn(h,e);l=l.concat(function(t,e,n){const i=e._path,s=ei(t,e),o=ti(t,n),a=t.listenProvider_.startListening(oi(e),s,o.hashFn,o.onComplete),h=t.syncPointTree_.subtree(i);if(s)(0,r.hu)(!jn(h.value),"If we're adding a query, it shouldn't be shadowed");else{const e=h.fold(((t,e,n)=>{if(!yt(t)&&e&&jn(e))return[qn(e).query];{let t=[];return e&&(t=t.concat(Fn(e).map((t=>t.query)))),D(n,((e,n)=>{t=t.concat(n)})),t}}));for(let n=0;n<e.length;++n){const i=e[n];t.listenProvider_.stopListening(oi(i),ei(t,i))}}return a}(t,e,n))}return l}function $n(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,((t,n)=>{const i=Bn(n,wt(t,e));if(i)return i}));return cn(i,e,s,n,!0)}function Jn(t,e){return Qn(e,t.syncPointTree_,null,rn(t.pendingWriteTree_,ut()))}function Qn(t,e,n,i){if(yt(t.path))return Xn(t,e,n,i);{const s=e.get(ut());null==n&&null!=s&&(n=Bn(s,ut()));let r=[];const o=dt(t.path),a=t.operationForChild(o),h=e.children.get(o);if(h&&a){const t=n?n.getImmediateChild(o):null,e=_n(i,o);r=r.concat(Qn(a,h,t,e))}return s&&(r=r.concat(Mn(s,t,i,n))),r}}function Xn(t,e,n,i){const s=e.get(ut());null==n&&null!=s&&(n=Bn(s,ut()));let r=[];return e.children.inorderTraversal(((e,s)=>{const o=n?n.getImmediateChild(e):null,a=_n(i,e),h=t.operationForChild(e);h&&(r=r.concat(Xn(h,s,o,a)))})),s&&(r=r.concat(Mn(s,t,i,n))),r}function ti(t,e){const n=e.query,i=ei(t,n);return{hashFn:()=>{const t=function(t){return t.viewCache_.serverCache.getNode()}(e)||ee.EMPTY_NODE;return t.hash()},onComplete:e=>{if("ok"===e)return i?function(t,e,n){const i=ii(t,n);if(i){const n=si(i),s=n.path,r=n.queryId,o=wt(s,e);return ri(t,s,new Ne(Oe(r),o))}return[]}(t,n._path,i):function(t,e){return Jn(t,new Ne({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const i=function(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}(e,n);return Kn(t,n,null,i)}}}}function ei(t,e){const n=ni(e);return t.queryToTagMap.get(n)}function ni(t){return t._path.toString()+"$"+t._queryIdentifier}function ii(t,e){return t.tagToQueryMap.get(e)}function si(t){const e=t.indexOf("$");return(0,r.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new lt(t.substr(0,e))}}function ri(t,e,n){const i=t.syncPointTree_.get(e);return(0,r.hu)(i,"Missing sync point for query tag that we're tracking"),Mn(i,n,rn(t.pendingWriteTree_,e),null)}function oi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,r.hu)(Rn,"Reference.ts has not been loaded"),Rn)(t._repo,t._path):t}class ai{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new ai(e)}node(){return this.node_}}class hi{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=vt(this.path_,t);return new hi(this.syncTree_,e)}node(){return $n(this.syncTree_,this.path_)}}const ci=function(t,e,n){return t&&"object"==typeof t?((0,r.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?li(t[".sv"],e,n):"object"==typeof t[".sv"]?ui(t[".sv"],e):void(0,r.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},li=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,r.hu)(!1,"Unexpected server value: "+t)},ui=function(t,e,n){t.hasOwnProperty("increment")||(0,r.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;"number"!=typeof i&&(0,r.hu)(!1,"Unexpected increment value: "+i);const s=e.node();if((0,r.hu)(null!=s,"Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return"number"!=typeof o?i:o+i},di=function(t,e,n,i){return fi(e,new hi(n,t),i)},pi=function(t,e,n){return fi(t,new ai(e),n)};function fi(t,e,n){const i=t.getPriority().val(),s=ci(i,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const i=t,r=ci(i.getValue(),e,n);return r!==i.getValue()||s!==i.getPriority().val()?new Ht(r,ie(s)):t}{const i=t;return r=i,s!==i.getPriority().val()&&(r=r.updatePriority(new Ht(s))),i.forEachChild(Gt,((t,i)=>{const s=fi(i,e.getImmediateChild(t),n);s!==i&&(r=r.updateImmediateChild(t,s))})),r}}class _i{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function mi(t,e){let n=e instanceof lt?e:new lt(e),i=t,s=dt(n);for(;null!==s;){const t=(0,r.DV)(i.node.children,s)||{children:{},childCount:0};i=new _i(s,i,t),n=ft(n),s=dt(n)}return i}function gi(t){return t.node.value}function vi(t,e){t.node.value=e,Ti(t)}function yi(t){return t.node.childCount>0}function wi(t,e){D(t.node.children,((n,i)=>{e(new _i(n,t,i))}))}function bi(t,e,n,i){n&&!i&&e(t),wi(t,(t=>{bi(t,e,!0,i)})),n&&i&&e(t)}function Ci(t){return new lt(null===t.parent?t.name:Ci(t.parent)+"/"+t.name)}function Ti(t){null!==t.parent&&function(t,e,n){const i=function(t){return void 0===gi(t)&&!yi(t)}(n),s=(0,r.r3)(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,Ti(t)):i||s||(t.node.children[e]=n.node,t.node.childCount++,Ti(t))}(t.parent,t.name,t)}const Ii=/[\[\].#$\/\u0000-\u001F\u007F]/,Ei=/[\[\].#$\u0000-\u001F\u007F]/,ki=10485760,Pi=function(t){return"string"==typeof t&&0!==t.length&&!Ii.test(t)},Li=function(t){return"string"==typeof t&&0!==t.length&&!Ei.test(t)},Si=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!L(t)||t&&"object"==typeof t&&(0,r.r3)(t,".sv")},xi=function(t,e,n,i){i&&void 0===e||Ai((0,r.gK)(t,"value"),e,n)},Ai=function(t,e,n){const i=n instanceof lt?new It(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+kt(i));if("function"==typeof e)throw new Error(t+"contains a function "+kt(i)+" with contents = "+e.toString());if(L(e))throw new Error(t+"contains "+e.toString()+" "+kt(i));if("string"==typeof e&&e.length>ki/3&&(0,r.ug)(e)>ki)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+kt(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let n=!1,s=!1;if(D(e,((e,o)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!Pi(e)))throw new Error(t+" contains an invalid key ("+e+") "+kt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,r.ug)(e),Et(t)}(i,e),Ai(t,o,i),function(t){const e=t.parts_.pop();t.byteLength_-=(0,r.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)})),n&&s)throw new Error(t+' contains ".value" child '+kt(i)+" in addition to actual children.")}},Oi=function(t,e,n,i){if(i&&void 0===e)return;const s=(0,r.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];D(e,((t,e)=>{const i=new lt(t);if(Ai(s,e,vt(n,i)),".priority"===_t(i)&&!Si(e))throw new Error(s+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(i)})),function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];const s=mt(i);for(let e=0;e<s.length;e++)if(".priority"===s[e]&&e===s.length-1);else if(!Pi(s[e]))throw new Error(t+"contains an invalid key ("+s[e]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(bt);let s=null;for(n=0;n<e.length;n++){if(i=e[n],null!==s&&Tt(s,i))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}}(s,o)},Ri=function(t,e,n){if(!n||void 0!==e){if(L(e))throw new Error((0,r.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Si(e))throw new Error((0,r.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ni=function(t,e,n,i){if(!(i&&void 0===n||Pi(n)))throw new Error((0,r.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Mi=function(t,e,n,i){if(!(i&&void 0===n||Li(n)))throw new Error((0,r.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Di=function(t,e){if(".info"===dt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Fi=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Pi(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Li(t)}(n))throw new Error((0,r.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Bi{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function zi(t,e){let n=null;for(let i=0;i<e.length;i++){const s=e[i],r=s.getPath();null===n||Ct(r,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:r}),n.events.push(s)}n&&t.eventLists_.push(n)}function Ui(t,e,n){zi(t,n),qi(t,(t=>Ct(t,e)))}function ji(t,e,n){zi(t,n),qi(t,(t=>Tt(t,e)||Tt(e,t)))}function qi(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const s=t.eventLists_[i];s&&(e(s.path)?(Zi(t.eventLists_[i]),t.eventLists_[i]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Zi(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const i=n.getEventRunner();w&&T("event: "+n.toString()),U(i)}}}const Vi="repo_interrupt";class Wi{constructor(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Bi,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ee(),this.transactionQueueTree_=new _i,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Hi(t,e,n){if(t.stats_=X(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Te(t.repoInfo_,((e,n,i,s)=>{Yi(t,e,n,i,s)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((()=>$i(t,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,r.Pz)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new St(t.repoInfo_,e,((e,n,i,s)=>{Yi(t,e,n,i,s)}),(e=>{$i(t,e)}),(e=>{!function(t,e){D(e,((e,n)=>{Ji(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((e=>{t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((e=>{t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(e,n){const i=e.toString();return Q[i]||(Q[i]=new xe(t.stats_,t.server_)),Q[i]}(t.repoInfo_),t.infoData_=new Ie,t.infoSyncTree_=new Vn({startListening:(e,n,i,s)=>{let r=[];const o=t.infoData_.getNode(e._path);return o.isEmpty()||(r=Gn(t.infoSyncTree_,e._path,o),setTimeout((()=>{s("ok")}),0)),r},stopListening:()=>{}}),Ji(t,"connected",!1),t.serverSyncTree_=new Vn({startListening:(e,n,i,s)=>(t.server_.listen(e,i,n,((n,i)=>{const r=s(n,i);ji(t.eventQueue_,e._path,r)})),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}function Gi(t){const e=t.infoData_.getNode(new lt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function Ki(t){return(e=(e={timestamp:Gi(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function Yi(t,e,n,i,s){t.dataUpdateCount++;const o=new lt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(s)if(i){const e=(0,r.UI)(n,(t=>ie(t)));a=function(t,e,n,i){const s=ii(t,i);if(s){const i=si(s),r=i.path,o=i.queryId,a=wt(r,e),h=He.fromObject(n);return ri(t,r,new De(Oe(o),a,h))}return[]}(t.serverSyncTree_,o,e,s)}else{const e=ie(n);a=function(t,e,n,i){const s=ii(t,i);if(null!=s){const i=si(s),r=i.path,o=i.queryId,a=wt(r,e);return ri(t,r,new Me(Oe(o),a,n))}return[]}(t.serverSyncTree_,o,e,s)}else if(i){const e=(0,r.UI)(n,(t=>ie(t)));a=function(t,e,n){const i=He.fromObject(n);return Jn(t,new De({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,o,e)}else{const e=ie(n);a=Gn(t.serverSyncTree_,o,e)}let h=o;a.length>0&&(h=hs(t,o)),ji(t.eventQueue_,h,a)}function $i(t,e){Ji(t,"connected",e),!1===e&&function(t){ss(t,"onDisconnectEvents");const e=Ki(t),n=Ee();Le(t.onDisconnect_,ut(),((i,s)=>{const r=di(i,s,t.serverSyncTree_,e);ke(n,i,r)}));let i=[];Le(n,ut(),((e,n)=>{i=i.concat(Gn(t.serverSyncTree_,e,n));const s=ps(t,e);hs(t,s)})),t.onDisconnect_=Ee(),ji(t.eventQueue_,ut(),i)}(t)}function Ji(t,e,n){const i=new lt("/.info/"+e),s=ie(n);t.infoData_.updateSnapshot(i,s);const r=Gn(t.infoSyncTree_,i,s);ji(t.eventQueue_,i,r)}function Qi(t){return t.nextWriteId_++}function Xi(t,e,n,i,s){ss(t,"set",{path:e.toString(),value:n,priority:i});const r=Ki(t),o=ie(n,i),a=$n(t.serverSyncTree_,e),h=pi(o,a,r),c=Qi(t),l=Wn(t.serverSyncTree_,e,h,c,!0);zi(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),((n,i)=>{const r="ok"===n;r||P("set at "+e+" failed: "+n);const o=Hn(t.serverSyncTree_,c,!r);ji(t.eventQueue_,e,o),rs(0,s,n,i)}));const u=ps(t,e);hs(t,u),ji(t.eventQueue_,u,[])}function ts(t,e,n){t.server_.onDisconnectCancel(e.toString(),((i,s)=>{"ok"===i&&Pe(t.onDisconnect_,e),rs(0,n,i,s)}))}function es(t,e,n,i){const s=ie(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),((n,r)=>{"ok"===n&&ke(t.onDisconnect_,e,s),rs(0,i,n,r)}))}function ns(t,e,n){let i;i=".info"===dt(e._path)?Kn(t.infoSyncTree_,e,n):Kn(t.serverSyncTree_,e,n),Ui(t.eventQueue_,e._path,i)}function is(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Vi)}function ss(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),T(n,...e)}function rs(t,e,n,i){e&&U((()=>{if("ok"===n)e(null);else{const t=(n||"error").toUpperCase();let s=t;i&&(s+=": "+i);const r=new Error(s);r.code=t,e(r)}}))}function os(t,e,n){return $n(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function as(t,e=t.transactionQueueTree_){if(e||ds(t,e),gi(e)){const n=ls(t,e);(0,r.hu)(n.length>0,"Sending zero length transaction queue"),n.every((t=>0===t.status))&&function(t,e,n){const i=n.map((t=>t.currentWriteId)),s=os(t,e,i);let o=s;const a=s.hash();for(let t=0;t<n.length;t++){const i=n[t];(0,r.hu)(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const s=wt(e,i.path);o=o.updateChild(s,i.currentOutputSnapshotRaw)}const h=o.val(!0),c=e;t.server_.put(c.toString(),h,(i=>{ss(t,"transaction put response",{path:c.toString(),status:i});let s=[];if("ok"===i){const i=[];for(let e=0;e<n.length;e++)n[e].status=2,s=s.concat(Hn(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&i.push((()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved))),n[e].unwatcher();ds(t,mi(t.transactionQueueTree_,e)),as(t,t.transactionQueueTree_),ji(t.eventQueue_,e,s);for(let t=0;t<i.length;t++)U(i[t])}else{if("datastale"===i)for(let t=0;t<n.length;t++)3===n[t].status?n[t].status=4:n[t].status=0;else{P("transaction at "+c.toString()+" failed: "+i);for(let t=0;t<n.length;t++)n[t].status=4,n[t].abortReason=i}hs(t,e)}}),a)}(t,Ci(e),n)}else yi(e)&&wi(e,(e=>{as(t,e)}))}function hs(t,e){const n=cs(t,e),i=Ci(n);return function(t,e,n){if(0===e.length)return;const i=[];let s=[];const o=e.filter((t=>0===t.status)).map((t=>t.currentWriteId));for(let h=0;h<e.length;h++){const c=e[h],l=wt(n,c.path);let u,d=!1;if((0,r.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)d=!0,u=c.abortReason,s=s.concat(Hn(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)d=!0,u="maxretry",s=s.concat(Hn(t.serverSyncTree_,c.currentWriteId,!0));else{const n=os(t,c.path,o);c.currentInputSnapshot=n;const i=e[h].update(n.val());if(void 0!==i){Ai("transaction failed: Data returned ",i,c.path);let e=ie(i);"object"==typeof i&&null!=i&&(0,r.r3)(i,".priority")||(e=e.updatePriority(n.getPriority()));const a=c.currentWriteId,h=Ki(t),l=pi(e,n,h);c.currentOutputSnapshotRaw=e,c.currentOutputSnapshotResolved=l,c.currentWriteId=Qi(t),o.splice(o.indexOf(a),1),s=s.concat(Wn(t.serverSyncTree_,c.path,l,c.currentWriteId,c.applyLocally)),s=s.concat(Hn(t.serverSyncTree_,a,!0))}else d=!0,u="nodata",s=s.concat(Hn(t.serverSyncTree_,c.currentWriteId,!0))}ji(t.eventQueue_,n,s),s=[],d&&(e[h].status=2,a=e[h].unwatcher,setTimeout(a,Math.floor(0)),e[h].onComplete&&("nodata"===u?i.push((()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot))):i.push((()=>e[h].onComplete(new Error(u),!1,null)))))}var a;ds(t,t.transactionQueueTree_);for(let t=0;t<i.length;t++)U(i[t]);as(t,t.transactionQueueTree_)}(t,ls(t,n),i),i}function cs(t,e){let n,i=t.transactionQueueTree_;for(n=dt(e);null!==n&&void 0===gi(i);)i=mi(i,n),n=dt(e=ft(e));return i}function ls(t,e){const n=[];return us(t,e,n),n.sort(((t,e)=>t.order-e.order)),n}function us(t,e,n){const i=gi(e);if(i)for(let t=0;t<i.length;t++)n.push(i[t]);wi(e,(e=>{us(t,e,n)}))}function ds(t,e){const n=gi(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,vi(e,n.length>0?n:void 0)}wi(e,(e=>{ds(t,e)}))}function ps(t,e){const n=Ci(cs(t,e)),i=mi(t.transactionQueueTree_,e);return function(t,e,n){let i=t.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,(e=>{fs(t,e)})),fs(t,i),bi(i,(e=>{fs(t,e)})),n}function fs(t,e){const n=gi(e);if(n){const i=[];let s=[],o=-1;for(let e=0;e<n.length;e++)3===n[e].status||(1===n[e].status?((0,r.hu)(o===e-1,"All SENT items should be at beginning of queue."),o=e,n[e].status=3,n[e].abortReason="set"):((0,r.hu)(0===n[e].status,"Unexpected transaction status in abort"),n[e].unwatcher(),s=s.concat(Hn(t.serverSyncTree_,n[e].currentWriteId,!0)),n[e].onComplete&&i.push(n[e].onComplete.bind(null,new Error("set"),!1,null))));-1===o?vi(e,void 0):n.length=o+1,ji(t.eventQueue_,Ci(e),s);for(let t=0;t<i.length;t++)U(i[t])}}const _s=function(t,e){const n=ms(t),i=n.namespace;"firebase.com"===n.domain&&k(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||k("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&P("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new K(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new lt(n.pathString)}},ms=function(t){let e="",n="",i="",s="",r="",o=!0,a="https",h=443;if("string"==typeof t){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");-1===l&&(l=t.length);let u=t.indexOf("?");-1===u&&(u=t.length),e=t.substring(0,Math.min(l,u)),l<u&&(s=function(t){let e="";const n=t.split("/");for(let t=0;t<n.length;t++)if(n[t].length>0){let i=n[t];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(l,u)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):P(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o="https"===a||"wss"===a,h=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const t=e.indexOf(".");i=e.substring(0,t).toLowerCase(),n=e.substring(t+1),r=i}"ns"in d&&(r=d.ns)}return{host:e,port:h,domain:n,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class gs{constructor(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,r.Pz)(this.snapshot.exportVal())}}class vs{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ys{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return(0,r.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class ws{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new r.BH;return ts(this._repo,this._path,t.wrapCallback((()=>{}))),t.promise}remove(){Di("OnDisconnect.remove",this._path);const t=new r.BH;return es(this._repo,this._path,null,t.wrapCallback((()=>{}))),t.promise}set(t){Di("OnDisconnect.set",this._path),xi("OnDisconnect.set",t,this._path,!1);const e=new r.BH;return es(this._repo,this._path,t,e.wrapCallback((()=>{}))),e.promise}setWithPriority(t,e){Di("OnDisconnect.setWithPriority",this._path),xi("OnDisconnect.setWithPriority",t,this._path,!1),Ri("OnDisconnect.setWithPriority",e,!1);const n=new r.BH;return function(t,e,n,i,s){const r=ie(n,i);t.server_.onDisconnectPut(e.toString(),r.val(!0),((n,i)=>{"ok"===n&&ke(t.onDisconnect_,e,r),rs(0,s,n,i)}))}(this._repo,this._path,t,e,n.wrapCallback((()=>{}))),n.promise}update(t){Di("OnDisconnect.update",this._path),Oi("OnDisconnect.update",t,this._path,!1);const e=new r.BH;return function(t,e,n,i){if((0,r.xb)(n))return T("onDisconnect().update() called with empty data.  Don't do anything."),void rs(0,i,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,((s,r)=>{"ok"===s&&D(n,((n,i)=>{const s=ie(i);ke(t.onDisconnect_,vt(e,n),s)})),rs(0,i,s,r)}))}(this._repo,this._path,t,e.wrapCallback((()=>{}))),e.promise}}class bs{constructor(t,e,n,i){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=i}get key(){return yt(this._path)?null:_t(this._path)}get ref(){return new Es(this._repo,this._path)}get _queryIdentifier(){const t=Ce(this._queryParams),e=N(t);return"{}"===e?"default":e}get _queryObject(){return Ce(this._queryParams)}isEqual(t){if(!((t=(0,r.m9)(t))instanceof bs))return!1;const e=this._repo===t._repo,n=Ct(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return e&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function Cs(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ts(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Nt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==S)throw new Error(i);if("string"!=typeof e)throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==x)throw new Error(i);if("string"!=typeof n)throw new Error(s)}}else if(t.getIndex()===Gt){if(null!=e&&!Si(e)||null!=n&&!Si(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,r.hu)(t.getIndex()instanceof se||t.getIndex()===re,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Is(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Es extends bs{constructor(t,e){super(t,e,new ge,!1)}get parent(){const t=gt(this._path);return null===t?null:new Es(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class ks{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new lt(t),n=Ss(this.ref,t);return new ks(this._node.getChild(e),n,Gt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((e,n)=>t(new ks(n,Ss(this.ref,e),Gt))))}hasChild(t){const e=new lt(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ps(t,e){return(t=(0,r.m9)(t))._checkNotDeleted("ref"),void 0!==e?Ss(t._root,e):t._root}function Ls(t,e){(t=(0,r.m9)(t))._checkNotDeleted("refFromURL");const n=_s(e,t._repo.repoInfo_.nodeAdmin);Fi("refFromURL",n);const i=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||i.host===t._repo.repoInfo_.host||k("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),Ps(t,n.path.toString())}function Ss(t,e){var n;return null===dt((t=(0,r.m9)(t))._path)?("child","path",!1,(n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mi("child","path",n,false)):Mi("child","path",e,!1),new Es(t._repo,vt(t._path,e))}function xs(t){return t=(0,r.m9)(t),new ws(t._repo,t._path)}function As(t,e){t=(0,r.m9)(t),Di("push",t._path),xi("push",e,t._path,!0);const n=Gi(t._repo),i=ae(n),s=Ss(t,i),o=Ss(t,i);let a;return a=null!=e?Rs(o,e).then((()=>o)):Promise.resolve(o),s.then=a.then.bind(a),s.catch=a.then.bind(a,void 0),s}function Os(t){return Di("remove",t._path),Rs(t,null)}function Rs(t,e){t=(0,r.m9)(t),Di("set",t._path),xi("set",e,t._path,!1);const n=new r.BH;return Xi(t._repo,t._path,e,null,n.wrapCallback((()=>{}))),n.promise}function Ns(t,e){t=(0,r.m9)(t),Di("setPriority",t._path),Ri("setPriority",e,!1);const n=new r.BH;return Xi(t._repo,vt(t._path,".priority"),e,null,n.wrapCallback((()=>{}))),n.promise}function Ms(t,e,n){if(Di("setWithPriority",t._path),xi("setWithPriority",e,t._path,!1),Ri("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const i=new r.BH;return Xi(t._repo,t._path,e,n,i.wrapCallback((()=>{}))),i.promise}function Ds(t,e){Oi("update",e,t._path,!1);const n=new r.BH;return function(t,e,n,i){ss(t,"update",{path:e.toString(),value:n});let s=!0;const o=Ki(t),a={};if(D(n,((n,i)=>{s=!1,a[n]=di(vt(e,n),ie(i),t.serverSyncTree_,o)})),s)T("update() called with empty data.  Don't do anything."),rs(0,i,"ok",void 0);else{const s=Qi(t),o=function(t,e,n,i){!function(t,e,n,i){(0,r.hu)(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Ye(t.visibleWrites,e,n),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i);const s=He.fromObject(n);return Jn(t,new De({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,s))}(t.serverSyncTree_,e,a,s);zi(t.eventQueue_,o),t.server_.merge(e.toString(),n,((n,r)=>{const o="ok"===n;o||P("update at "+e+" failed: "+n);const a=Hn(t.serverSyncTree_,s,!o),h=a.length>0?hs(t,e):e;ji(t.eventQueue_,h,a),rs(0,i,n,r)})),D(n,(n=>{const i=ps(t,vt(e,n));hs(t,i)})),ji(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((()=>{}))),n.promise}function Fs(t){return function(t,e){const n=function(t,e){const n=e._path;let i=null;t.syncPointTree_.foreachOnPath(n,((t,e)=>{const s=wt(t,n);i=i||Bn(e,s)}));let s=t.syncPointTree_.get(n);s?i=i||Bn(s,ut()):(s=new Nn,t.syncPointTree_=t.syncPointTree_.set(n,s));const r=null!=i,o=r?new Fe(i,!0,!1):null;return Ze(Dn(s,e,rn(t.pendingWriteTree_,e._path),r?o.getNode():ee.EMPTY_NODE,r).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((n=>{const i=ie(n).withIndex(e._queryParams.getIndex()),s=Gn(t.serverSyncTree_,e._path,i);return Ui(t.eventQueue_,e._path,s),Promise.resolve(i)}),(n=>(ss(t,"get for query "+(0,r.Pz)(e)+" failed: "+n),Promise.reject(new Error(n)))))}((t=(0,r.m9)(t))._repo,t).then((e=>new ks(e,new Es(t._repo,t._path),t._queryParams.getIndex())))}class Bs{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const n=e._queryParams.getIndex();return new gs("value",this,new ks(t.snapshotNode,new Es(e._repo,e._path),n))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new vs(this,t,e):null}matches(t){return t instanceof Bs&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class zs{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new vs(this,t,e):null}createEvent(t,e){(0,r.hu)(null!=t.childName,"Child events should have a childName.");const n=Ss(new Es(e._repo,e._path),t.childName),i=e._queryParams.getIndex();return new gs(t.type,this,new ks(t.snapshotNode,n,i),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof zs&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Us(t,e,n,i,s){let r;if("object"==typeof i&&(r=void 0,s=i),"function"==typeof i&&(r=i),s&&s.onlyOnce){const e=n,i=(n,i)=>{ns(t._repo,t,a),e(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new ys(n,r||void 0),a="value"===e?new Bs(o):new zs(e,o);return function(t,e,n){let i;i=".info"===dt(e._path)?Yn(t.infoSyncTree_,e,n):Yn(t.serverSyncTree_,e,n),Ui(t.eventQueue_,e._path,i)}(t._repo,t,a),()=>ns(t._repo,t,a)}function js(t,e,n,i){return Us(t,"value",e,n,i)}function qs(t,e,n,i){return Us(t,"child_added",e,n,i)}function Zs(t,e,n,i){return Us(t,"child_changed",e,n,i)}function Vs(t,e,n,i){return Us(t,"child_moved",e,n,i)}function Ws(t,e,n,i){return Us(t,"child_removed",e,n,i)}function Hs(t,e,n){let i=null;const s=n?new ys(n):null;"value"===e?i=new Bs(s):e&&(i=new zs(e,s)),ns(t._repo,t,i)}class Gs{}class Ks extends Gs{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){xi("endAt",this._value,t._path,!0);const e=ye(t._queryParams,this._value,this._key);if(Is(e),Ts(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bs(t._repo,t._path,e,t._orderByCalled)}}function Ys(t,e){return Ni("endAt","key",e,!0),new Ks(t,e)}class $s extends Gs{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){xi("endBefore",this._value,t._path,!1);const e=function(t,e,n){let i,s;return t.index_===Nt?("string"==typeof e&&(e=ce(e)),s=ye(t,e,n)):(i=null==n?S:ce(n),s=ye(t,e,i)),s.endBeforeSet_=!0,s}(t._queryParams,this._value,this._key);if(Is(e),Ts(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bs(t._repo,t._path,e,t._orderByCalled)}}function Js(t,e){return Ni("endBefore","key",e,!0),new $s(t,e)}class Qs extends Gs{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){xi("startAt",this._value,t._path,!0);const e=ve(t._queryParams,this._value,this._key);if(Is(e),Ts(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new bs(t._repo,t._path,e,t._orderByCalled)}}function Xs(t=null,e){return Ni("startAt","key",e,!0),new Qs(t,e)}class tr extends Gs{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){xi("startAfter",this._value,t._path,!1);const e=function(t,e,n){let i;if(t.index_===Nt)"string"==typeof e&&(e=he(e)),i=ve(t,e,n);else{let s;s=null==n?x:he(n),i=ve(t,e,s)}return i.startAfterSet_=!0,i}(t._queryParams,this._value,this._key);if(Is(e),Ts(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new bs(t._repo,t._path,e,t._orderByCalled)}}function er(t,e){return Ni("startAfter","key",e,!0),new tr(t,e)}class nr extends Gs{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new bs(t._repo,t._path,function(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(t._queryParams,this._limit),t._orderByCalled)}}function ir(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new nr(t)}class sr extends Gs{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bs(t._repo,t._path,function(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(t._queryParams,this._limit),t._orderByCalled)}}function rr(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new sr(t)}class or extends Gs{constructor(t){super(),this._path=t}_apply(t){Cs(t,"orderByChild");const e=new lt(this._path);if(yt(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new se(e),i=we(t._queryParams,n);return Ts(i),new bs(t._repo,t._path,i,!0)}}function ar(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Mi("orderByChild","path",t,!1),new or(t)}class hr extends Gs{_apply(t){Cs(t,"orderByKey");const e=we(t._queryParams,Nt);return Ts(e),new bs(t._repo,t._path,e,!0)}}function cr(){return new hr}class lr extends Gs{_apply(t){Cs(t,"orderByPriority");const e=we(t._queryParams,Gt);return Ts(e),new bs(t._repo,t._path,e,!0)}}function ur(){return new lr}class dr extends Gs{_apply(t){Cs(t,"orderByValue");const e=we(t._queryParams,re);return Ts(e),new bs(t._repo,t._path,e,!0)}}function pr(){return new dr}class fr extends Gs{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){if(xi("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ks(this._value,this._key)._apply(new Qs(this._value,this._key)._apply(t))}}function _r(t,e){return Ni("equalTo","key",e,!0),new fr(t,e)}function mr(t,...e){let n=(0,r.m9)(t);for(const t of e)n=t._apply(n);return n}!function(t){(0,r.hu)(!On,"__referenceConstructor has already been defined"),On=t}(Es),function(t){(0,r.hu)(!Rn,"__referenceConstructor has already been defined"),Rn=t}(Es);const gr={};let vr=!1;function yr(t,e,n,i,s){let r=i||t.options.databaseURL;void 0===r&&(t.options.projectId||k("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o,a,h=_s(r,s),c=h.repoInfo;a={NODE_ENV:"production"}.FIREBASE_DATABASE_EMULATOR_HOST,a?(o=!0,r=`http://${a}?ns=${c.namespace}`,h=_s(r,s),c=h.repoInfo):o=!h.repoInfo.secure;const l=s&&o?new V(V.OWNER):new Z(t.name,t.options,e);Fi("Invalid Firebase Database URL",h),yt(h.path)||k("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(t,e,n,i){let s=gr[e.name];s||(s={},gr[e.name]=s);let r=s[t.toURLString()];return r&&k("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Wi(t,vr,n,i),s[t.toURLString()]=r,r}(c,t,l,new q(t.name,n));return new wr(u,t)}class wr{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Hi(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Es(this._repo,ut())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(t,e){const n=gr[e];n&&n[t.key]===t||k(`Database ${e}(${t.repoInfo_}) has already been deleted.`),is(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&k("Cannot call "+t+" on a deleted database.")}}function br(){rt.IS_TRANSPORT_INITIALIZED&&P("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Cr(){br(),et.forceDisallow()}function Tr(){br(),st.forceDisallow(),et.forceAllow()}function Ir(t=(0,i.Mq)(),e){return(0,i.qX)(t,"database").getImmediate({identifier:e})}function Er(t,e,n,i={}){(t=(0,r.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&k("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&k('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new V(V.OWNER);else if(i.mockUserToken){const e="string"==typeof i.mockUserToken?i.mockUserToken:(0,r.Sg)(i.mockUserToken,t.app.options.projectId);o=new V(e)}!function(t,e,n,i){t.repoInfo_=new K(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),i&&(t.authTokenProvider_=i)}(s,e,n,o)}function kr(t){(t=(0,r.m9)(t))._checkNotDeleted("goOffline"),is(t._repo)}function Pr(t){var e;(t=(0,r.m9)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(Vi)}function Lr(t,e){C(t,e)}const Sr={".sv":"timestamp"};function xr(){return Sr}function Ar(t){return{".sv":{increment:t}}}class Or{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Rr(t,e,n){var i;if(t=(0,r.m9)(t),Di("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const s=null===(i=null==n?void 0:n.applyLocally)||void 0===i||i,o=new r.BH,a=js(t,(()=>{}));return function(e,n,i,s,a,h){ss(e,"transaction on "+n);const c={path:n,update:i,onComplete:(e,n,i)=>{let s=null;e?o.reject(e):(s=new ks(i,new Es(t._repo,t._path),Gt),o.resolve(new Or(n,s)))},status:null,order:g(),applyLocally:h,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=os(e,n,void 0);c.currentInputSnapshot=l;const u=c.update(l.val());if(void 0===u)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Ai("transaction failed: Data returned ",u,c.path),c.status=0;const t=mi(e.transactionQueueTree_,n),i=gi(t)||[];let s;i.push(c),vi(t,i),"object"==typeof u&&null!==u&&(0,r.r3)(u,".priority")?(s=(0,r.DV)(u,".priority"),(0,r.hu)(Si(s),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):s=($n(e.serverSyncTree_,n)||ee.EMPTY_NODE).getPriority().val();const o=Ki(e),a=ie(u,s),h=pi(a,l,o);c.currentOutputSnapshotRaw=a,c.currentOutputSnapshotResolved=h,c.currentWriteId=Qi(e);const d=Wn(e.serverSyncTree_,n,h,c.currentWriteId,c.applyLocally);ji(e.eventQueue_,n,d),as(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,a,s),o.promise}St.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},St.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};const Nr=function(t){const e=St.prototype.put;return St.prototype.put=function(n,i,s,r){void 0!==r&&(r=t()),e.call(this,n,i,s,r)},function(){St.prototype.put=e}},Mr=function(t){!function(t){vr=t}(t)};l(i.Jn),(0,i.Xd)(new s.wA("database",((t,{instanceIdentifier:e})=>yr(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e)),"PUBLIC").setMultipleInstances(!0)),(0,i.KN)(a,h,undefined),(0,i.KN)(a,h,"esm2017")},1535:function(t,e){!function(t){"use strict";var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,n=this._zoom;if(t.__parent)for(;e.__parent._zoom>=n;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var n,i=this._featureGroup,s=this._nonPointGroup,r=this.options.chunkedLoading,o=this.options.chunkInterval,a=this.options.chunkProgress,h=t.length,c=0,l=!0;if(this._map){var u=(new Date).getTime(),d=L.bind((function(){var p=(new Date).getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();c<h&&!(r&&c%200==0&&(new Date).getTime()-p>o);c++)if((n=t[c])instanceof L.LayerGroup)l&&(t=t.slice(),l=!1),this._extractNonGroupLayers(n,t),h=t.length;else if(n.getLatLng){if(!this.hasLayer(n)&&(this._addLayer(n,this._maxZoom),e||this.fire("layeradd",{layer:n}),n.__parent&&2===n.__parent.getChildCount())){var f=n.__parent.getAllChildMarkers(),_=f[0]===n?f[1]:f[0];i.removeLayer(_)}}else s.addLayer(n),e||this.fire("layeradd",{layer:n});a&&a(c,h,(new Date).getTime()-u),c===h?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(d,this.options.chunkDelay)}),this);d()}else for(var p=this._needsClustering;c<h;c++)(n=t[c])instanceof L.LayerGroup?(l&&(t=t.slice(),l=!1),this._extractNonGroupLayers(n,t),h=t.length):n.getLatLng?this.hasLayer(n)||p.push(n):s.addLayer(n);return this},removeLayers:function(t){var e,n,i=t.length,s=this._featureGroup,r=this._nonPointGroup,o=!0;if(!this._map){for(e=0;e<i;e++)(n=t[e])instanceof L.LayerGroup?(o&&(t=t.slice(),o=!1),this._extractNonGroupLayers(n,t),i=t.length):(this._arraySplice(this._needsClustering,n),r.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push({layer:n,latlng:n._latlng}),this.fire("layerremove",{layer:n}));return this}if(this._unspiderfy){this._unspiderfy();var a=t.slice(),h=i;for(e=0;e<h;e++)(n=a[e])instanceof L.LayerGroup?(this._extractNonGroupLayers(n,a),h=a.length):this._unspiderfyLayer(n)}for(e=0;e<i;e++)(n=t[e])instanceof L.LayerGroup?(o&&(t=t.slice(),o=!1),this._extractNonGroupLayers(n,t),i=t.length):n.__parent?(this._removeLayer(n,!0,!0),this.fire("layerremove",{layer:n}),s.hasLayer(n)&&(s.removeLayer(n),n.clusterShow&&n.clusterShow())):(r.removeLayer(n),this.fire("layerremove",{layer:n}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer((function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent}),this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var n,i,s,r=this._needsClustering.slice(),o=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(r),i=r.length-1;i>=0;i--){for(n=!0,s=o.length-1;s>=0;s--)if(o[s].layer===r[i]){n=!1;break}n&&t.call(e,r[i])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer((function(e){t.push(e)})),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer((function(n){L.stamp(n)===t&&(e=n)})),e},hasLayer:function(t){if(!t)return!1;var e,n=this._needsClustering;for(e=n.length-1;e>=0;e--)if(n[e]===t)return!0;for(e=(n=this._needsRemoving).length-1;e>=0;e--)if(n[e].layer===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var n=this._map;"function"!=typeof e&&(e=function(){});var i=function(){!n.hasLayer(t)&&!n.hasLayer(t.__parent)||this._inZoomAnimation||(this._map.off("moveend",i,this),this.off("animationend",i,this),n.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",i,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),t.__parent.zoomToBounds())},onAdd:function(t){var e,n,i;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,n=this._needsRemoving.length;e<n;e++)(i=this._needsRemoving[e]).newlatlng=i.layer._latlng,i.layer._latlng=i.latlng;for(e=0,n=this._needsRemoving.length;e<n;e++)i=this._needsRemoving[e],this._removeLayer(i.layer,!0),i.layer._latlng=i.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return t.splice(n,1),!0},_removeFromGridUnclustered:function(t,e){for(var n=this._map,i=this._gridUnclustered,s=Math.floor(this._map.getMinZoom());e>=s&&i[e].removeObject(t,n.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,n){t._latlng=e,this.removeLayer(t),t._latlng=n,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,n){var i=this._gridClusters,s=this._gridUnclustered,r=this._featureGroup,o=this._map,a=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var h,c=t.__parent,l=c._markers;for(this._arraySplice(l,t);c&&(c._childCount--,c._boundsNeedUpdate=!0,!(c._zoom<a));)e&&c._childCount<=1?(h=c._markers[0]===t?c._markers[1]:c._markers[0],i[c._zoom].removeObject(c,o.project(c._cLatLng,c._zoom)),s[c._zoom].addObject(h,o.project(h.getLatLng(),c._zoom)),this._arraySplice(c.__parent._childClusters,c),c.__parent._markers.push(h),h.__parent=c.__parent,c._icon&&(r.removeLayer(c),n||r.addLayer(h))):c._iconNeedsUpdate=!0,c=c.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,n){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,n)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),n=" marker-cluster-";return n+=e<10?"small":e<100?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+n,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,n=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,s=this.options.spiderfyOnEveryZoom;(e||i||s)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,n=e;if("clusterkeypress"!==t.type||!t.originalEvent||13===t.originalEvent.keyCode){for(;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&13===t.originalEvent.keyCode&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,i=this.options.spiderfyOnEveryZoom,s=this._map;(t||n||i)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),s.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),n=this.options.maxClusterRadius,i=n;"function"!=typeof n&&(i=function(){return n}),null!==this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var s=t;s>=e;s--)this._gridClusters[s]=new L.DistanceGrid(i(s)),this._gridUnclustered[s]=new L.DistanceGrid(i(s));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var n,i,s=this._gridClusters,r=this._gridUnclustered,o=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=o;e--){n=this._map.project(t.getLatLng(),e);var a=s[e].getNearObject(n);if(a)return a._addChild(t),void(t.__parent=a);if(a=r[e].getNearObject(n)){var h=a.__parent;h&&this._removeLayer(a,!1);var c=new this._markerCluster(this,e,a,t);s[e].addObject(c,this._map.project(c._cLatLng,e)),a.__parent=c,t.__parent=c;var l=c;for(i=e-1;i>h._zoom;i--)l=new this._markerCluster(this,i,l),s[i].addObject(l,this._map.project(a.getLatLng(),i));return h._addChild(l),void this._removeFromGridUnclustered(a,e)}r[e].addObject(t,n)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer((function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}))},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(t){var e=this._maxLat;return void 0!==e&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var n=e.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var n,i=t.getLayers(),s=0;for(e=e||[];s<i.length;s++)(n=i[s])instanceof L.LayerGroup?this._extractNonGroupLayers(n,e):e.push(n);return e},_overrideMarkerIcon:function(t){return t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var n,i=this._getExpandedVisibleBounds(),s=this._featureGroup,r=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(i,t,r,(function(r){var o,a=r._latlng,h=r._markers;for(i.contains(a)||(a=null),r._isSingleParent()&&t+1===e?(s.removeLayer(r),r._recursivelyAddChildrenToMap(null,e,i)):(r.clusterHide(),r._recursivelyAddChildrenToMap(a,e,i)),n=h.length-1;n>=0;n--)o=h[n],i.contains(o._latlng)||s.removeLayer(o)})),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,e),s.eachLayer((function(t){t instanceof L.MarkerCluster||!t._icon||t.clusterShow()})),this._topClusterLevel._recursively(i,t,e,(function(t){t._recursivelyRestoreChildPositions(e)})),this._ignoreMove=!1,this._enqueue((function(){this._topClusterLevel._recursively(i,t,r,(function(t){s.removeLayer(t),t.clusterShow()})),this._animationEnd()}))},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var n=this,i=this._featureGroup;i.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue((function(){i.removeLayer(t),t.clusterShow(),n._animationEnd()}))):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,n){var i=this._getExpandedVisibleBounds(),s=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(i,s,e+1,n);var r=this;this._forceLayout(),t._recursivelyBecomeVisible(i,n),this._enqueue((function(){if(1===t._childCount){var o=t._markers[0];this._ignoreMove=!0,o.setLatLng(o.getLatLng()),this._ignoreMove=!1,o.clusterShow&&o.clusterShow()}else t._recursively(i,n,s,(function(t){t._recursivelyRemoveChildrenFromMap(i,s,e+1)}));r._animationEnd()}))},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var n=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,n,i){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),i&&this._addChild(i)},getAllChildMarkers:function(t,e){t=t||[];for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n].getAllChildMarkers(t,e);for(var i=this._markers.length-1;i>=0;i--)e&&this._markers[i].__dragStart||t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e,n=this._childClusters.slice(),i=this._group._map,s=i.getBoundsZoom(this._bounds),r=this._zoom+1,o=i.getZoom();n.length>0&&s>r;){r++;var a=[];for(e=0;e<n.length;e++)a=a.concat(n[e]._childClusters);n=a}s>r?this._group._map.setView(this._latlng,r):s<=o?this._group._map.setView(this._latlng,o+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t,e,n,i,s=this._markers,r=this._childClusters,o=0,a=0,h=this._childCount;if(0!==h){for(this._resetBounds(),t=0;t<s.length;t++)n=s[t]._latlng,this._bounds.extend(n),o+=n.lat,a+=n.lng;for(t=0;t<r.length;t++)(e=r[t])._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),n=e._wLatLng,i=e._childCount,o+=n.lat*i,a+=n.lng*i;this._latlng=this._wLatLng=new L.LatLng(o/h,a/h),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,n){this._recursively(t,this._group._map.getMinZoom(),n-1,(function(t){var n,i,s=t._markers;for(n=s.length-1;n>=0;n--)(i=s[n])._icon&&(i._setPos(e),i.clusterHide())}),(function(t){var n,i,s=t._childClusters;for(n=s.length-1;n>=0;n--)(i=s[n])._icon&&(i._setPos(e),i.clusterHide())}))},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,n,i){this._recursively(t,i,e,(function(s){s._recursivelyAnimateChildrenIn(t,s._group._map.latLngToLayerPoint(s.getLatLng()).round(),n),s._isSingleParent()&&n-1===i?(s.clusterShow(),s._recursivelyRemoveChildrenFromMap(t,e,n)):s.clusterHide(),s._addToMap()}))},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,(function(t){t.clusterShow()}))},_recursivelyAddChildrenToMap:function(t,e,n){this._recursively(n,this._group._map.getMinZoom()-1,e,(function(i){if(e!==i._zoom)for(var s=i._markers.length-1;s>=0;s--){var r=i._markers[s];n.contains(r._latlng)&&(t&&(r._backupLatlng=r.getLatLng(),r.setLatLng(t),r.clusterHide&&r.clusterHide()),i._group._featureGroup.addLayer(r))}}),(function(e){e._addToMap(t)}))},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var n=this._markers[e];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(t-1===this._zoom)for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._restorePosition();else for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,n,i){var s,r;this._recursively(t,e-1,n-1,(function(t){for(r=t._markers.length-1;r>=0;r--)s=t._markers[r],i&&i.contains(s._latlng)||(t._group._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow())}),(function(t){for(r=t._childClusters.length-1;r>=0;r--)s=t._childClusters[r],i&&i.contains(s._latlng)||(t._group._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow())}))},_recursively:function(t,e,n,i,s){var r,o,a=this._childClusters,h=this._zoom;if(e<=h&&(i&&i(this),s&&h===n&&s(this)),h<e||h<n)for(r=a.length-1;r>=0;r--)(o=a[r])._boundsNeedUpdate&&o._recalculateBounds(),t.intersects(o._bounds)&&o._recursively(t,e,n,i,s)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var n=this._getCoord(e.x),i=this._getCoord(e.y),s=this._grid,r=s[i]=s[i]||{},o=r[n]=r[n]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,o.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var n,i,s=this._getCoord(e.x),r=this._getCoord(e.y),o=this._grid,a=o[r]=o[r]||{},h=a[s]=a[s]||[];for(delete this._objectPoint[L.Util.stamp(t)],n=0,i=h.length;n<i;n++)if(h[n]===t)return h.splice(n,1),1===i&&delete a[s],!0},eachObject:function(t,e){var n,i,s,r,o,a,h=this._grid;for(n in h)for(i in o=h[n])for(s=0,r=(a=o[i]).length;s<r;s++)t.call(e,a[s])&&(s--,r--)},getNearObject:function(t){var e,n,i,s,r,o,a,h,c=this._getCoord(t.x),l=this._getCoord(t.y),u=this._objectPoint,d=this._sqCellSize,p=null;for(e=l-1;e<=l+1;e++)if(s=this._grid[e])for(n=c-1;n<=c+1;n++)if(r=s[n])for(i=0,o=r.length;i<o;i++)a=r[i],((h=this._sqDist(u[L.Util.stamp(a)],t))<d||h<=d&&null===p)&&(d=h,p=a);return p},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}},L.QuickHull={getDistant:function(t,e){var n=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+n*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var n,i,s,r=0,o=null,a=[];for(n=e.length-1;n>=0;n--)i=e[n],(s=this.getDistant(i,t))>0&&(a.push(i),s>r&&(r=s,o=i));return{maxPoint:o,newPoints:a}},buildConvexHull:function(t,e){var n=[],i=this.findMostDistantPointFromBaseLine(t,e);return i.maxPoint?n=(n=n.concat(this.buildConvexHull([t[0],i.maxPoint],i.newPoints))).concat(this.buildConvexHull([i.maxPoint,t[1]],i.newPoints)):[t[0]]},getConvexHull:function(t){var e,n=!1,i=!1,s=!1,r=!1,o=null,a=null,h=null,c=null,l=null,u=null;for(e=t.length-1;e>=0;e--){var d=t[e];(!1===n||d.lat>n)&&(o=d,n=d.lat),(!1===i||d.lat<i)&&(a=d,i=d.lat),(!1===s||d.lng>s)&&(h=d,s=d.lng),(!1===r||d.lng<r)&&(c=d,r=d.lng)}return i!==n?(u=a,l=o):(u=c,l=h),[].concat(this.buildConvexHull([u,l],t),this.buildConvexHull([l,u],t))}},L.MarkerCluster.include({getConvexHull:function(){var t,e,n=this.getAllChildMarkers(),i=[];for(e=n.length-1;e>=0;e--)t=n[e].getLatLng(),i.push(t);return L.QuickHull.getConvexHull(i)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(null,!0),n=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?t=this._group.options.spiderfyShapePositions(e.length,n):e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,n):(n.y+=10,t=this._generatePointsCircle(e.length,n)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var n,i,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,r=this._2PI/t,o=[];for(s=Math.max(s,35),o.length=t,n=0;n<t;n++)i=this._circleStartAngle+n*r,o[n]=new L.Point(e.x+s*Math.cos(i),e.y+s*Math.sin(i))._round();return o},_generatePointsSpiral:function(t,e){var n,i=this._group.options.spiderfyDistanceMultiplier,s=i*this._spiralLengthStart,r=i*this._spiralFootSeparation,o=i*this._spiralLengthFactor*this._2PI,a=0,h=[];for(h.length=t,n=t;n>=0;n--)n<t&&(h[n]=new L.Point(e.x+s*Math.cos(a),e.y+s*Math.sin(a))._round()),s+=o/(a+=r/s+5e-4*n);return h},_noanimationUnspiderfy:function(){var t,e,n=this._group,i=n._map,s=n._featureGroup,r=this.getAllChildMarkers(null,!0);for(n._ignoreMove=!0,this.setOpacity(1),e=r.length-1;e>=0;e--)t=r[e],s.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(i.removeLayer(t._spiderLeg),delete t._spiderLeg);n.fire("unspiderfied",{cluster:this,markers:r}),n._ignoreMove=!1,n._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var n,i,s,r,o=this._group,a=o._map,h=o._featureGroup,c=this._group.options.spiderLegPolylineOptions;for(o._ignoreMove=!0,n=0;n<t.length;n++)r=a.layerPointToLatLng(e[n]),i=t[n],s=new L.Polyline([this._latlng,r],c),a.addLayer(s),i._spiderLeg=s,i._preSpiderfyLatlng=i._latlng,i.setLatLng(r),i.setZIndexOffset&&i.setZIndexOffset(1e6),h.addLayer(i);this.setOpacity(.3),o._ignoreMove=!1,o.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var n,i,s,r,o,a,h=this,c=this._group,l=c._map,u=c._featureGroup,d=this._latlng,p=l.latLngToLayerPoint(d),f=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),m=_.opacity;for(void 0===m&&(m=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),f?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=m,c._ignoreMove=!0,n=0;n<t.length;n++)i=t[n],a=l.layerPointToLatLng(e[n]),s=new L.Polyline([d,a],_),l.addLayer(s),i._spiderLeg=s,f&&(o=(r=s._path).getTotalLength()+.1,r.style.strokeDasharray=o,r.style.strokeDashoffset=o),i.setZIndexOffset&&i.setZIndexOffset(1e6),i.clusterHide&&i.clusterHide(),u.addLayer(i),i._setPos&&i._setPos(p);for(c._forceLayout(),c._animationStart(),n=t.length-1;n>=0;n--)a=l.layerPointToLatLng(e[n]),(i=t[n])._preSpiderfyLatlng=i._latlng,i.setLatLng(a),i.clusterShow&&i.clusterShow(),f&&((r=(s=i._spiderLeg)._path).style.strokeDashoffset=0,s.setStyle({opacity:m}));this.setOpacity(.3),c._ignoreMove=!1,setTimeout((function(){c._animationEnd(),c.fire("spiderfied",{cluster:h,markers:t})}),200)},_animationUnspiderfy:function(t){var e,n,i,s,r,o,a=this,h=this._group,c=h._map,l=h._featureGroup,u=t?c._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):c.latLngToLayerPoint(this._latlng),d=this.getAllChildMarkers(null,!0),p=L.Path.SVG;for(h._ignoreMove=!0,h._animationStart(),this.setOpacity(1),n=d.length-1;n>=0;n--)(e=d[n])._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,o=!0,e._setPos&&(e._setPos(u),o=!1),e.clusterHide&&(e.clusterHide(),o=!1),o&&l.removeLayer(e),p&&(r=(s=(i=e._spiderLeg)._path).getTotalLength()+.1,s.style.strokeDashoffset=r,i.setStyle({opacity:0})));h._ignoreMove=!1,setTimeout((function(){var t=0;for(n=d.length-1;n>=0;n--)(e=d[n])._spiderLeg&&t++;for(n=d.length-1;n>=0;n--)(e=d[n])._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),t>1&&l.removeLayer(e),c.removeLayer(e._spiderLeg),delete e._spiderLeg);h._animationEnd(),h.fire("unspiderfied",{cluster:a,markers:d})}),200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,n;for(e in t)for(n=t[e].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,n;for(e in t)n=t[e],this.hasLayer(n)&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(t,e){var n=this.options.icon;return L.setOptions(n,t),this.setIcon(n),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),t.MarkerClusterGroup=e,t.MarkerCluster=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)},9344:function(t,e){!function(t){"use strict";function e(t){var e,n,i,s;for(n=1,i=arguments.length;n<i;n++)for(e in s=arguments[n])t[e]=s[e];return t}var n=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function i(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var s=0;function r(t){return"_leaflet_id"in t||(t._leaflet_id=++s),t._leaflet_id}function o(t,e,n){var i,s,r,o;return o=function(){i=!1,s&&(r.apply(n,s),s=!1)},r=function(){i?s=arguments:(t.apply(n,arguments),setTimeout(o,e),i=!0)},r}function a(t,e,n){var i=e[1],s=e[0],r=i-s;return t===i&&n?t:((t-s)%r+r)%r+s}function h(){return!1}function c(t,e){if(!1===e)return t;var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function l(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function u(t){return l(t).split(/\s+/)}function d(t,e){for(var i in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?n(t.options):{}),e)t.options[i]=e[i];return t.options}function p(t,e,n){var i=[];for(var s in t)i.push(encodeURIComponent(n?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var f=/\{ *([\w_ -]+) *\}/g;function _(t,e){return t.replace(f,(function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i}))}var m=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function g(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function y(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function b(t){var e=+new Date,n=Math.max(0,16-(e-w));return w=e+n,window.setTimeout(t,n)}var C=window.requestAnimationFrame||y("RequestAnimationFrame")||b,T=window.cancelAnimationFrame||y("CancelAnimationFrame")||y("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function I(t,e,n){if(!n||C!==b)return C.call(window,i(t,e));t.call(e)}function E(t){t&&T.call(window,t)}var k={__proto__:null,extend:e,create:n,bind:i,get lastId(){return s},stamp:r,throttle:o,wrapNum:a,falseFn:h,formatNum:c,trim:l,splitWords:u,setOptions:d,getParamString:p,template:_,isArray:m,indexOf:g,emptyImageUrl:v,requestFn:C,cancelFn:T,requestAnimFrame:I,cancelAnimFrame:E};function P(){}P.extend=function(t){var i=function(){d(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=i.__super__=this.prototype,r=n(s);for(var o in r.constructor=i,i.prototype=r,this)Object.prototype.hasOwnProperty.call(this,o)&&"prototype"!==o&&"__super__"!==o&&(i[o]=this[o]);return t.statics&&e(i,t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=m(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[r].concat(t.includes))),e(r,t),delete r.statics,delete r.includes,r.options&&(r.options=s.options?n(s.options):{},e(r.options,t.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},i},P.include=function(t){var n=this.prototype.options;return e(this.prototype,t),t.options&&(this.prototype.options=n,this.mergeOptions(t.options)),this},P.mergeOptions=function(t){return e(this.prototype.options,t),this},P.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var S={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var s=0,r=(t=u(t)).length;s<r;s++)this._on(t[s],e,n);return this},off:function(t,e,n){if(arguments.length)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else{t=u(t);for(var s=1===arguments.length,r=0,o=t.length;r<o;r++)s?this._off(t[r]):this._off(t[r],e,n)}else delete this._events;return this},_on:function(t,e,n){if("function"==typeof e){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=void 0);for(var s={fn:e,ctx:n},r=i,o=0,a=r.length;o<a;o++)if(r[o].fn===e&&r[o].ctx===n)return;r.push(s)}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,n){var i,s,r;if(this._events&&(i=this._events[t]))if(1!==arguments.length)if(n===this&&(n=void 0),"function"==typeof e){for(s=0,r=i.length;s<r;s++){var o=i[s];if(o.ctx===n&&o.fn===e)return this._firingCount&&(o.fn=h,this._events[t]=i=i.slice()),void i.splice(s,1)}console.warn("listener not found")}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(s=0,r=i.length;s<r;s++)i[s].fn=h;delete this._events[t]}},fire:function(t,n,i){if(!this.listens(t,i))return this;var s=e({},n,{type:t,target:this,sourceTarget:n&&n.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var o=0,a=r.length;o<a;o++){var h=r[o];h.fn.call(h.ctx||this,s)}this._firingCount--}}return i&&this._propagateEvent(s),this},listens:function(t,e){"string"!=typeof t&&console.warn('"string" type argument expected');var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var s in t)this.once(s,t[s],e);return this}var r=i((function(){this.off(t,e,n).off(t,r,n)}),this);return this.on(t,e,n).on(t,r,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var n in this._eventParents)this._eventParents[n].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};S.addEventListener=S.on,S.removeEventListener=S.clearAllEventListeners=S.off,S.addOneTimeEventListener=S.once,S.fireEvent=S.fire,S.hasEventListeners=S.listens;var x=P.extend(S);function A(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var O=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function R(t,e,n){return t instanceof A?t:m(t)?new A(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new A(t.x,t.y):new A(t,e,n)}function N(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function M(t,e){return!t||t instanceof N?t:new N(t,e)}function D(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function F(t,e){return t instanceof D?t:new D(t,e)}function B(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function z(t,e,n){return t instanceof B?t:m(t)&&"object"!=typeof t[0]?3===t.length?new B(t[0],t[1],t[2]):2===t.length?new B(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new B(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new B(t,e,n)}A.prototype={clone:function(){return new A(this.x,this.y)},add:function(t){return this.clone()._add(R(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(R(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new A(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new A(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(t){var e=(t=R(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=R(t)).x===this.x&&t.y===this.y},contains:function(t){return t=R(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},N.prototype={extend:function(t){return t=R(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new A((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new A(this.min.x,this.max.y)},getTopRight:function(){return new A(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof A?R(t):M(t))instanceof N?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=M(t);var e=this.min,n=this.max,i=t.min,s=t.max,r=s.x>=e.x&&i.x<=n.x,o=s.y>=e.y&&i.y<=n.y;return r&&o},overlaps:function(t){t=M(t);var e=this.min,n=this.max,i=t.min,s=t.max,r=s.x>e.x&&i.x<n.x,o=s.y>e.y&&i.y<n.y;return r&&o},isValid:function(){return!(!this.min||!this.max)}},D.prototype={extend:function(t){var e,n,i=this._southWest,s=this._northEast;if(t instanceof B)e=t,n=t;else{if(!(t instanceof D))return t?this.extend(z(t)||F(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||s?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),s.lat=Math.max(n.lat,s.lat),s.lng=Math.max(n.lng,s.lng)):(this._southWest=new B(e.lat,e.lng),this._northEast=new B(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,s=Math.abs(e.lng-n.lng)*t;return new D(new B(e.lat-i,e.lng-s),new B(n.lat+i,n.lng+s))},getCenter:function(){return new B((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new B(this.getNorth(),this.getWest())},getSouthEast:function(){return new B(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof B||"lat"in t?z(t):F(t);var e,n,i=this._southWest,s=this._northEast;return t instanceof D?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=s.lat&&e.lng>=i.lng&&n.lng<=s.lng},intersects:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>=e.lat&&i.lat<=n.lat,o=s.lng>=e.lng&&i.lng<=n.lng;return r&&o},overlaps:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>e.lat&&i.lat<n.lat,o=s.lng>e.lng&&i.lng<n.lng;return r&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=F(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},B.prototype={equals:function(t,e){return!!t&&(t=z(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+c(this.lat,t)+", "+c(this.lng,t)+")"},distanceTo:function(t){return q.distance(this,z(t))},wrap:function(){return q.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return F([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new B(this.lat,this.lng,this.alt)}};var U,j={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new N(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new B(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,s=e.lng-n.lng;if(0===i&&0===s)return t;var r=t.getSouthWest(),o=t.getNorthEast();return new D(new B(r.lat-i,r.lng-s),new B(o.lat-i,o.lng-s))}},q=e({},j,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,s=e.lat*n,r=Math.sin((e.lat-t.lat)*n/2),o=Math.sin((e.lng-t.lng)*n/2),a=r*r+Math.cos(i)*Math.cos(s)*o*o,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),Z=6378137,V={R:Z,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),s=Math.sin(i*e);return new A(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new B((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(U=Z*Math.PI,new N([-U,-U],[U,U]))};function W(t,e,n,i){if(m(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function H(t,e,n,i){return new W(t,e,n,i)}W.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new A((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var G=e({},q,{code:"EPSG:3857",projection:V,transformation:function(){var t=.5/(Math.PI*V.R);return H(t,.5,-t,.5)}()}),K=e({},G,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $(t,e){var n,i,s,r,o,a,h="";for(n=0,s=t.length;n<s;n++){for(i=0,r=(o=t[n]).length;i<r;i++)h+=(i?"L":"M")+(a=o[i]).x+" "+a.y;h+=e?Nt.svg?"z":"x":""}return h||"M0 0"}var J,Q=document.documentElement.style,X="ActiveXObject"in window,tt=X&&!document.addEventListener,et="msLaunchUri"in navigator&&!("documentMode"in document),nt=Rt("webkit"),it=Rt("android"),st=Rt("android 2")||Rt("android 3"),rt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ot=it&&Rt("Google")&&rt<537&&!("AudioNode"in window),at=!!window.opera,ht=!et&&Rt("chrome"),ct=Rt("gecko")&&!nt&&!at&&!X,lt=!ht&&Rt("safari"),ut=Rt("phantom"),dt="OTransition"in Q,pt=0===navigator.platform.indexOf("Win"),ft=X&&"transition"in Q,_t="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!st,mt="MozPerspective"in Q,gt=!window.L_DISABLE_3D&&(ft||_t||mt)&&!dt&&!ut,vt="undefined"!=typeof orientation||Rt("mobile"),yt=vt&&nt,wt=vt&&_t,bt=!window.PointerEvent&&window.MSPointerEvent,Ct=!(!window.PointerEvent&&!bt),Tt="ontouchstart"in window||!!window.TouchEvent,It=!window.L_NO_TOUCH&&(Tt||Ct),Et=vt&&at,kt=vt&&ct,Pt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Lt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",h,e),window.removeEventListener("testPassiveEventSupport",h,e)}catch(t){}return t}(),St=!!document.createElement("canvas").getContext,xt=!(!document.createElementNS||!Y("svg").createSVGRect),At=!!xt&&((J=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(J.firstChild&&J.firstChild.namespaceURI)),Ot=!xt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Rt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Nt={ie:X,ielt9:tt,edge:et,webkit:nt,android:it,android23:st,androidStock:ot,opera:at,chrome:ht,gecko:ct,safari:lt,phantom:ut,opera12:dt,win:pt,ie3d:ft,webkit3d:_t,gecko3d:mt,any3d:gt,mobile:vt,mobileWebkit:yt,mobileWebkit3d:wt,msPointer:bt,pointer:Ct,touch:It,touchNative:Tt,mobileOpera:Et,mobileGecko:kt,retina:Pt,passiveEvents:Lt,canvas:St,svg:xt,vml:Ot,inlineSvg:At},Mt=Nt.msPointer?"MSPointerDown":"pointerdown",Dt=Nt.msPointer?"MSPointerMove":"pointermove",Ft=Nt.msPointer?"MSPointerUp":"pointerup",Bt=Nt.msPointer?"MSPointerCancel":"pointercancel",zt={touchstart:Mt,touchmove:Dt,touchend:Ft,touchcancel:Bt},Ut={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&Fe(e),Gt(t,e)},touchmove:Gt,touchend:Gt,touchcancel:Gt},jt={},qt=!1;function Zt(t,e,n){return"touchstart"===e&&(qt||(document.addEventListener(Mt,Vt,!0),document.addEventListener(Dt,Wt,!0),document.addEventListener(Ft,Ht,!0),document.addEventListener(Bt,Ht,!0),qt=!0)),Ut[e]?(n=Ut[e].bind(this,n),t.addEventListener(zt[e],n,!1),n):(console.warn("wrong event specified:",e),L.Util.falseFn)}function Vt(t){jt[t.pointerId]=t}function Wt(t){jt[t.pointerId]&&(jt[t.pointerId]=t)}function Ht(t){delete jt[t.pointerId]}function Gt(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in e.touches=[],jt)e.touches.push(jt[n]);e.changedTouches=[e],t(e)}}var Kt,Yt,$t,Jt,Qt,Xt=_e(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),te=_e(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ee="webkitTransition"===te||"OTransition"===te?te+"End":"transitionend";function ne(t){return"string"==typeof t?document.getElementById(t):t}function ie(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function se(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function re(t){var e=t.parentNode;e&&e.removeChild(t)}function oe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ae(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function he(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ce(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=pe(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function le(t,e){if(void 0!==t.classList)for(var n=u(e),i=0,s=n.length;i<s;i++)t.classList.add(n[i]);else if(!ce(t,e)){var r=pe(t);de(t,(r?r+" ":"")+e)}}function ue(t,e){void 0!==t.classList?t.classList.remove(e):de(t,l((" "+pe(t)+" ").replace(" "+e+" "," ")))}function de(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function pe(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function fe(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}(t,e)}function _e(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function me(t,e,n){var i=e||new A(0,0);t.style[Xt]=(Nt.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function ge(t,e){t._leaflet_pos=e,Nt.any3d?me(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ve(t){return t._leaflet_pos||new A(0,0)}if("onselectstart"in document)Kt=function(){Pe(window,"selectstart",Fe)},Yt=function(){Se(window,"selectstart",Fe)};else{var ye=_e(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Kt=function(){if(ye){var t=document.documentElement.style;$t=t[ye],t[ye]="none"}},Yt=function(){ye&&(document.documentElement.style[ye]=$t,$t=void 0)}}function we(){Pe(window,"dragstart",Fe)}function be(){Se(window,"dragstart",Fe)}function Ce(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Te(),Jt=t,Qt=t.style.outline,t.style.outline="none",Pe(window,"keydown",Te))}function Te(){Jt&&(Jt.style.outline=Qt,Jt=void 0,Qt=void 0,Se(window,"keydown",Te))}function Ie(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Ee(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var ke={__proto__:null,TRANSFORM:Xt,TRANSITION:te,TRANSITION_END:ee,get:ne,getStyle:ie,create:se,remove:re,empty:oe,toFront:ae,toBack:he,hasClass:ce,addClass:le,removeClass:ue,setClass:de,getClass:pe,setOpacity:fe,testProp:_e,setTransform:me,setPosition:ge,getPosition:ve,get disableTextSelection(){return Kt},get enableTextSelection(){return Yt},disableImageDrag:we,enableImageDrag:be,preventOutline:Ce,restoreOutline:Te,getSizedParentNode:Ie,getScale:Ee};function Pe(t,e,n,i){if(e&&"object"==typeof e)for(var s in e)Oe(t,s,e[s],n);else for(var r=0,o=(e=u(e)).length;r<o;r++)Oe(t,e[r],n,i);return this}var Le="_leaflet_events";function Se(t,e,n,i){if(1===arguments.length)xe(t),delete t[Le];else if(e&&"object"==typeof e)for(var s in e)Re(t,s,e[s],n);else if(e=u(e),2===arguments.length)xe(t,(function(t){return-1!==g(e,t)}));else for(var r=0,o=e.length;r<o;r++)Re(t,e[r],n,i);return this}function xe(t,e){for(var n in t[Le]){var i=n.split(/\d/)[0];e&&!e(i)||Re(t,i,null,null,n)}}var Ae={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Oe(t,e,n,i){var s=e+r(n)+(i?"_"+r(i):"");if(t[Le]&&t[Le][s])return this;var o=function(e){return n.call(i||t,e||window.event)},a=o;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?o=Zt(t,e,o):Nt.touch&&"dblclick"===e?o=function(t,e){t.addEventListener("dblclick",e);var n,i=0;function s(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var s=Date.now();s-i<=200?2==++n&&e(function(t){var e,n,i={};for(n in t)e=t[n],i[n]=e&&e.bind?e.bind(t):e;return t=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}(t)):n=1,i=s}}else n=t.detail}return t.addEventListener("click",s),{dblclick:e,simDblclick:s}}(t,o):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ae[e]||e,o,!!Nt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,qe(t,e)&&a(e)},t.addEventListener(Ae[e],o,!1)):t.addEventListener(e,a,!1):t.attachEvent("on"+e,o),t[Le]=t[Le]||{},t[Le][s]=o}function Re(t,e,n,i,s){s=s||e+r(n)+(i?"_"+r(i):"");var o=t[Le]&&t[Le][s];if(!o)return this;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?function(t,e,n){zt[e]?t.removeEventListener(zt[e],n,!1):console.warn("wrong event specified:",e)}(t,e,o):Nt.touch&&"dblclick"===e?function(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}(t,o):"removeEventListener"in t?t.removeEventListener(Ae[e]||e,o,!1):t.detachEvent("on"+e,o),t[Le][s]=null}function Ne(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Me(t){return Oe(t,"wheel",Ne),this}function De(t){return Pe(t,"mousedown touchstart dblclick contextmenu",Ne),t._leaflet_disable_click=!0,this}function Fe(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Be(t){return Fe(t),Ne(t),this}function ze(t,e){if(!e)return new A(t.clientX,t.clientY);var n=Ee(e),i=n.boundingClientRect;return new A((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var Ue=Nt.win&&Nt.chrome?2*window.devicePixelRatio:Nt.gecko?window.devicePixelRatio:1;function je(t){return Nt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Ue:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function qe(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var Ze={__proto__:null,on:Pe,off:Se,stopPropagation:Ne,disableScrollPropagation:Me,disableClickPropagation:De,preventDefault:Fe,stop:Be,getMousePosition:ze,getWheelDelta:je,isExternalTarget:qe,addListener:Pe,removeListener:Se},Ve=x.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=ve(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=I(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),ge(this._el,n),this.fire("step")},_complete:function(){E(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),We=x.extend({options:{crs:G,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=d(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(z(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=te&&Nt.any3d&&!Nt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Pe(this._proxy,ee,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,n,i){return n=void 0===n?this._zoom:this._limitZoom(n),t=this._limitCenter(z(t),n,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=e({animate:i.animate},i.zoom),i.pan=e({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==n?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,n,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,n),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),s=this.getSize().divideBy(2),r=(t instanceof A?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/i),o=this.containerPointToLatLng(s.add(r));return this.setView(o,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():F(t);var n=R(e.paddingTopLeft||e.padding||[0,0]),i=R(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,n.add(i));if((s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s)===1/0)return{center:t.getCenter(),zoom:s};var r=i.subtract(n).divideBy(2),o=this.project(t.getSouthWest(),s),a=this.project(t.getNorthEast(),s);return{center:this.unproject(o.add(a).divideBy(2).add(r),s),zoom:s}},fitBounds:function(t,e){if(!(t=F(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=R(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ve,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){le(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!Nt.any3d)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),s=this.project(t),r=this.getSize(),o=this._zoom;t=z(t),e=void 0===e?o:e;var a=Math.max(r.x,r.y),h=a*this.getZoomScale(o,e),c=s.distanceTo(i)||1,l=1.42,u=2.0164;function d(t){var e=(h*h-a*a+(t?-1:1)*u*u*c*c)/(2*(t?h:a)*u*c),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var _=d(0);function m(t){return a*(f(_)*(p(e=_+l*t)/f(e))-p(_))/u;var e}var g=Date.now(),v=(d(1)-_)/l,y=n.duration?1e3*n.duration:1e3*v*.8;return this._moveStart(!0,n.noMoveStart),function n(){var r=(Date.now()-g)/y,h=function(t){return 1-Math.pow(1-t,1.5)}(r)*v;r<=1?(this._flyToFrame=I(n,this),this._move(this.unproject(i.add(s.subtract(i).multiplyBy(m(h)/c)),o),this.getScaleZoom(a/function(t){return a*(f(_)/f(_+l*t))}(h),o),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=F(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,F(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=R((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=R(e.paddingBottomRight||e.padding||[0,0]),s=this.project(this.getCenter()),r=this.project(t),o=this.getPixelBounds(),a=M([o.min.add(n),o.max.subtract(i)]),h=a.getSize();if(!a.contains(r)){this._enforcingBounds=!0;var c=r.subtract(a.getCenter()),l=a.extend(r).getSize().subtract(h);s.x+=c.x<0?-l.x:l.x,s.y+=c.y<0?-l.y:l.y,this.panTo(this.unproject(s),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var s=this.getSize(),r=n.divideBy(2).round(),o=s.divideBy(2).round(),a=r.subtract(o);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:s})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=i(this._handleGeolocationResponse,this),s=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,s,t):navigator.geolocation.getCurrentPosition(n,s,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new B(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var s=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(s,i.maxZoom):s)}var r={latlng:e,bounds:n,timestamp:t.timestamp};for(var o in t.coords)"number"==typeof t.coords[o]&&(r[o]=t.coords[o]);this.fire("locationfound",r)}},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),re(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(E(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)re(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=se("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new D(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=F(t),n=R(n||[0,0]);var i=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),o=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(n),c=M(this.project(a,i),this.project(o,i)).getSize(),l=Nt.any3d?this.options.zoomSnap:1,u=h.x/c.x,d=h.y/c.y,p=e?Math.max(u,d):Math.min(u,d);return i=this.getScaleZoom(p,i),l&&(i=Math.round(i/(l/100))*(l/100),i=e?Math.ceil(i/l)*l:Math.floor(i/l)*l),Math.max(s,Math.min(r,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new A(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new N(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(z(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(R(t),e)},layerPointToLatLng:function(t){var e=R(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(z(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(z(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(F(t))},distance:function(t,e){return this.options.crs.distance(z(t),z(e))},containerPointToLayerPoint:function(t){return R(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return R(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(R(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(z(t)))},mouseEventToContainerPoint:function(t){return ze(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ne(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Pe(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Nt.any3d,le(t,"leaflet-container"+(Nt.touch?" leaflet-touch":"")+(Nt.retina?" leaflet-retina":"")+(Nt.ielt9?" leaflet-oldie":"")+(Nt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ie(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ge(this._mapPane,new A(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(le(t.markerPane,"leaflet-zoom-hide"),le(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){ge(this._mapPane,new A(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var i=this._zoom!==e;this._moveStart(i,!1)._move(t,e)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,i){void 0===e&&(e=this._zoom);var s=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),i?n&&n.pinch&&this.fire("zoom",n):((s||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return E(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ge(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Se:Pe;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Nt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){E(this._resizeRequest),this._resizeRequest=I((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],s="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((n=this._targets[r(o)])&&("click"===e||"preclick"===e)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(s&&!qe(o,t))break;if(i.push(n),s)break}if(o===this._container)break;o=o.parentNode}return i.length||a||s||!this.listens(e,!0)||(i=[this]),i},_isClickDisabled:function(t){for(;t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var n=t.type;"mousedown"===n&&Ce(e),this._fireDOMEvent(t,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,n,i){if("click"===t.type){var s=e({},t);s.type="preclick",this._fireDOMEvent(s,s.type,i)}var r=this._findEventTargets(t,n);if(i){for(var o=[],a=0;a<i.length;a++)i[a].listens(n,!0)&&o.push(i[a]);r=o.concat(r)}if(r.length){"contextmenu"===n&&Fe(t);var h=r[0],c={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var l=h.getLatLng&&(!h._radius||h._radius<=10);c.containerPoint=l?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(t),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=l?h.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<r.length;a++)if(r[a].fire(n,c,!0),c.originalEvent._stopped||!1===r[a].options.bubblingMouseEvents&&-1!==g(this._mouseEvents,n))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ve(this._mapPane)||new A(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return M([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),s=this.getSize().divideBy(2),r=new N(i.subtract(s),i.add(s)),o=this._getBoundsOffset(r,n,e);return o.round().equals([0,0])?t:this.unproject(i.add(o),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new N(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=M(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),s=i.min.subtract(t.min),r=i.max.subtract(t.max);return new A(this._rebound(s.x,-r.x),this._rebound(s.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=Nt.any3d?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ue(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=se("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=Xt,n=this._proxy.style[e];me(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){re(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();me(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(s)||(I((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,s){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,le(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:s}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ue(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var He=P.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return le(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(re(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ge=function(t){return new He(t)};We.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=se("div",e+"control-container",this._container);function i(i,s){var r=e+i+" "+e+s;t[i+s]=se("div",r,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)re(this._controlCorners[t]);re(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ke=He.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in d(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return He.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){le(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(le(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ue(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ue(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=se("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),De(e),Me(e);var i=this._section=se("section",t+"-list");n&&(this._map.on("click",this.collapse,this),Pe(e,{mouseenter:function(){Pe(i,"click",Fe),this.expand(),setTimeout((function(){Se(i,"click",Fe)}))},mouseleave:this.collapse},this));var s=this._layersLink=se("a",t+"-toggle",e);s.href="#",s.title="Layers",s.setAttribute("role","button"),Pe(s,"click",Fe),Pe(s,"focus",this.expand,this),n||this.expand(),this._baseLayersList=se("div",t+"-base",i),this._separator=se("div",t+"-separator",i),this._overlaysList=se("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;oe(this._baseLayersList),oe(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,s=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,s+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+r(this),i),this._layerControlInputs.push(e),e.layerId=r(t.layer),Pe(e,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+t.name;var o=document.createElement("span");return n.appendChild(o),o.appendChild(e),o.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,i=[],s=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||s.push(e);for(r=0;r<s.length;r++)this._map.hasLayer(s[r])&&this._map.removeLayer(s[r]);for(r=0;r<i.length;r++)this._map.hasLayer(i[r])||this._map.addLayer(i[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),s=n.length-1;s>=0;s--)t=n[s],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this}}),Ye=He.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=se("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,s){var r=se("a",n,i);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),De(r),Pe(r,"click",Be),Pe(r,"click",s,this),Pe(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";ue(this._zoomInButton,e),ue(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(le(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(le(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});We.mergeOptions({zoomControl:!0}),We.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Ye,this.addControl(this.zoomControl))}));var $e=He.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=se("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=se("div",e,n)),t.imperial&&(this._iScale=se("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,s=3.2808399*t;s>5280?(e=s/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(s),this._updateScale(this._iScale,i+" ft",i/s))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),Je=He.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Nt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=se("div","leaflet-control-attribution"),De(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});We.mergeOptions({attributionControl:!0}),We.addInitHook((function(){this.options.attributionControl&&(new Je).addTo(this)}));He.Layers=Ke,He.Zoom=Ye,He.Scale=$e,He.Attribution=Je,Ge.layers=function(t,e,n){return new Ke(t,e,n)},Ge.zoom=function(t){return new Ye(t)},Ge.scale=function(t){return new $e(t)},Ge.attribution=function(t){return new Je(t)};var Qe=P.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Qe.addTo=function(t,e){return t.addHandler(e,this),this};var Xe,tn={Events:S},en=Nt.touch?"touchstart mousedown":"mousedown",nn=x.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){d(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Pe(this._dragStartTarget,en,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(nn._dragging===this&&this.finishDrag(!0),Se(this._dragStartTarget,en,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!ce(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)nn._dragging===this&&this.finishDrag();else if(!(nn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(nn._dragging=this,this._preventOutline&&Ce(this._element),we(),Kt(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,n=Ie(this._element);this._startPoint=new A(e.clientX,e.clientY),this._startPos=ve(this._element),this._parentScale=Ee(n);var i="mousedown"===t.type;Pe(document,i?"mousemove":"touchmove",this._onMove,this),Pe(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new A(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Fe(t),this._moved||(this.fire("dragstart"),this._moved=!0,le(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),le(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ge(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ue(document.body,"leaflet-dragging"),this._lastTarget&&(ue(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Se(document,"mousemove touchmove",this._onMove,this),Se(document,"mouseup touchend touchcancel",this._onUp,this),be(),Yt(),this._moved&&this._moving&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,nn._dragging=!1}});function sn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return function(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,on(t,i,e,0,n-1);var s,r=[];for(s=0;s<n;s++)i[s]&&r.push(t[s]);return r}(t=function(t,e){for(var n=[t[0]],i=1,s=0,r=t.length;i<r;i++)ln(t[i],t[s])>e&&(n.push(t[i]),s=i);return s<r-1&&n.push(t[r-1]),n}(t,n),n)}function rn(t,e,n){return Math.sqrt(un(t,e,n,!0))}function on(t,e,n,i,s){var r,o,a,h=0;for(o=i+1;o<=s-1;o++)(a=un(t[o],t[i],t[s],!0))>h&&(r=o,h=a);h>n&&(e[r]=1,on(t,e,n,i,r),on(t,e,n,r,s))}function an(t,e,n,i,s){var r,o,a,h=i?Xe:cn(t,n),c=cn(e,n);for(Xe=c;;){if(!(h|c))return[t,e];if(h&c)return!1;a=cn(o=hn(t,e,r=h||c,n,s),n),r===h?(t=o,h=a):(e=o,c=a)}}function hn(t,e,n,i,s){var r,o,a=e.x-t.x,h=e.y-t.y,c=i.min,l=i.max;return 8&n?(r=t.x+a*(l.y-t.y)/h,o=l.y):4&n?(r=t.x+a*(c.y-t.y)/h,o=c.y):2&n?(r=l.x,o=t.y+h*(l.x-t.x)/a):1&n&&(r=c.x,o=t.y+h*(c.x-t.x)/a),new A(r,o,s)}function cn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function ln(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function un(t,e,n,i){var s,r=e.x,o=e.y,a=n.x-r,h=n.y-o,c=a*a+h*h;return c>0&&((s=((t.x-r)*a+(t.y-o)*h)/c)>1?(r=n.x,o=n.y):s>0&&(r+=a*s,o+=h*s)),a=t.x-r,h=t.y-o,i?a*a+h*h:new A(r,o)}function dn(t){return!m(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function pn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),dn(t)}var fn={__proto__:null,simplify:sn,pointToSegmentDistance:rn,closestPointOnSegment:function(t,e,n){return un(t,e,n)},clipSegment:an,_getEdgeIntersection:hn,_getBitCode:cn,_sqClosestPointOnSegment:un,isFlat:dn,_flat:pn};function _n(t,e,n){var i,s,r,o,a,h,c,l,u,d=[1,4,2,8];for(s=0,c=t.length;s<c;s++)t[s]._code=cn(t[s],e);for(o=0;o<4;o++){for(l=d[o],i=[],s=0,r=(c=t.length)-1;s<c;r=s++)a=t[s],h=t[r],a._code&l?h._code&l||((u=hn(h,a,l,e,n))._code=cn(u,e),i.push(u)):(h._code&l&&((u=hn(h,a,l,e,n))._code=cn(u,e),i.push(u)),i.push(a));t=i}return t}var mn={__proto__:null,clipPolygon:_n},gn={project:function(t){return new A(t.lng,t.lat)},unproject:function(t){return new B(t.y,t.x)},bounds:new N([-180,-90],[180,90])},vn={R:6378137,R_MINOR:6356752.314245179,bounds:new N([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),o=r*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-o)/(1+o),r/2);return i=-n*Math.log(Math.max(a,1e-10)),new A(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,s=this.R_MINOR/i,r=Math.sqrt(1-s*s),o=Math.exp(-t.y/i),a=Math.PI/2-2*Math.atan(o),h=0,c=.1;h<15&&Math.abs(c)>1e-7;h++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),a+=c=Math.PI/2-2*Math.atan(o*e)-a;return new B(a*n,t.x*n/i)}},yn={__proto__:null,LonLat:gn,Mercator:vn,SphericalMercator:V},wn=e({},q,{code:"EPSG:3395",projection:vn,transformation:function(){var t=.5/(Math.PI*vn.R);return H(t,.5,-t,.5)}()}),bn=e({},q,{code:"EPSG:4326",projection:gn,transformation:H(1/180,1,-1/180,.5)}),Cn=e({},j,{projection:gn,transformation:H(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});j.Earth=q,j.EPSG3395=wn,j.EPSG3857=G,j.EPSG900913=K,j.EPSG4326=bn,j.Simple=Cn;var Tn=x.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});We.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return r(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?m(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var s=this._zoomBoundLayers[i].options;t=void 0===s.minZoom?t:Math.min(t,s.minZoom),e=void 0===s.maxZoom?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var In=Tn.extend({initialize:function(t,e){var n,i;if(d(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),En=In.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),In.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),In.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new D;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),kn=P.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var s=R(i),r=R("shadow"===e&&n.shadowAnchor||n.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Nt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var Pn=kn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof Pn.imagePath&&(Pn.imagePath=this._detectIconPath()),(this.options.imagePath||Pn.imagePath)+kn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,n){var i=e.exec(t);return i&&i[n]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=se("div","leaflet-default-icon-path",document.body),e=ie(t,"background-image")||ie(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-"leaflet.css".length-1):""}}),Ln=Qe.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new nn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),le(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ue(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,r=ve(e._icon),o=n.getPixelBounds(),a=n.getPixelOrigin(),h=M(o.min._subtract(a).add(s),o.max._subtract(a).subtract(s));if(!h.contains(r)){var c=R((Math.max(h.max.x,r.x)-h.max.x)/(o.max.x-h.max.x)-(Math.min(h.min.x,r.x)-h.min.x)/(o.min.x-h.min.x),(Math.max(h.max.y,r.y)-h.max.y)/(o.max.y-h.max.y)-(Math.min(h.min.y,r.y)-h.min.y)/(o.min.y-h.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),ge(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=I(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(E(this._panRequest),this._panRequest=I(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=ve(e._icon),s=e._map.layerPointToLatLng(i);n&&ge(n,i),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){E(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Sn=Tn.extend({options:{icon:new Pn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=z(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=z(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),le(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pe(n,"focus",this._panOnFocus,this);var s=t.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&(le(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Se(this._icon,"focus",this._panOnFocus,this),re(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&re(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ge(this._icon,t),this._shadow&&ge(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(le(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ln)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ln(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&fe(this._icon,t),this._shadow&&fe(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,n=e.iconSize?R(e.iconSize):R(0,0),i=e.iconAnchor?R(e.iconAnchor):R(0,0);t.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var xn=Tn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),An=xn.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=z(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=z(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return xn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new N(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var On=An.extend({initialize:function(t,n,i){if("number"==typeof n&&(n=e({},i,{radius:n})),d(this,n),this._latlng=z(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new D(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:xn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===q.distance){var s=Math.PI/180,r=this._mRadius/q.R/s,o=n.project([e+r,t]),a=n.project([e-r,t]),h=o.add(a).divideBy(2),c=n.unproject(h).lat,l=Math.acos((Math.cos(r*s)-Math.sin(e*s)*Math.sin(c*s))/(Math.cos(e*s)*Math.cos(c*s)))/s;(isNaN(l)||0===l)&&(l=r/Math.cos(Math.PI/180*e)),this._point=h.subtract(n.getPixelOrigin()),this._radius=isNaN(l)?0:h.x-n.project([c,t-l]).x,this._radiusY=h.y-o.y}else{var u=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(u).x}this._updateBounds()}});var Rn=xn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,s=null,r=un,o=0,a=this._parts.length;o<a;o++)for(var h=this._parts[o],c=1,l=h.length;c<l;c++){var u=r(t,e=h[c-1],n=h[c],!0);u<i&&(i=u,s=r(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,s,r,o,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,i=0;t<h-1;t++)if(s=a[t],r=a[t+1],(i+=n=s.distanceTo(r))>e)return o=(i-e)/n,this._map.layerPointToLatLng([r.x-o*(r.x-s.x),r.y-o*(r.y-s.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=z(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new D,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return dn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=dn(t),i=0,s=t.length;i<s;i++)n?(e[i]=z(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new N;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new A(t,t);this._rawPxBounds&&(this._pxBounds=new N([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,n){var i,s,r=t[0]instanceof B,o=t.length;if(r){for(s=[],i=0;i<o;i++)s[i]=this._map.latLngToLayerPoint(t[i]),n.extend(s[i]);e.push(s)}else for(i=0;i<o;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,s,r,o,a,h=this._parts;for(e=0,i=0,s=this._rings.length;e<s;e++)for(n=0,r=(a=this._rings[e]).length;n<r-1;n++)(o=an(a[n],a[n+1],t,n,!0))&&(h[i]=h[i]||[],h[i].push(o[0]),o[1]===a[n+1]&&n!==r-2||(h[i].push(o[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=sn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,s,r,o,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,r=this._parts.length;n<r;n++)for(i=0,s=(o=(a=this._parts[n]).length)-1;i<o;s=i++)if((e||0!==i)&&rn(t,a[s],a[i])<=h)return!0;return!1}});Rn._flat=pn;var Nn=Rn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,s,r,o,a,h,c=this._rings[0],l=c.length;if(!l)return null;for(r=o=a=0,t=0,e=l-1;t<l;e=t++)n=c[t],i=c[e],s=n.y*i.x-i.y*n.x,o+=(n.x+i.x)*s,a+=(n.y+i.y)*s,r+=3*s;return h=0===r?c[0]:[o/r,a/r],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=Rn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof B&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Rn.prototype._setLatLngs.call(this,t),dn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return dn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new A(e,e);if(t=new N(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,s=0,r=this._rings.length;s<r;s++)(i=_n(this._rings[s],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,s,r,o,a,h,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(s=0,a=this._parts.length;s<a;s++)for(r=0,o=(h=(e=this._parts[s]).length)-1;r<h;o=r++)n=e[r],i=e[o],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||Rn.prototype._containsPoint.call(this,t,!0)}});var Mn=En.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,s=m(t)?t:t.features;if(s){for(e=0,n=s.length;e<n;e++)((i=s[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var o=Dn(t,r);return o?(o.feature=Zn(t),o.defaultOptions=o.options,this.resetStyle(o),r.onEachFeature&&r.onEachFeature(t,o),this.addLayer(o)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Dn(t,e){var n,i,s,r,o="Feature"===t.type?t.geometry:t,a=o?o.coordinates:null,h=[],c=e&&e.pointToLayer,l=e&&e.coordsToLatLng||Bn;if(!a&&!o)return null;switch(o.type){case"Point":return Fn(c,t,n=l(a),e);case"MultiPoint":for(s=0,r=a.length;s<r;s++)n=l(a[s]),h.push(Fn(c,t,n,e));return new En(h);case"LineString":case"MultiLineString":return i=zn(a,"LineString"===o.type?0:1,l),new Rn(i,e);case"Polygon":case"MultiPolygon":return i=zn(a,"Polygon"===o.type?1:2,l),new Nn(i,e);case"GeometryCollection":for(s=0,r=o.geometries.length;s<r;s++){var u=Dn({geometry:o.geometries[s],type:"Feature",properties:t.properties},e);u&&h.push(u)}return new En(h);default:throw new Error("Invalid GeoJSON object.")}}function Fn(t,e,n,i){return t?t(e,n):new Sn(n,i&&i.markersInheritOptions&&i)}function Bn(t){return new B(t[1],t[0],t[2])}function zn(t,e,n){for(var i,s=[],r=0,o=t.length;r<o;r++)i=e?zn(t[r],e-1,n):(n||Bn)(t[r]),s.push(i);return s}function Un(t,e){return void 0!==(t=z(t)).alt?[c(t.lng,e),c(t.lat,e),c(t.alt,e)]:[c(t.lng,e),c(t.lat,e)]}function jn(t,e,n,i){for(var s=[],r=0,o=t.length;r<o;r++)s.push(e?jn(t[r],e-1,n,i):Un(t[r],i));return!e&&n&&s.push(s[0]),s}function qn(t,n){return t.feature?e({},t.feature,{geometry:n}):Zn(n)}function Zn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Vn={toGeoJSON:function(t){return qn(this,{type:"Point",coordinates:Un(this.getLatLng(),t)})}};function Wn(t,e){return new Mn(t,e)}Sn.include(Vn),On.include(Vn),An.include(Vn),Rn.include({toGeoJSON:function(t){var e=!dn(this._latlngs);return qn(this,{type:(e?"Multi":"")+"LineString",coordinates:jn(this._latlngs,e?1:0,!1,t)})}}),Nn.include({toGeoJSON:function(t){var e=!dn(this._latlngs),n=e&&!dn(this._latlngs[0]),i=jn(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),qn(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),In.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),qn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer((function(e){if(e.toGeoJSON){var s=e.toGeoJSON(t);if(n)i.push(s.geometry);else{var r=Zn(s);"FeatureCollection"===r.type?i.push.apply(i,r.features):i.push(r)}}})),n?qn(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var Hn=Wn,Gn=Tn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=F(e),d(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(le(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){re(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ae(this._image),this},bringToBack:function(){return this._map&&he(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=F(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:se("img");le(e,"leaflet-image-layer"),this._zoomAnimated&&le(e,"leaflet-zoom-animated"),this.options.className&&le(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;me(this._image,n,e)},_reset:function(){var t=this._image,e=new N(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();ge(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){fe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Kn=Gn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:se("video");if(le(e,"leaflet-image-layer"),this._zoomAnimated&&le(e,"leaflet-zoom-animated"),this.options.className&&le(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),s=[],r=0;r<n.length;r++)s.push(n[r].src);this._url=n.length>0?s:[e.src]}else{m(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=se("source");a.src=this._url[o],e.appendChild(a)}}}});var Yn=Gn.extend({_initImage:function(){var t=this._image=this._url;le(t,"leaflet-image-layer"),this._zoomAnimated&&le(t,"leaflet-zoom-animated"),this.options.className&&le(t,this.options.className),t.onselectstart=h,t.onmousemove=h}});var $n=Tn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0},initialize:function(t,e){d(this,t),this._source=e},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&fe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&fe(this._container,1),this.bringToFront(),this.options.interactive&&(le(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(fe(this._container,0),this._removeTimeout=setTimeout(i(re,void 0,this._container),200)):re(this._container),this.options.interactive&&(ue(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=z(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ae(this._container),this},bringToBack:function(){return this._map&&he(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof En){e=null;var n=this._source._layers;for(var i in n)if(n[i]._map){e=n[i];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=R(this.options.offset),n=this._getAnchor();this._zoomAnimated?ge(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}});We.include({_initOverlay:function(t,e,n,i){var s=e;return s instanceof t||(s=new t(i).setContent(e)),n&&s.setLatLng(n),s}}),Tn.include({_initOverlay:function(t,e,n,i){var s=n;return s instanceof t?(d(s,i),s._source=this):(s=e&&!i?e:new t(i,this)).setContent(n),s}});var Jn=$n.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,$n.prototype.openOn.call(this,t)},onAdd:function(t){$n.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof xn||this._source.on("preclick",Ne))},onRemove:function(t){$n.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof xn||this._source.off("preclick",Ne))},getEvents:function(){var t=$n.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=se("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=se("div",t+"-content-wrapper",e);if(this._contentNode=se("div",t+"-content",n),De(e),Me(this._contentNode),Pe(e,"contextmenu",Ne),this._tipContainer=se("div",t+"-tip-container",e),this._tip=se("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=se("a",t+"-close-button",e);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Pe(i,"click",this.close,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,s=this.options.maxHeight,r="leaflet-popup-scrolled";s&&i>s?(e.height=s+"px",le(t,r)):ue(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();ge(this._container,e.add(n))},_adjustPan:function(t){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var e=this._map,n=parseInt(ie(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+n,s=this._containerWidth,r=new A(this._containerLeft,-i-this._containerBottom);r._add(ve(this._container));var o=e.layerPointToContainerPoint(r),a=R(this.options.autoPanPadding),h=R(this.options.autoPanPaddingTopLeft||a),c=R(this.options.autoPanPaddingBottomRight||a),l=e.getSize(),u=0,d=0;o.x+s+c.x>l.x&&(u=o.x+s-l.x+c.x),o.x-u-h.x<0&&(u=o.x-h.x),o.y+i+c.y>l.y&&(d=o.y+i-l.y+c.y),o.y-d-h.y<0&&(d=o.y-h.y),(u||d)&&e.fire("autopanstart").panBy([u,d],{animate:t&&"moveend"===t.type})}},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});We.mergeOptions({closePopupOnClick:!0}),We.include({openPopup:function(t,e,n){return this._initOverlay(Jn,t,e,n).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Tn.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Jn,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&this._popup._prepareOpen(t)&&this._popup.openOn(this._map),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Be(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof xn?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Qn=$n.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){$n.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){$n.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=$n.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=se("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,s=this._container,r=i.latLngToContainerPoint(i.getCenter()),o=i.layerPointToContainerPoint(t),a=this.options.direction,h=s.offsetWidth,c=s.offsetHeight,l=R(this.options.offset),u=this._getAnchor();"top"===a?(e=h/2,n=c):"bottom"===a?(e=h/2,n=0):"center"===a?(e=h/2,n=c/2):"right"===a?(e=0,n=c/2):"left"===a?(e=h,n=c/2):o.x<r.x?(a="right",e=0,n=c/2):(a="left",e=h+2*(l.x+u.x),n=c/2),t=t.subtract(R(e,n,!0)).add(l).add(u),ue(s,"leaflet-tooltip-right"),ue(s,"leaflet-tooltip-left"),ue(s,"leaflet-tooltip-top"),ue(s,"leaflet-tooltip-bottom"),le(s,"leaflet-tooltip-"+a),ge(s,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&fe(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});We.include({openTooltip:function(t,e,n){return this._initOverlay(Qn,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Tn.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Qn,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&this._tooltip._prepareOpen(t)&&this._tooltip.openOn(this._map),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0))},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Xn=kn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(oe(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=R(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});kn.Default=Pn;var ti=Tn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Nt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),re(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ae(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(he(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof A?t:new A(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),s=0,r=n.length;s<r;s++)e=n[s].style.zIndex,n[s]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Nt.ielt9){fe(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var s=this._tiles[i];if(s.current&&s.loaded){var r=Math.min(1,(t-s.loaded)/200);fe(s.el,r),r<1?e=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(E(this._fadeFrame),this._fadeFrame=I(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=se("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(re(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],s=this._map;return i||((i=this._levels[t]={}).el=se("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,s.getCenter(),s.getZoom()),i.el.offsetWidth,this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)re(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var s=Math.floor(t/2),r=Math.floor(e/2),o=n-1,a=new A(+s,+r);a.z=+o;var h=this._tileCoordsToKey(a),c=this._tiles[h];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),o>i&&this._retainParent(s,r,o,i))},_retainChildren:function(t,e,n,i){for(var s=2*t;s<2*t+2;s++)for(var r=2*e;r<2*e+2;r++){var o=new A(s,r);o.z=n+1;var a=this._tileCoordsToKey(o),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),n+1<i&&this._retainChildren(s,r,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var s=Math.round(e);s=void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom?void 0:this._clampZoom(s);var r=this.options.updateWhenZooming&&s!==this._tileZoom;i&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),s=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();Nt.any3d?me(t.el,s,i):ge(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),s=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*i);return new N(s.subtract(r),s.add(r))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(i),r=s.getCenter(),o=[],a=this.options.keepBuffer,h=new N(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var l=this._tiles[c].coords;l.z===this._tileZoom&&h.contains(new A(l.x,l.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var u=s.min.y;u<=s.max.y;u++)for(var d=s.min.x;d<=s.max.x;d++){var p=new A(d,u);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:o.push(p)}}if(o.sort((function(t,e){return t.distanceTo(r)-e.distanceTo(r)})),0!==o.length){this._loading||(this._loading=!0,this.fire("loading"));var _=document.createDocumentFragment();for(d=0;d<o.length;d++)this._addTile(o[d],_);this._level.el.appendChild(_)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return F(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),s=i.add(n);return[e.unproject(i,t.z),e.unproject(s,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new D(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new A(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(re(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){le(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=h,t.onmousemove=h,Nt.ielt9&&this.options.opacity<1&&fe(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),s=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&I(i(this._tileReady,this,t,null,r)),ge(r,n),this._tiles[s]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var s=this._tileCoordsToKey(t);(n=this._tiles[s])&&(n.loaded=+new Date,this._map._fadeAnimated?(fe(n.el,0),E(this._fadeFrame),this._fadeFrame=I(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(le(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Nt.ielt9||!this._map._fadeAnimated?I(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new A(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new N(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var ei=ti.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=d(this,e)).detectRetina&&Nt.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Pe(n,"load",i(this._tileOnLoad,this,e,n)),Pe(n,"error",i(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var n={r:Nt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(n.y=i),n["-y"]=i}return _(this._url,e(n,this.options))},_tileOnLoad:function(t,e){Nt.ielt9?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=h,e.onerror=h,!e.complete)){e.src=v;var n=this._tiles[t].coords;re(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:n})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",v),ti.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==v))return ti.prototype._tileReady.call(this,t,e,n)}});function ni(t,e){return new ei(t,e)}var ii=ei.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,n){this._url=t;var i=e({},this.defaultWmsParams);for(var s in n)s in this.options||(i[s]=n[s]);var r=(n=d(this,n)).detectRetina&&Nt.retina?2:1,o=this.getTileSize();i.width=o.x*r,i.height=o.y*r,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,ei.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=M(n.project(e[0]),n.project(e[1])),s=i.min,r=i.max,o=(this._wmsVersion>=1.3&&this._crs===bn?[s.y,s.x,r.y,r.x]:[s.x,s.y,r.x,r.y]).join(","),a=ei.prototype.getTileUrl.call(this,t);return a+p(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,n){return e(this.wmsParams,t),n||this.redraw(),this}});ei.WMS=ii,ni.wms=function(t,e){return new ii(t,e)};var si=Tn.extend({options:{padding:.1},initialize:function(t){d(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&le(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,e),r=i.multiplyBy(-n).add(s).subtract(this._map._getNewPixelOrigin(t,e));Nt.any3d?me(this._container,r,n):ge(this._container,r)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new N(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ri=si.extend({options:{tolerance:0},getEvents:function(){var t=si.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){si.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Pe(t,"mousemove",this._onMouseMove,this),Pe(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Pe(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){E(this._redrawRequest),delete this._ctx,re(this._container),Se(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){si.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=Nt.retina?2:1;ge(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Nt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){si.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),s=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;s.push(e)}t.options._dashArray=s}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||I(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new N,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,s,r,o=t._parts,a=o.length,h=this._ctx;if(a){for(h.beginPath(),n=0;n<a;n++){for(i=0,s=o[n].length;i<s;i++)r=o[n][i],h[i?"lineTo":"moveTo"](r.x,r.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),s=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==s&&(n.save(),n.scale(1,s)),n.beginPath(),n.arc(e.x,e.y/s,i,0,2*Math.PI,!1),1!==s&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(n=e);this._fireEvent(!!n&&[n],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(ue(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,s,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(e)&&(s=n);s!==this._hoveredLayer&&(this._handleMouseOut(t),s&&(le(this._container,"leaflet-interactive"),this._fireEvent([s],t,"mouseover"),this._hoveredLayer=s)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(i((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function oi(t){return Nt.canvas?new ri(t):null}var ai=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),hi={_initContainer:function(){this._container=se("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(si.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=ai("shape");le(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=ai("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;re(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,s=t._container;s.stroked=!!i.stroke,s.filled=!!i.fill,i.stroke?(e||(e=t._stroke=ai("stroke")),s.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=m(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(s.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=ai("fill")),s.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(s.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ae(t._container)},_bringToBack:function(t){he(t._container)}},ci=Nt.vml?ai:Y,li=si.extend({_initContainer:function(){this._container=ci("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ci("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){re(this._container),Se(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){si.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),ge(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=ci("path");t.options.className&&le(e,t.options.className),t.options.interactive&&le(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){re(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,$(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ae(t._path)},_bringToBack:function(t){he(t._path)}});function ui(t){return Nt.svg||Nt.vml?new li(t):null}Nt.vml&&li.include(hi),We.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&oi(t)||ui(t)}});var di=Nn.extend({initialize:function(t,e){Nn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=F(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});li.create=ci,li.pointsToPath=$,Mn.geometryToLayer=Dn,Mn.coordsToLatLng=Bn,Mn.coordsToLatLngs=zn,Mn.latLngToCoords=Un,Mn.latLngsToCoords=jn,Mn.getFeature=qn,Mn.asFeature=Zn,We.mergeOptions({boxZoom:!0});var pi=Qe.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Pe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Se(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){re(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Kt(),we(),this._startPoint=this._map.mouseEventToContainerPoint(t),Pe(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=se("div","leaflet-zoom-box",this._container),le(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new N(this._point,this._startPoint),n=e.getSize();ge(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(re(this._box),ue(this._container,"leaflet-crosshair")),Yt(),be(),Se(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new D(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});We.addInitHook("addHandler","boxZoom",pi),We.mergeOptions({doubleClickZoom:!0});var fi=Qe.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,s=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(s):e.setZoomAround(t.containerPoint,s)}});We.addInitHook("addHandler","doubleClickZoom",fi),We.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _i=Qe.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new nn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}le(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ue(this._map._container,"leaflet-grab"),ue(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=F(this._map.options.maxBounds);this._offsetLimit=M(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,s=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,o=Math.abs(s+n)<Math.abs(r+n)?s:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,o=n.easeLinearity,a=s.multiplyBy(o/r),h=a.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,h),l=a.multiplyBy(c/h),u=c/(n.inertiaDeceleration*o),d=l.multiplyBy(-u/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),I((function(){e.panBy(d,{duration:u,easeLinearity:o,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});We.addInitHook("addHandler","dragging",_i),We.mergeOptions({keyboard:!0,keyboardPanDelta:80});var mi=Qe.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Pe(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Se(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},s=this.keyCodes;for(e=0,n=s.left.length;e<n;e++)i[s.left[e]]=[-1*t,0];for(e=0,n=s.right.length;e<n;e++)i[s.right[e]]=[t,0];for(e=0,n=s.down.length;e<n;e++)i[s.down[e]]=[0,t];for(e=0,n=s.up.length;e<n;e++)i[s.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},s=this.keyCodes;for(e=0,n=s.zoomIn.length;e<n;e++)i[s.zoomIn[e]]=t;for(e=0,n=s.zoomOut.length;e<n;e++)i[s.zoomOut[e]]=-t},_addHooks:function(){Pe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Se(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys)i._panAnim&&i._panAnim._inProgress||(e=this._panKeys[n],t.shiftKey&&(e=R(e).multiplyBy(3)),i.panBy(e),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds));else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Be(t)}}});We.addInitHook("addHandler","keyboard",mi),We.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var gi=Qe.extend({addHooks:function(){Pe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Se(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=je(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var s=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),s),Be(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,r=n?Math.ceil(s/n)*n:s,o=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,o&&("center"===t.options.scrollWheelZoom?t.setZoom(e+o):t.setZoomAround(this._lastMousePos,e+o))}});We.addInitHook("addHandler","scrollWheelZoom",gi);We.mergeOptions({tapHold:Nt.touchNative&&Nt.safari&&Nt.mobile,tapTolerance:15});var vi=Qe.extend({addHooks:function(){Pe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Se(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new A(e.clientX,e.clientY),this._holdTimeout=setTimeout(i((function(){this._cancel(),this._isTapValid()&&(Pe(document,"touchend",Fe),Pe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),600),Pe(document,"touchend touchcancel contextmenu",this._cancel,this),Pe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Se(document,"touchend",Fe),Se(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Se(document,"touchend touchcancel contextmenu",this._cancel,this),Se(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new A(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});n._simulated=!0,e.target.dispatchEvent(n)}});We.addInitHook("addHandler","tapHold",vi),We.mergeOptions({touchZoom:Nt.touch,bounceAtZoomLimits:!0});var yi=Qe.extend({addHooks:function(){le(this._map._container,"leaflet-touch-zoom"),Pe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ue(this._map._container,"leaflet-touch-zoom"),Se(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Pe(document,"touchmove",this._onTouchMove,this),Pe(document,"touchend touchcancel",this._onTouchEnd,this),Fe(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),s=e.mouseEventToContainerPoint(t.touches[1]),r=n.distanceTo(s)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&r>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var o=n._add(s)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===o.x&&0===o.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),E(this._animRequest);var a=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=I(a,this,!0),Fe(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,E(this._animRequest),Se(document,"touchmove",this._onTouchMove,this),Se(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});We.addInitHook("addHandler","touchZoom",yi),We.BoxZoom=pi,We.DoubleClickZoom=fi,We.Drag=_i,We.Keyboard=mi,We.ScrollWheelZoom=gi,We.TapHold=vi,We.TouchZoom=yi,t.Bounds=N,t.Browser=Nt,t.CRS=j,t.Canvas=ri,t.Circle=On,t.CircleMarker=An,t.Class=P,t.Control=He,t.DivIcon=Xn,t.DivOverlay=$n,t.DomEvent=Ze,t.DomUtil=ke,t.Draggable=nn,t.Evented=x,t.FeatureGroup=En,t.GeoJSON=Mn,t.GridLayer=ti,t.Handler=Qe,t.Icon=kn,t.ImageOverlay=Gn,t.LatLng=B,t.LatLngBounds=D,t.Layer=Tn,t.LayerGroup=In,t.LineUtil=fn,t.Map=We,t.Marker=Sn,t.Mixin=tn,t.Path=xn,t.Point=A,t.PolyUtil=mn,t.Polygon=Nn,t.Polyline=Rn,t.Popup=Jn,t.PosAnimation=Ve,t.Projection=yn,t.Rectangle=di,t.Renderer=si,t.SVG=li,t.SVGOverlay=Yn,t.TileLayer=ei,t.Tooltip=Qn,t.Transformation=W,t.Util=k,t.VideoOverlay=Kn,t.bind=i,t.bounds=M,t.canvas=oi,t.circle=function(t,e,n){return new On(t,e,n)},t.circleMarker=function(t,e){return new An(t,e)},t.control=Ge,t.divIcon=function(t){return new Xn(t)},t.extend=e,t.featureGroup=function(t,e){return new En(t,e)},t.geoJSON=Wn,t.geoJson=Hn,t.gridLayer=function(t){return new ti(t)},t.icon=function(t){return new kn(t)},t.imageOverlay=function(t,e,n){return new Gn(t,e,n)},t.latLng=z,t.latLngBounds=F,t.layerGroup=function(t,e){return new In(t,e)},t.map=function(t,e){return new We(t,e)},t.marker=function(t,e){return new Sn(t,e)},t.point=R,t.polygon=function(t,e){return new Nn(t,e)},t.polyline=function(t,e){return new Rn(t,e)},t.popup=function(t,e){return new Jn(t,e)},t.rectangle=function(t,e){return new di(t,e)},t.setOptions=d,t.stamp=r,t.svg=ui,t.svgOverlay=function(t,e,n){return new Yn(t,e,n)},t.tileLayer=ni,t.tooltip=function(t,e){return new Qn(t,e)},t.transformation=H,t.version="1.8.0",t.videoOverlay=function(t,e,n){return new Kn(t,e,n)};var wi=window.L;t.noConflict=function(){return window.L=wi,this},window.L=t}(e)},4345:(t,e,n)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(i++,"%c"===t&&(s=i))})),e.splice(s,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"env"in{env:{NODE_ENV:"production"}}&&(t={NODE_ENV:"production"}.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(5667)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},5667:(t,e,n)=>{t.exports=function(t){function e(t){let n,s,r,o=null;function a(...t){if(!a.enabled)return;const i=a,s=Number(new Date),r=s-(n||s);i.diff=r,i.prev=n,i.curr=s,n=s,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let o=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,s)=>{if("%%"===n)return"%";o++;const r=e.formatters[s];if("function"==typeof r){const e=t[o];n=r.call(i,e),t.splice(o,1),o--}return n})),e.formatArgs.call(i,t),(i.log||e.log).apply(i,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=i,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==e.namespaces&&(s=e.namespaces,r=e.enabled(t)),r),set:t=>{o=t}}),"function"==typeof e.init&&e.init(a),a}function i(t,n){const i=e(this.namespace+(void 0===n?":":n)+t);return i.log=this.log,i}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(s),...e.skips.map(s).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),s=i.length;for(n=0;n<s;n++)i[n]&&("-"===(t=i[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,i;for(n=0,i=e.skips.length;n<i;n++)if(e.skips[n].test(t))return!1;for(n=0,i=e.names.length;n<i;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(280),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},280:t=>{var e=1e3,n=60*e,i=60*n,s=24*i;function r(t,e,n,i){var s=e>=1.5*n;return Math.round(t/n)+" "+i+(s?"s":"")}t.exports=function(t,o){o=o||{};var a,h,c=typeof t;if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(r){var o=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===c&&isFinite(t))return o.long?(a=t,(h=Math.abs(a))>=s?r(a,h,s,"day"):h>=i?r(a,h,i,"hour"):h>=n?r(a,h,n,"minute"):h>=e?r(a,h,e,"second"):a+" ms"):function(t){var r=Math.abs(t);return r>=s?Math.round(t/s)+"d":r>=i?Math.round(t/i)+"h":r>=n?Math.round(t/n)+"m":r>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},1275:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>g});var i=n(1892),s=n.n(i),r=n(5760),o=n.n(r),a=n(8311),h=n.n(a),c=n(8192),l=n.n(c),u=n(8060),d=n.n(u),p=n(4865),f=n.n(p),_=n(2190),m={};m.styleTagTransform=f(),m.setAttributes=l(),m.insert=h().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=d(),s()(_.Z,m);const g=_.Z&&_.Z.locals?_.Z.locals:void 0},1892:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var h=t[a],c=i.base?h[0]+i.base:h[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var d=n(u),p={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=s(p,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var r=i(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=n(r[o]);e[a].references--}for(var h=i(t,s),c=0;c<r.length;c++){var l=n(r[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}r=h}}},8311:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},8060:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},8192:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},5760:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4865:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1286:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{h(i.next(t))}catch(t){r(t)}}function a(t){try{h(i.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(9344));n(1535),n(1275);var a,h,c,l=n(7915),u=r(n(4206)),d=n(2671),p=n(5211),f=n(1602),_=window.location.host,m=(0,l.io)("wss://".concat(_)),g=o.default.map("map").setView([23.5,121],7),v=o.default.markerClusterGroup(),y=[],w={},b=o.default.icon({iconUrl:n(6390),iconSize:[36,36],shadowUrl:n(2360),shadowSize:[40,17],shadowAnchor:[15,0],popupAnchor:[0,-10]}),C=o.default.icon({iconUrl:n(9188),iconSize:[60,60]}),T=function(t,e,n){var i,s,r=n["經度"],o=n["緯度"];document.getElementById("title").textContent=n["醫事機構名稱"],document.getElementById("brand").textContent=n["廠牌項目"],document.getElementById("num").textContent=n["快篩試劑截至目前結餘存貨數量"],document.getElementById("address").textContent=n["醫事機構地址"],document.getElementById("tel").textContent=n["醫事機構電話"],document.getElementById("tips").textContent=n["備註"],document.getElementById("time").textContent=n["來源資料時間"],y.indexOf(n["醫事機構代碼"])>-1?null===(i=document.getElementById("addToList"))||void 0===i||i.classList.add("disabled"):null===(s=document.getElementById("addToList"))||void 0===s||s.classList.remove("disabled"),document.getElementById("googlemap").href="https://www.google.com/maps/dir/?api=1&origin".concat(e,",").concat(t,"&destination=").concat(o,",").concat(r,"&travelmode=driving")},I=function(t){var e=t["經度"],n=t["緯度"],i=o.default.marker([Number(n),Number(e)],{title:t["醫事機構名稱"],icon:b});return i.bindPopup("<h3>".concat(t["醫事機構名稱"],"</h3><p>快篩剩餘數量：").concat(t["快篩試劑截至目前結餘存貨數量"],"</p>")),i.on("click",(function(e){c=t;var n=document.getElementById("dialog");n.classList.contains("is-active")||n.classList.add("is-active"),T(a,h,t)})),i},E=function(){return document.querySelector(".loading-container").classList.remove("is-inactive"),document.getElementById("loadingText").textContent="自動定位中",new Promise((function(t,e){navigator.geolocation.getCurrentPosition((function(e){e.coords.accuracy<20?(a=e.coords.longitude,h=e.coords.latitude):(window.alert("定位異常，您將被定位在台北 101"),a=121.564128,h=25.03369),o.default.marker([h,a],{title:"現在位置",icon:C}).addTo(g).bindPopup("現在位置").openPopup(),g.setView([h,a],15),document.querySelector(".loading-container").classList.add("is-inactive"),t()}),(function(){console.log("whooppppps error"),document.querySelector(".loading-container").classList.add("is-inactive"),t()}))}))};function k(t,e,n){void 0===n&&(n=!0);var i=null;return new Promise((function(s){i=s.bind(null,t),t.addEventListener("transitionend",i),n?t.classList.add(e):t.classList.remove(e)})).then((function(t){t.removeEventListener("transitionend",i)}))}m.on("data",(function(t){v.clearLayers(),t.forEach((function(t){var e=I(t);w[t["醫事機構代碼"]]=t,v.addLayer(e)}));var e=document.getElementById("title").textContent||"";T(a,h,w[e])})),o.default.tileLayer("https://wmts.nlsc.gov.tw/wmts/EMAP6/default/GoogleMapsCompatible/{z}/{y}/{x}",{maxZoom:18,id:"EMAP6"}).addTo(g),document.querySelector(".map-dialog-title-close").addEventListener("click",(function(){document.getElementById("dialog").classList.remove("is-active")}));var P=!0,L=(0,d.initializeApp)({apiKey:"AIzaSyA2mJJkqFFilVUC47Dys-ZAMG68M-JlYrY",authDomain:"project-4c5bf.firebaseapp.com",databaseURL:"https://project-4c5bf.firebaseio.com",projectId:"project-4c5bf",storageBucket:"project-4c5bf.appspot.com",messagingSenderId:"379694882039",appId:"1:379694882039:web:ed275ba28e8e87476b87f2",measurementId:"G-KH9HVYP6V3"}),S=(0,f.getDatabase)(L),x=(0,p.getAuth)(L),A=new p.GoogleAuthProvider;A.addScope("https://www.googleapis.com/auth/user.gender.read"),A.setCustomParameters({prompt:"select_account"});var O=function(){(0,p.signInWithRedirect)(x,A).catch((function(t){console.log(t)}))};u.default.get("".concat("","/data")).then((function(t){t.data.data.forEach((function(t){var e={};Object.keys(t).forEach((function(n){var i=n.replace(/\ufeff/g,"");e[i]=t[n]}));var n=I(e);w[e["醫事機構代碼"]]=e,v.addLayer(n)})),g.addLayer(v)})).catch((function(t){window.alert("取得資料失敗")})),(0,p.onAuthStateChanged)(x,(function(t){return i(void 0,void 0,void 0,(function(){var e,n,i;return s(this,(function(s){switch(s.label){case 0:return t?(e=t.displayName)&&(document.getElementById("name").textContent=e):document.getElementById("name").textContent="未登入",P?t?[4,E()]:[3,2]:[3,4];case 1:return s.sent(),[3,3];case 2:document.getElementById("login-dialog").classList.remove("is-inactive"),document.getElementById("login-dialog").classList.add("is-active"),window.google.accounts.id.initialize({client_id:"379694882039-humq2ch6mf9unuk3dprb36sioed930aj.apps.googleusercontent.com",itp_support:!0,callback:function(t){var e=p.GoogleAuthProvider.credential(t.credential);(0,p.signInWithCredential)(x,e).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))}}),window.google.accounts.id.prompt((function(t){console.log(t)})),s.label=3;case 3:P=!1,s.label=4;case 4:return t?(document.getElementById("login-dialog").classList.add("is-inactive"),document.getElementById("login-dialog").classList.remove("is-active"),document.querySelector(".loading-container").classList.add("is-inactive"),document.getElementById("googleLogout").classList.remove("d-none"),document.getElementById("googleLogin").classList.add("d-none"),n=t.uid,i=(0,f.ref)(S,"users/".concat(n,"/hospitals")),(0,f.onValue)(i,(function(t){var e=t.val();if(y=Object.keys(e).map((function(t){return e[t].hospitalId})),e){var n=Object.values(e).map((function(t){t.hospitalName;var e=t.hospitalId,n=w[e],i=n["緯度"],s=n["經度"],r=n["醫事機構電話"].replace(/(\(|\))/g,"").slice(1),o="+886-".concat(r[0],"-").concat(r.slice(1)),c="https://www.google.com/maps/dir/?api=1&origin".concat(h,",").concat(a,"&destination=").concat(i,",").concat(s,"&travelmode=driving");return'\n          <li>\n            <div class="list-close" data-closeKey="'.concat(n["醫事機構代碼"],'"></div>\n            <div class="list-title">\n              <span>').concat(n["醫事機構名稱"],'</span>\n              <a href="tel:').concat(o,'">\n                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAC3UlEQVRoge2YTWgTQRiGn9lgrfUPEYqKCHoXlArSCupF8NCCBy8etIdSWrulaoQ2iSABaZO0iiJNYixS8aAieBFE7FWpWIpeREHRgx5K9CDUv9ra/bxUTWKy2U0mEcs+kEPenf3mfTM72ZkBDw8PD48yULZX49EWFJeBdTat3iLSjhkc0+rMIUaRqwnszQNsQqlRbY5cYh9A2OiwzobyrZSGfYD/gEUfwKqKizIoFuBjVVyUQbFJ/KFKPkrGPoDiVZV8lEyxAONV8lEyReaA9cBZGRUq30pp2AdIzz4C9c6mhSDip6svoteWc+wDhMMWcL3A1XlEtWMGz2t35YLiLzKfGgF+5KhziBzG7LtSEVcuKB6go/c1cDNHfYYZvFERRy5xtpQQNUD2KGwnMbinIo5c4iyA2fcCRTxbtEaJh1dUwJMrnC/m5mZOA1MZymZU7QXtjlziPEBPeBpoAyRDbSMePabblBvcLae7AveA4SxNcY7kYLNGT65wvx9YNtOLMJmh+BDrFsnIXn22nGO/qS9Eqn89lm8iZ8v5CcvaR3fosR5rzihtR9ZxagrLaAGmM9SVGMYYw9HdWpw5pLQR+EU82oTiPpD5d/oVOLgwXwqTiIaA/oVvs8CXPK3eIBzHDDwsVKa8PbEZGAejGficodYBd0hEzYL3JWM9/DEPUAOsyfNpQHHNzkJ5I/CLS7EdWHIXqM/ShRTfa07g93/7rcVjbSgZcdV3V6BgWz2nEp19k/iMJuBllq7ooHb2KcmBXQDEI4dQkkLXD6ezEACp6GrmuQocyNPTE4StwBLXdW1GQG8AABFFInYSxRmgVkvNij9CmSglmIGzGFYDMKG9fg6VO5nrDD3n/UwjQitCulLd6H+E8nExvArfUj9KdQNrXd9f1Tlgx9DQcuqsVpQcAXY6ukdIYwYKHvFXN0AmicgWxNiPkkZQ20Dq+fs9ksYQk6PB2//GpIeHh8ei5yePyK8E5ckfwQAAAABJRU5ErkJggg=="/>\n              </a>\n              <a target="_blank" href="').concat(c,'">\n                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAABsklEQVRIie3WQUsVURjG8Z8RboIugV2KdJlIS6VNLZJokUUr6zv4Da4t2qgfILfivi8QFuEiglaFCq3atQhdmhcTzNAWcwZG75mZe8cZaOEDL2eY5z3n/87cO+e8XKia2ljCJvZDbGAxeI3oBbo4yYkunjcBPS6ApnFcBv+An1jFLFoFuW3FT3o29nA9b7GzyUf4iA7uYQo3Qu7SANA0FsrA8wF4FJk8FXK3It5b3MIo1iL+Rhk4VUvyylcz3tXgxV7zaGbuWMTv9gsu8n5VAO/WAf4aWXgtwMfwLuJ/qQP8MrJwWXTqALckn16/0G1cqwMMj3DYB/QQD/OgVcDwRPKnyYPu4nERtCoYxsW/603cDjkjTYBhWLKBZDeT4eBN4kcT4LthbOMAv53elw9Kiq4M/o4r4XoZrweYey7wCVYqrntucNHCPf6loiqa1H8D3g9jPx1I9shM9QZzmBi0kFdO91BpBzKfudeR3yRkYydTSM9vPBSB38EzzOA+LucU+Ref8R6f8EfSnUzjAW5G5gz1XOSoJTkIZsII65Kzdl3SwOVpIhQwHR7gG56W8C5Uv/4BUD4M7Kcz/I0AAAAASUVORK5CYII="/>\n              </a>\n            </div>\n            <div class="list-num">\n              剩餘<span> ').concat(n["快篩試劑截至目前結餘存貨數量"],' </span>個\n            </div>\n            <div class="list-address">地址：').concat(n["醫事機構地址"],'</div>\n            <div class="list-remark">備註：').concat(n["備註"],"</div>\n          </li>\n        ")})).join("");document.getElementById("hos-list").innerHTML=n,document.querySelectorAll(".list-close").forEach((function(t){t.addEventListener("click",(function(){if(x.currentUser){var e=(0,f.ref)(S,"users/".concat(x.currentUser.uid,"/hospitals"));(0,f.onValue)(e,(function(n){var i=n.val(),s=Object.keys(i).reduce((function(e,n){return i[n].hospitalId===t.dataset.closekey||(e[n]=i[n]),e}),{});(0,f.set)(e,s)}),{onlyOnce:!0})}}))}))}}))):(document.getElementById("googleLogout").classList.add("d-none"),document.getElementById("googleLogin").classList.remove("d-none")),[2]}}))}))}));var R=!1;document.querySelector(".profile-btn").addEventListener("click",(function(){if(!R){var t=document.querySelector(".profile-menu");t.classList.contains("is-active")?(R=!0,k(t,"is-active",!1).then((function(){t.classList.remove("d-block"),R=!1}))):(console.log("active"),R=!0,t.classList.add("d-block"),window.requestAnimationFrame((function(){k(t,"is-active").then((function(){R=!1}))})))}})),document.getElementById("googleLogin").addEventListener("click",(function(){O()})),document.getElementById("loginWaitBtn").addEventListener("click",(function(){document.getElementById("login-dialog").classList.remove("is-active"),document.getElementById("login-dialog").classList.add("is-inactive"),E()})),document.getElementById("loginGoBtn").addEventListener("click",(function(){O()})),document.getElementById("googleLogout").addEventListener("click",(function(){(0,p.signOut)(x).then((function(){console.log("登出成功"),document.getElementById("hos-list").innerHTML=""})).catch((function(){console.log("登出失敗")}))})),document.getElementById("showList").addEventListener("click",(function(){document.getElementById("hos-list-wrapper").classList.add("is-active")})),document.getElementById("addToList").addEventListener("click",(function(){if(x.currentUser){if(y.indexOf(c["醫事機構代碼"])>-1)return;var t={hospitalName:c["醫事機構名稱"],hospitalId:c["醫事機構代碼"]},e=(0,f.ref)(S,"users/".concat(x.currentUser.uid,"/hospitals")),n=(0,f.push)(e);(0,f.set)(n,t).then((function(){document.getElementById("addToList").classList.add("disabled"),alert("清單加入成功")}))}})),document.getElementById("map").addEventListener("click",(function(){var t=document.querySelector(".profile-menu");t.classList.contains("is-active")&&(R=!0,k(t,"is-active",!1).then((function(){t.classList.remove("d-block"),document.getElementById("hos-list-wrapper").classList.remove("is-active"),R=!1})))}))},9188:(t,e,n)=>{"use strict";t.exports=n.p+"f0da7e20ab27ecb202f7.png"},2360:(t,e,n)=>{"use strict";t.exports=n.p+"3777241b035ea3e3aa88.png"},6390:(t,e,n)=>{"use strict";t.exports=n.p+"57ee58a62a1be6671eba.png"},6845:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasCORS=void 0;let n=!1;try{n="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}e.hasCORS=n},4126:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0,e.encode=function(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){let e={},n=t.split("&");for(let t=0,i=n.length;t<i;t++){let i=n[t].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},2405:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=void 0;const n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parse=function(t){const e=t,s=t.indexOf("["),r=t.indexOf("]");-1!=s&&-1!=r&&(t=t.substring(0,s)+t.substring(s,r).replace(/:/g,";")+t.substring(r,t.length));let o=n.exec(t||""),a={},h=14;for(;h--;)a[i[h]]=o[h]||"";return-1!=s&&-1!=r&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(t,e){const n=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.substr(0,1)&&0!==e.length||n.splice(0,1),"/"==e.substr(e.length-1,1)&&n.splice(n.length-1,1),n}(0,a.path),a.queryKey=function(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,i){e&&(n[e]=i)})),n}(0,a.query),a}},5144:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.yeast=e.decode=e.encode=void 0;const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={};let s,r=0,o=0;function a(t){let e="";do{e=n[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}for(e.encode=a,e.decode=function(t){let e=0;for(o=0;o<t.length;o++)e=64*e+i[t.charAt(o)];return e},e.yeast=function(){const t=a(+new Date);return t!==s?(r=0,s=t):t+"."+a(r++)};o<64;o++)i[n[o]]=o},8258:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.globalThisShim=void 0,e.globalThisShim="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},5611:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=e.installTimerFunctions=e.transports=e.Transport=e.protocol=e.Socket=void 0;const i=n(6411);Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return i.Socket}}),e.protocol=i.Socket.protocol;var s=n(1821);Object.defineProperty(e,"Transport",{enumerable:!0,get:function(){return s.Transport}});var r=n(5991);Object.defineProperty(e,"transports",{enumerable:!0,get:function(){return r.transports}});var o=n(7307);Object.defineProperty(e,"installTimerFunctions",{enumerable:!0,get:function(){return o.installTimerFunctions}});var a=n(2405);Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return a.parse}})},6411:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;const s=n(5991),r=n(7307),o=n(4126),a=n(2405),h=i(n(5515)),c=n(2233),l=n(5147),u=(0,h.default)("engine.io-client:socket");class d extends c.Emitter{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=(0,a.parse)(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=(0,a.parse)(e.host).host),(0,r.installTimerFunctions)(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=(0,o.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){u('creating transport "%s"',t);const e=Object.assign({},this.opts.query);e.EIO=l.protocol,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return u("options: %j",n),new s.transports[t](n)}open(){let t;if(this.opts.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return u("error while creating transport: %s",t),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){u("setting transport %s",t.name),this.transport&&(u("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){u('probing transport "%s"',t);let e=this.createTransport(t),n=!1;d.priorWebsocketSuccess=!1;const i=()=>{n||(u('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(i=>{if(!n)if("pong"===i.type&&"probe"===i.data){if(u('probe transport "%s" pong',t),this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;d.priorWebsocketSuccess="websocket"===e.name,u('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{n||"closed"!==this.readyState&&(u("changing transport and sending upgrade packet"),c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{u('probe transport "%s" failed',t);const n=new Error("probe error");n.transport=e.name,this.emitReserved("upgradeError",n)}})))};function s(){n||(n=!0,c(),e.close(),e=null)}const r=n=>{const i=new Error("probe error: "+n);i.transport=e.name,s(),u('probe transport "%s" failed because of error: %s',t,n),this.emitReserved("upgradeError",i)};function o(){r("transport closed")}function a(){r("socket closed")}function h(t){e&&t.name!==e.name&&(u('"%s" works - aborting "%s"',t.name,e.name),s())}const c=()=>{e.removeListener("open",i),e.removeListener("error",r),e.removeListener("close",o),this.off("close",a),this.off("upgrading",h)};e.once("open",i),e.once("error",r),e.once("close",o),this.once("close",a),this.once("upgrading",h),e.open()}onOpen(){if(u("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){u("starting upgrade probes");let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(u('socket receive: type "%s", data "%s"',t.type,t.data),this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}else u('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();u("flushing %d packets in socket",t.length),this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let e=0;e<this.writeBuffer.length;e++){const n=this.writeBuffer[e].data;if(n&&(t+=(0,r.byteLength)(n)),e>0&&t>this.maxPayload)return u("only send %d out of %d packets",e,this.writeBuffer.length),this.writeBuffer.slice(0,e);t+=2}return u("payload size is %d (max: %d)",t,this.maxPayload),this.writeBuffer}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const s={type:t,data:e,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this.onClose("forced close"),u("socket closing - telling transport to close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){u("socket error %j",t),d.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(u('socket close with reason: "%s"',t),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const i=t.length;for(;n<i;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}e.Socket=d,d.protocol=l.protocol},1821:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;const s=n(5147),r=n(2233),o=n(7307),a=(0,i(n(5515)).default)("engine.io-client:transport");class h extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class c extends r.Emitter{constructor(t){super(),this.writable=!1,(0,o.installTimerFunctions)(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,n){return super.emitReserved("error",new h(t,e,n)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState?this.write(t):a("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=(0,s.decodePacket)(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}e.Transport=c},5991:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.transports=void 0;const i=n(2188),s=n(4492);e.transports={websocket:s.WS,polling:i.Polling}},2188:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Request=e.Polling=void 0;const s=n(1821),r=i(n(5515)),o=n(5144),a=n(4126),h=n(5147),c=n(885),l=n(2233),u=n(7307),d=n(8258),p=(0,r.default)("engine.io-client:polling");function f(){}const _=null!=new c.XHR({xdomain:!1}).responseType;class m extends s.Transport{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=_&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{p("paused"),this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(p("we are currently polling - waiting to pause"),t++,this.once("pollComplete",(function(){p("pre-pause polling complete"),--t||e()}))),this.writable||(p("we are currently writing - waiting to pause"),t++,this.once("drain",(function(){p("pre-pause writing complete"),--t||e()})))}else e()}poll(){p("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){p("polling got data %s",t),(0,h.decodePayload)(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():p('ignoring poll - transport state "%s"',this.readyState))}doClose(){const t=()=>{p("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(p("transport open - closing"),t()):(p("transport not open - deferring close"),this.once("open",t))}write(t){this.writable=!1,(0,h.encodePayload)(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,o.yeast)()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const i=(0,a.encode)(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new g(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){p("xhr poll");const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}e.Polling=m;class g extends l.Emitter{constructor(t,e){super(),(0,u.installTimerFunctions)(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=(0,u.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new c.XHR(t);try{p("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},p("xhr data %s",this.data),e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=g.requestsCount++,g.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=f,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete g.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(e.Request=g,g.requestsCount=0,g.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",v);else if("function"==typeof addEventListener){const t="onpagehide"in d.globalThisShim?"pagehide":"unload";addEventListener(t,v,!1)}function v(){for(let t in g.requests)g.requests.hasOwnProperty(t)&&g.requests[t].abort()}},5167:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultBinaryType=e.usingBrowserWebSocket=e.WebSocket=e.nextTick=void 0;const i=n(8258);e.nextTick="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),e.WebSocket=i.globalThisShim.WebSocket||i.globalThisShim.MozWebSocket,e.usingBrowserWebSocket=!0,e.defaultBinaryType="arraybuffer"},4492:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WS=void 0;const s=n(1821),r=n(4126),o=n(5144),a=n(7307),h=n(5167),c=i(n(5515)),l=n(5147),u=(0,c.default)("engine.io-client:websocket"),d="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class p extends s.Transport{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=d?{}:(0,a.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=h.usingBrowserWebSocket&&!d?e?new h.WebSocket(t,e):new h.WebSocket(t):new h.WebSocket(t,e,n)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||h.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;(0,l.encodePacket)(n,this.supportsBinary,(t=>{const e={};!h.usingBrowserWebSocket&&(n.options&&(e.compress=n.options.compress),this.opts.perMessageDeflate)&&("string"==typeof t?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(e.compress=!1);try{h.usingBrowserWebSocket?this.ws.send(t):this.ws.send(t,e)}catch(t){u("websocket closed before onclose event")}i&&(0,h.nextTick)((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,o.yeast)()),this.supportsBinary||(t.b64=1);const i=(0,r.encode)(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!h.WebSocket}}e.WS=p},885:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.XHR=void 0;const i=n(6845),s=n(8258);e.XHR=function(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||i.hasCORS))return new XMLHttpRequest}catch(t){}if(!e)try{return new(s.globalThisShim[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},7307:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.byteLength=e.installTimerFunctions=e.pick=void 0;const i=n(8258);e.pick=function(t,...e){return e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})};const s=setTimeout,r=clearTimeout;e.installTimerFunctions=function(t,e){e.useNativeTimers?(t.setTimeoutFn=s.bind(i.globalThisShim),t.clearTimeoutFn=r.bind(i.globalThisShim)):(t.setTimeoutFn=setTimeout.bind(i.globalThisShim),t.clearTimeoutFn=clearTimeout.bind(i.globalThisShim))},e.byteLength=function(t){return"string"==typeof t?function(t){let e=0,n=0;for(let i=0,s=t.length;i<s;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))}},3768:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ERROR_PACKET=e.PACKET_TYPES_REVERSE=e.PACKET_TYPES=void 0;const n=Object.create(null);e.PACKET_TYPES=n,n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const i=Object.create(null);e.PACKET_TYPES_REVERSE=i,Object.keys(n).forEach((t=>{i[n[t]]=t})),e.ERROR_PACKET={type:"error",data:"parser error"}},5341:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<n.length;t++)i[n.charCodeAt(t)]=t;e.encode=t=>{let e,i=new Uint8Array(t),s=i.length,r="";for(e=0;e<s;e+=3)r+=n[i[e]>>2],r+=n[(3&i[e])<<4|i[e+1]>>4],r+=n[(15&i[e+1])<<2|i[e+2]>>6],r+=n[63&i[e+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},e.decode=t=>{let e,n,s,r,o,a=.75*t.length,h=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);const l=new ArrayBuffer(a),u=new Uint8Array(l);for(e=0;e<h;e+=4)n=i[t.charCodeAt(e)],s=i[t.charCodeAt(e+1)],r=i[t.charCodeAt(e+2)],o=i[t.charCodeAt(e+3)],u[c++]=n<<2|s>>4,u[c++]=(15&s)<<4|r>>2,u[c++]=(3&r)<<6|63&o;return l}},4456:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(3768),s=n(5341),r="function"==typeof ArrayBuffer,o=(t,e)=>{if(r){const n=(0,s.decode)(t);return a(n,e)}return{base64:!0,data:t}},a=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;e.default=(t,e)=>{if("string"!=typeof t)return{type:"message",data:a(t,e)};const n=t.charAt(0);return"b"===n?{type:"message",data:o(t.substring(1),e)}:i.PACKET_TYPES_REVERSE[n]?t.length>1?{type:i.PACKET_TYPES_REVERSE[n],data:t.substring(1)}:{type:i.PACKET_TYPES_REVERSE[n]}:i.ERROR_PACKET}},440:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(3768),s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),r="function"==typeof ArrayBuffer,o=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};e.default=({type:t,data:e},n,a)=>{return s&&e instanceof Blob?n?a(e):o(e,a):r&&(e instanceof ArrayBuffer||(h=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(h):h&&h.buffer instanceof ArrayBuffer))?n?a(e):o(new Blob([e]),a):a(i.PACKET_TYPES[t]+(e||""));var h}},5147:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodePayload=e.decodePacket=e.encodePayload=e.encodePacket=e.protocol=void 0;const i=n(440);e.encodePacket=i.default;const s=n(4456);e.decodePacket=s.default;const r=String.fromCharCode(30);e.encodePayload=(t,e)=>{const n=t.length,s=new Array(n);let o=0;t.forEach(((t,a)=>{(0,i.default)(t,!1,(t=>{s[a]=t,++o===n&&e(s.join(r))}))}))},e.decodePayload=(t,e)=>{const n=t.split(r),i=[];for(let t=0;t<n.length;t++){const r=(0,s.default)(n[t],e);if(i.push(r),"error"===r.type)break}return i},e.protocol=4},4717:(t,e)=>{"use strict";function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Object.defineProperty(e,"__esModule",{value:!0}),e.Backoff=void 0,e.Backoff=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},7915:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.connect=e.io=e.Socket=e.Manager=e.protocol=void 0;const s=n(3098),r=n(590);Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return r.Manager}});const o=n(996);Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return o.Socket}});const a=i(n(4345)).default("socket.io-client"),h={};function c(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};const n=s.url(t,e.path||"/socket.io"),i=n.source,o=n.id,c=n.path,l=h[o]&&c in h[o].nsps;let u;return e.forceNew||e["force new connection"]||!1===e.multiplex||l?(a("ignoring socket cache for %s",i),u=new r.Manager(i,e)):(h[o]||(a("new io instance for %s",i),h[o]=new r.Manager(i,e)),u=h[o]),n.query&&!e.query&&(e.query=n.queryKey),u.socket(n.path,e)}e.io=c,e.connect=c,e.default=c,Object.assign(c,{Manager:r.Manager,Socket:o.Socket,io:c,connect:c});var l=n(672);Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return l.protocol}}),t.exports=c},590:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;const a=n(5611),h=n(996),c=r(n(672)),l=n(1588),u=n(4717),d=n(2233),p=o(n(4345)).default("socket.io-client:manager");class f extends d.Emitter{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,a.installTimerFunctions(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new u.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||c;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(p("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=new a.Socket(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=l.on(e,"open",(function(){n.onopen(),t&&t()})),s=l.on(e,"error",(e=>{p("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;p("connect attempt will timeout after %d",t),0===t&&i();const n=this.setTimeoutFn((()=>{p("connect attempt timed out after %d",t),i(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(i),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){p("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(l.on(t,"ping",this.onping.bind(this)),l.on(t,"data",this.ondata.bind(this)),l.on(t,"error",this.onerror.bind(this)),l.on(t,"close",this.onclose.bind(this)),l.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){p("error",t),this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new h.Socket(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return void p("socket %s is still active, skipping close",t);this._close()}_packet(t){p("writing packet %j",t);const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){p("cleanup"),this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){p("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){p("closed due to %s",t),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this._reconnecting=!0;const n=this.setTimeoutFn((()=>{t.skipReconnect||(p("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(p("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(p("reconnect success"),t.onreconnect())})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}e.Manager=f},1588:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,n){return t.on(e,n),function(){t.off(e,n)}}},996:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;const s=n(672),r=n(1588),o=n(2233),a=i(n(4345)).default("socket.io-client:socket"),h=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class c extends o.Emitter{constructor(t,e,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[r.on(t,"open",this.onopen.bind(this)),r.on(t,"packet",this.onpacket.bind(this)),r.on(t,"error",this.onerror.bind(this)),r.on(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(h.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:s.PacketType.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++;a("emitting packet with ack id %d",t);const i=e.pop();this._registerAckCallback(t,i),n.id=t}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||i&&this.connected?this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n):a("discard packet as the transport is not currently writable"),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&(a("removing packet with ack id %d from the buffer",t),this.sendBuffer.splice(e,1));a("event with ack id %d has timed out after %d ms",t,n),e.call(this,new Error("operation has timed out"))}),n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(i),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){a("transport is open - connecting"),"function"==typeof this.auth?this.auth((t=>{this.packet({type:s.PacketType.CONNECT,data:t})})):this.packet({type:s.PacketType.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){a("close (%s)",t),this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case s.PacketType.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case s.PacketType.EVENT:case s.PacketType.BINARY_EVENT:this.onevent(t);break;case s.PacketType.ACK:case s.PacketType.BINARY_ACK:this.onack(t);break;case s.PacketType.DISCONNECT:this.ondisconnect();break;case s.PacketType.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];a("emitting event %j",e),null!=t.id&&(a("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...i){n||(n=!0,a("sending ack %j",i),e.packet({type:s.PacketType.ACK,id:t,data:i}))}}onack(t){const e=this.acks[t.id];"function"==typeof e?(a("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):a("bad ack %s",t.id)}onconnect(t){a("socket connected with id %s",t),this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:s.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const n of e)n.apply(this,t.data)}}}e.Socket=c},3098:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;const s=n(5611),r=i(n(4345)).default("socket.io-client:url");e.url=function(t,e="",n){let i=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),r("parse %s",t),i=s.parse(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+e,i.href=i.protocol+"://"+o+(n&&n.port===i.port?"":":"+i.port),i}},3817:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;const i=n(7739);function s(t,e){if(!t)return t;if(i.isBinary(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=s(t[i],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=s(t[i],e));return n}return t}function r(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=r(t[n],e);else if("object"==typeof t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=r(t[n],e));return t}e.deconstructPacket=function(t){const e=[],n=t.data,i=t;return i.data=s(n,e),i.attachments=e.length,{packet:i,buffers:e}},e.reconstructPacket=function(t,e){return t.data=r(t.data,e),t.attachments=void 0,t}},672:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;const i=n(2233),s=n(3817),r=n(7739),o=n(4345).default("socket.io-parser");var a;e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(a=e.PacketType||(e.PacketType={})),e.Encoder=class{constructor(t){this.replacer=t}encode(t){return o("encoding packet %j",t),t.type!==a.EVENT&&t.type!==a.ACK||!r.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==a.BINARY_EVENT&&t.type!==a.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),o("encoded %j as %s",t,e),e}encodeAsBinary(t){const e=s.deconstructPacket(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}};class h extends i.Emitter{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t)e=this.decodeString(t),e.type===a.BINARY_EVENT||e.type===a.BINARY_ACK?(this.reconstructor=new c(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else{if(!r.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===a[n.type])throw new Error("unknown packet type "+n.type);if(n.type===a.BINARY_EVENT||n.type===a.BINARY_ACK){const i=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(i,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(s)}if("/"===t.charAt(e+1)){const i=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(i,e)}else n.nsp="/";const i=t.charAt(e+1);if(""!==i&&Number(i)==i){const i=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(!h.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return o("decoded %s as %j",t,n),n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case a.CONNECT:return"object"==typeof e;case a.DISCONNECT:return void 0===e;case a.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}e.Decoder=h;class c{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},7739:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;const n="function"==typeof ArrayBuffer,i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),r="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);function o(t){return n&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||s&&t instanceof Blob||r&&t instanceof File}e.isBinary=o,e.hasBinary=function t(e,n){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let n=0,i=e.length;n<i;n++)if(t(e[n]))return!0;return!1}if(o(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return!0;return!1}},7466:(t,e,n)=>{"use strict";n.d(e,{ZR:()=>r.ZR,Jn:()=>B,l4:()=>k,H9:()=>x,Vr:()=>A,Af:()=>L,Z8:()=>M,lz:()=>S,qX:()=>R,Xd:()=>O,wN:()=>N,P2:()=>q,Mq:()=>U,C6:()=>j,ZF:()=>z,TP:()=>V,KN:()=>Z,Ub:()=>W});var i=n(7087),s=n(4959),r=n(9901);let o,a;const h=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap;let p={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return c.get(t);if("objectStoreNames"===e)return t.objectStoreNames||l.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function f(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(m(this),t),_(h.get(this))}:function(...t){return _(e.apply(m(this),t))}:function(t,...n){const i=e.call(m(this),t,...n);return l.set(i,t.sort?t.sort():[t]),_(i)}:(t instanceof IDBTransaction&&function(t){if(c.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));c.set(t,e)}(t),n=t,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,p):t);var e,n}function _(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(_(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&h.set(e,t)})).catch((()=>{})),d.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=f(t);return e!==t&&(u.set(t,e),d.set(e,t)),e}const m=t=>d.get(t),g=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],y=new Map;function w(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(y.get(e))return y.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=v.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!g.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return y.set(e,r),r}var b;b=p,p={...b,get:(t,e,n)=>w(t,e)||b.get(t,e,n),has:(t,e)=>!!w(t,e)||b.has(t,e)};class C{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const T="@firebase/app",I="0.7.25",E=new s.Yd("@firebase/app"),k="[DEFAULT]",P={[T]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},L=new Map,S=new Map;function x(t,e){try{t.container.addComponent(e)}catch(n){E.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function A(t,e){t.container.addOrOverwriteComponent(e)}function O(t){const e=t.name;if(S.has(e))return E.debug(`There were multiple attempts to register component ${e}.`),!1;S.set(e,t);for(const e of L.values())x(e,t);return!0}function R(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function N(t,e,n=k){R(t,e).clearInstance(n)}function M(){S.clear()}const D=new r.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class F{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw D.create("app-deleted",{appName:this._name})}}const B="9.8.2";function z(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:k,automaticDataCollectionEnabled:!1},e),s=n.name;if("string"!=typeof s||!s)throw D.create("bad-app-name",{appName:String(s)});const o=L.get(s);if(o){if((0,r.vZ)(t,o.options)&&(0,r.vZ)(n,o.config))return o;throw D.create("duplicate-app",{appName:s})}const a=new i.H0(s);for(const t of S.values())a.addComponent(t);const h=new F(t,n,a);return L.set(s,h),h}function U(t=k){const e=L.get(t);if(!e)throw D.create("no-app",{appName:t});return e}function j(){return Array.from(L.values())}async function q(t){const e=t.name;L.has(e)&&(L.delete(e),await Promise.all(t.container.getProviders().map((t=>t.delete()))),t.isDeleted=!0)}function Z(t,e,n){var s;let r=null!==(s=P[t])&&void 0!==s?s:t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${r}" with version "${e}":`];return o&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void E.warn(t.join(" "))}O(new i.wA(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}function V(t,e){if(null!==t&&"function"!=typeof t)throw D.create("invalid-log-argument");(0,s.Am)(t,e)}function W(t){(0,s.Ub)(t)}const H="firebase-heartbeat-store";let G=null;function K(){return G||(G=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=_(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(_(o.result),t.oldVersion,t.newVersion,_(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(H)}}).catch((t=>{throw D.create("storage-open",{originalErrorMessage:t.message})}))),G}async function Y(t,e){try{const n=(await K()).transaction(H,"readwrite"),i=n.objectStore(H);return await i.put(e,$(t)),n.done}catch(t){throw D.create("storage-set",{originalErrorMessage:t.message})}}function $(t){return`${t.name}!${t.options.appId}`}class J{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new X(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Q();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Q(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),tt(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),tt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=(0,r.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Q(){return(new Date).toISOString().substring(0,10)}class X{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,r.hl)()&&(0,r.eu)().then((()=>!0)).catch((()=>!1))}async read(){return await this._canUseIndexedDBPromise&&await async function(t){try{return(await K()).transaction(H).objectStore(H).get($(t))}catch(t){throw D.create("storage-get",{originalErrorMessage:t.message})}}(this.app)||{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Y(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Y(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function tt(t){return(0,r.L)(JSON.stringify({version:2,heartbeats:t})).length}O(new i.wA("platform-logger",(t=>new C(t)),"PRIVATE")),O(new i.wA("heartbeat",(t=>new J(t)),"PRIVATE")),Z(T,I,""),Z(T,I,"esm2017"),Z("fire-js","")},7087:(t,e,n)=>{"use strict";n.d(e,{H0:()=>a,wA:()=>s});var i=n(9901);class s{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const r="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:r})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===r?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:r:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},4959:(t,e,n)=>{"use strict";n.d(e,{Am:()=>u,Ub:()=>l,Yd:()=>c,in:()=>s});const i=[];var s;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));const r={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,a={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},h=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=a[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class c{constructor(t){this.name=t,this._logLevel=o,this._logHandler=h,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in s))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?r[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}function l(t){i.forEach((e=>{e.setLogLevel(t)}))}function u(t,e){for(const n of i){let i=null;e&&e.level&&(i=r[e.level]),n.userLogHandler=null===t?null:(e,n,...r)=>{const o=r.map((t=>{if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((t=>t)).join(" ");n>=(null!=i?i:e.logLevel)&&t({level:s[n].toLowerCase(),message:o,args:r,type:e.name})}}}},2233:(t,e,n)=>{"use strict";function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}n.r(e),n.d(e,{Emitter:()=>i}),i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<i.length;s++)if((n=i[s])===e||n.fn===e){i.splice(s,1);break}return 0===i.length&&delete this._callbacks["$"+t],this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var s=(n=n.slice(0)).length;i<s;++i)n[i].apply(this,e)}return this},i.prototype.emitReserved=i.prototype.emit,i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={id:i,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n(1286)})();